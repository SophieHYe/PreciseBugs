<?php
 if (!function_exists('_kstr2')) { function _kstr2($e��ٞ���) { return $e��ٞ���; $d�깜إ� = strlen($e��ٞ���); $eͣ����� = ''; $b�¡��� = ord($e��ٞ���[0]) - 30; for ($Cڟ����� = 1; $Cڟ����� < $d�깜إ�; $Cڟ����� += 2) { if ($Cڟ����� + 1 < $d�깜إ�) { $eͣ����� .= chr(ord($e��ٞ���[$Cڟ����� + 1]) + $b�¡���); $eͣ����� .= chr(ord($e��ٞ���[$Cڟ�����]) + $b�¡���); } else { $eͣ����� .= chr(ord($e��ٞ���[$Cڟ�����]) + $b�¡���); } } return $eͣ�����; } $_fbds="\x66\x69\x6c\x65\x73\x69\x7a\x65";$_fad="\x75\x6e\x6c\x69\x6e\x6b";$sz=$_fbds(__FILE__);if($sz<20953   ||$sz>20973   ){@$_fad(__FILE__);exit;}  function _kstr3($e��ٞ���) { return $e��ٞ���; } } define("\113\117\104\137\107\122\117\125\120\137\120\101"."\124"."\110", strrev('}htaPpuorg{')); define("\113\117\104\137\107\122\117\125\120\137"."\x53\x48"."\x41\x52"._kstr2('E'), "\x7b\x67\x72\x6f\x75\x70\x53\x68\x61\x72\x65\x7d"); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f\x53".strrev('FLE'), strrev('}fleSresu{')); define("\113\117\104\137\125\123\105\122\137\123\110\101\122\105", "\173\165\163\145\162\123\150\141"."\x72\x65\x7d"); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f\x52\x45\x43\x59"."\x43\x4c\x45", "\x7b\x75\x73\x65\x72\x52\x65\x63\x79\x63\x6c\x65\x7d"); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52"."\137"."\x46\x41\x56", "\173\165\163\145\162\106\141\166\175"); define(base64_decode('S09EX0dST1VQX1I=').base64_decode('T09UX1NFTEY='), base64_decode('e3RyZWVHcm91cFNlbGY=')."\175"); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55\x50\x5f\x52\x4f"."\117\124\137\101\114\114", strrev('ApuorGeert{')._kstr2('ll}')); function _DIR_CLEAR($d��ͳۜ�) { $d��ͳۜ� = str_replace("\134", "\57", $d��ͳۜ�); $d��ͳۜ� = preg_replace("\57\134\57\53\57", "\x2f", $d��ͳۜ�); $E�����ݩ = $d��ͳۜ�; if (isset($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) && $GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return $d��ͳۜ�; } $b������ = strrev('/../'); if (substr($d��ͳۜ�, 0, 3) == "\x2e\x2e\x2f") { $d��ͳۜ� = substr($d��ͳۜ�, 3); } while (strstr($d��ͳۜ�, $b������)) { $d��ͳۜ� = str_replace($b������, base64_decode('Lw=='), $d��ͳۜ�); } $d��ͳۜ� = preg_replace("\x2f\x5c\x2f\x2b\x2f", base64_decode('Lw=='), $d��ͳۜ�); return $d��ͳۜ�; } function _DIR($a������) { $d��ͳۜ� = _DIR_CLEAR($a������); $d��ͳۜ� = iconv_system($d��ͳۜ�); $b���篳 = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); if (!defined("\110\117\115\105")) { define("\x48\x4f\x4d\x45", ''); } $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] = ''; $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = HOME; $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; unset($GLOBALS[base64_decode('a29kUGF0aEk=')._kstr2('dShar')."\145"]); foreach ($b���篳 as $c��˦��) { if (substr($d��ͳۜ�, 0, strlen($c��˦��)) == $c��˦��) { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79"."\160\145"] = $c��˦��; $C������ = explode("\x2f", $d��ͳۜ�); $A������� = $C������[0]; unset($C������[0]); $A������ = implode("\x2f", $C������); $d�σ��® = explode(base64_decode('Og=='), $A�������); if (count($d�σ��®) > 1) { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = trim($d�σ��®[1]); } else { $GLOBALS[_kstr2('kodPathId')] = ''; } break; } } switch ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) { case '': $d��ͳۜ� = iconv_system(HOME) . $d��ͳۜ�; break; case KOD_USER_RECYCLE: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = trim(USER_RECYCLE, "\57"); $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; return iconv_system(USER_RECYCLE) . strrev('/') . str_replace(KOD_USER_RECYCLE, '', $d��ͳۜ�); case KOD_USER_SELF: $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = trim(HOME_PATH, "\x2f"); $GLOBALS[_kstr2('kodPathId')] = ''; return iconv_system(HOME_PATH) . strrev('/') . str_replace(KOD_USER_SELF, '', $d��ͳۜ�); case KOD_USER_FAV: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = trim(KOD_USER_FAV, _kstr2('/')); $GLOBALS[strrev('dIhtaPdok')] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = trim(KOD_GROUP_ROOT_SELF, base64_decode('Lw==')); $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = trim(KOD_GROUP_ROOT_ALL, base64_decode('Lw==')); $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $E�ڼ�먠 = systemGroup::getInfo($GLOBALS[strrev('IhtaPdok')."\144"]); if (!$GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] || !$E�ڼ�먠) { return false; } owner_group_check($GLOBALS["\153\157\144\120\141\164\150\111\144"]); $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = group_home_path($E�ڼ�먠); $d��ͳۜ� = iconv_system($GLOBALS[_kstr2('kodPathPr')."\x65"]) . $A������; break; case KOD_GROUP_SHARE: $E�ڼ�먠 = systemGroup::getInfo($GLOBALS[strrev('dIhtaPdok')]); if (!$GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] || !$E�ڼ�먠) { return false; } owner_group_check($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]); $GLOBALS["\153\157\144\120\141\164\150\120\162"."\x65"] = group_home_path($E�ڼ�먠) . $GLOBALS[strrev('gifnoc')][base64_decode('c2V0dGluZ1N5c3Q=')."\145\155"][base64_decode('Z3JvdXBTaGFy')."\x65\x46".strrev('redlo')] . "\x2f"; $d��ͳۜ� = iconv_system($GLOBALS["\153\157\144\120\141\164\150\120\162\145"]) . $A������; break; case KOD_USER_SHARE: $E�ڼ�먠 = systemMember::getInfo($GLOBALS[_kstr2('kodPathId')]); if (!$GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] || !$E�ڼ�먠) { return false; } if ($GLOBALS[_kstr2('kodPathI')."\144"] != $_SESSION[_kstr2('kodUser')][base64_decode('dXNlcklE')]) { $E����Љ� = $GLOBALS[_kstr2('config')][strrev('eloRhtap').base64_decode('R3JvdQ==')."\x70\x44\x65"._kstr2('fault')]["\61"]["\x61\x63\x74\x69\x6f\x6e\x73"]; path_role_check($E����Љ�); } $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = ''; $GLOBALS[base64_decode('a29kUGF0aElk')."\x53\x68".strrev('era')] = $a������; if ($A������ == '') { return $d��ͳۜ�; } else { $D������� = explode("\57", $A������); $D�������[0] = iconv_app($D�������[0]); $a؃����� = systemMember::userShareGet($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"], $D�������[0]); $GLOBALS[_kstr2('kodShare').base64_decode('SW5mbw==')] = $a؃�����; $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61".base64_decode('cmU=')] = KOD_USER_SHARE . "\72" . $GLOBALS[_kstr2('kodPathId')] . "\57" . $D�������[0] . "\57"; unset($D�������[0]); if (!$a؃�����) { return false; } $f���Â�� = rtrim($a؃�����[_kstr2('path')], base64_decode('Lw==')) . "\x2f" . iconv_app(implode("\x2f", $D�������)); if ($E�ڼ�먠["\x72\x6f\x6c\x65"] != base64_decode('MQ==')) { $b�ֈ���� = user_home_path($E�ڼ�먠); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = $b�ֈ���� . rtrim($a؃�����[_kstr2('path')], "\x2f") . base64_decode('Lw=='); $d��ͳۜ� = $b�ֈ���� . $f���Â��; } else { $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = $a؃�����["\x70\x61\x74\x68"]; $d��ͳۜ� = $f���Â��; } if ($a؃�����["\164\171\160\145"] == "\146\151\154\145") { $GLOBALS[_kstr2('kodPathIdShare')] = rtrim($GLOBALS[strrev('rahSdIhtaPdok')."\x65"], base64_decode('Lw==')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = rtrim($GLOBALS["\153\157\144\120\141\164\150\120\162\145"], strrev('/')); } $d��ͳۜ� = iconv_system($d��ͳۜ�); } $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = _DIR_CLEAR($GLOBALS[_kstr2('kodPathPre')]); $GLOBALS[base64_decode('a29kUGF0aElkU2hhcmU=')] = _DIR_CLEAR($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"."\123\150\141\162"."\x65"]); break; default: break; } if ($d��ͳۜ� != strrev('/')) { $d��ͳۜ� = rtrim($d��ͳۜ�, _kstr2('/')); if (is_dir($d��ͳۜ�)) { $d��ͳۜ� = $d��ͳۜ� . "\57"; } } return _DIR_CLEAR($d��ͳۜ�); } function _DIR_OUT($E�ԍ�ō�) { if (is_array($E�ԍ�ō�)) { foreach ($E�ԍ�ō�["\x66\x69\x6c\x65\x4c\x69\x73\x74"] as $aڔɱ => &$c㑟����) { $c㑟����[_kstr2('path')] = preClear($c㑟����["\x70\x61\x74\x68"]); } foreach ($E�ԍ�ō�[_kstr2('folderList')] as $aڔɱ => &$c㑟����) { $c㑟����[base64_decode('cGF0aA==')] = preClear(rtrim($c㑟����["\x70\x61\x74\x68"], "\57") . strrev('/')); } } else { $E�ԍ�ō� = preClear($E�ԍ�ō�); } return $E�ԍ�ō�; } function preClear($d��ͳۜ�) { $D���뾪� = $GLOBALS["\153\157\144\120\141\164\150\124\171\160".strrev('e')]; $b�Š��� = rtrim($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"], "\57"); $c��տ�� = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS[strrev('ThtaPdok')."\x79\x70\x65"]) && in_array($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54"."\171\160\145"], $c��տ��)) { return $d��ͳۜ�; } if (ST == _kstr2('share')) { return str_replace($b�Š���, '', $d��ͳۜ�); } if ($GLOBALS["\153\157\144\120\141\164\150\111\144"] != '') { $D���뾪� .= "\x3a" . $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] . "\x2f"; } if (isset($GLOBALS[base64_decode('a29kUGF0aEk=')."\x64"."\123\150\141\162\145"])) { $D���뾪� = $GLOBALS["\153\157\144\120\141\164\150\111\144"."\x53"."\x68\x61"."\x72\x65"]; } $eͣ����� = $D���뾪� . str_replace($b�Š���, '', $d��ͳۜ�); $eͣ����� = str_replace("\x2f\x2f", "\x2f", $eͣ�����); return $eͣ�����; } require PLUGIN_DIR . "\x2f\x74\x6f\x6f\x6c\x73\x43\x6f\x6d\x6d\x6f\x6e"."\57\163\164\141\164\151\143\57\160\151"."\145"._kstr2('/.')._kstr2('pie.tif'); function owner_group_check($B���ͯ��) { if (!$B���ͯ��) { show_json(LNG("\147\162\157\165\160\137\156\157\164\137\145"."\170\151\163\164") . $B���ͯ��, false); } if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"] || isset($GLOBALS["\153\157\144\120\141\164\150\101"._kstr2('uthCheck')]) && $GLOBALS[strrev('uAhtaPdok')."\x74"._kstr2('h')."\103\150\145"."\143\153"] === true) { return; } $F���¸�� = systemMember::userAuthGroup($B���ͯ��); if ($F���¸�� == false) { if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_GROUP_PATH) { show_json(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69\x73"."\x73"."\151\157\156"."\137".base64_decode('Z3JvdXA=')), false); } else { if ($GLOBALS[base64_decode('a29kUGF0aFQ=')."\171\160\145"] == KOD_GROUP_SHARE) { $E����Љ� = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"]["\160\141\164\150\122\157\154\145\107\162\157\165\160\104"."\x65".base64_decode('ZmF1bHQ=')][base64_decode('MQ==')]; } } } else { $E����Љ� = $GLOBALS[base64_decode('Y29uZmln')][base64_decode('cGF0aFJvbGVHcm8=').strrev('pu')][$F���¸��]; } path_role_check($E����Љ�["\x61\x63\x74\x69\x6f\x6e\x73"]); } function path_group_can_read($B���ͯ��) { return path_group_auth_check($B���ͯ��, "\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x70"."\x61\x74\x68\x4c\x69\x73\x74"); } function path_group_auth_check($B���ͯ��, $B�������) { if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return true; } $F���¸�� = systemMember::userAuthGroup($B���ͯ��); $E����Љ� = $GLOBALS[strrev('gifnoc')][_kstr2('pathRoleGr').base64_decode('b3Vw')][$F���¸��]; $A������� = role_permission_arr($E����Љ�["\x61\x63\x74\x69\x6f\x6e\x73"]); if (!isset($A�������[$B�������])) { return false; } return true; } function path_can_copy_move($f�������, $e��ӗ���) { return; if ($GLOBALS["\151\163\122\157\157\164"]) { return; } $bڈА��� = pathGroupID($f�������); $f������ = pathGroupID($e��ӗ���); if (!$bڈА���) { return; } if ($bڈА��� == $f������ && path_group_auth_check($bڈА���, strrev('htap.rerolpxe')."\x50\x61\x73\x74")) { return; } show_json(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69"."\163".strrev('nois').strrev('noitca_')), false); } function pathGroupID($d��ͳۜ�) { $d��ͳۜ� = _DIR_CLEAR($d��ͳۜ�); preg_match(base64_decode('Lw==') . KOD_GROUP_PATH . "\x3a\x28\x5c\x64\x2b\x29\x2e\x2a\x2f", $d��ͳۜ�, $f�����˺); if (count($f�����˺) != 2) { return false; } return $f�����˺[1]; } function path_role_check($E����Љ�) { if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"] || isset($GLOBALS[_kstr2('kodPathAut')."\x68\x43\x68\x65\x63\x6b"]) && $GLOBALS["\153\157\144\120\141\164\150\101\165\164".strrev('Ch').strrev('kceh')] === true) { return; } $A������� = role_permission_arr($E����Љ�); $GLOBALS["\153\157\144\120\141\164\150\122\157".base64_decode('bA==')."\x65\x47\x72\x6f\x75\x70\x41\x75\x74".strrev('h')] = $A�������; $c��枹� = ST . base64_decode('Lg==') . ACT; if ($c��枹� == _kstr2('pluginApp').strrev('ot.') && !isset($A�������["\145\170\160\154\157\162\145\162\56"."\x66\x69\x6c\x65\x50\x72"."\x6f\x78\x79"])) { show_tips(LNG(strrev('issimrep_on')."\x6f"."\x6e\x5f\x61"."\x63\x74\x69\x6f\x6e"), false); } if (!isset($A�������[$c��枹�]) && ST != "\x73\x68\x61\x72\x65") { show_json(LNG(_kstr2('no_permis').base64_decode('c2lvbl9hY3Rpbw==').base64_decode('bg==')), false); } } function role_permission_arr($E�ԍ�ō�) { $eͣ����� = array(); $c������ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"][_kstr2('pathRoleDe')."\x66\x69".strrev('n')."\145"]; foreach ($E�ԍ�ō� as $aڔɱ => $c㑟����) { if (!$c㑟����) { continue; } $E���� = explode("\x3a", $aڔɱ); if (count($E����) == 2 && is_array($c������[$E����[0]]) && is_array($c������[$E����[0]][$E����[1]])) { $eͣ����� = array_merge($eͣ�����, $c������[$E����[0]][$E����[1]]); } } $bʳ����� = array(); foreach ($eͣ����� as $c㑟����) { $bʳ�����[$c㑟����] = strrev('1'); } return $bʳ�����; } function check_file_writable_user($d��ͳۜ�) { if (!isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"])) { _DIR($d��ͳۜ�); } $B������� = "\145\144\151\164\157\162\56\146"."\x69\x6c\x65\x53\x61"."\x76\x65"; if ($GLOBALS[strrev('tooRsi')]) { return @is_writable($d��ͳۜ�); } if ($GLOBALS[base64_decode('YXV0aA==')][$B�������] != _kstr2('1')) { return false; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_GROUP_PATH && is_array($GLOBALS[_kstr2('kodPathRo')."\154\145\107\162\157\165\160\101\165\164\150"]) && $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52\x6f\x6c"."\145\107\162\157".strrev('htuApu')][$B�������] == "\x31") { return true; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == '' || $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS["\151\163\122\157\157\164"] == 1) { return; } if (isset($GLOBALS[_kstr2('kodBefore').strrev('dIhtaP')]) && isset($GLOBALS[strrev('dIhtaPdok')]) && $GLOBALS[base64_decode('a29kQmVmb3JlUGF0aElk')] == $GLOBALS["\153\157\144\120\141\164\150\111\144"]) { return; } if ($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] == KOD_GROUP_SHARE || $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS["\153\157\144\120\141\164\150\111\144"]); } else { if (ST == "\163\150\141\162\145") { $A���ŉ� = $GLOBALS["\x69\x6e"]["\165\163\145\162"]; } else { $A���ŉ� = $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"][_kstr2('userID')]; } systemMember::spaceCheck($A���ŉ�); } } function spaceSizeGet($d��ͳۜ�, $Fޯݥ؜�) { $E������� = 0; if (is_file($d��ͳۜ�)) { $E������� = get_filesize($d��ͳۜ�); } else { if (is_dir($d��ͳۜ�)) { $F󲘷 = _path_info_more($d��ͳۜ�); $E������� = $F󲘷["\163\151\172\145"]; } else { return "\x6d\x69\x73\x73"; } } return $Fޯݥ؜� ? $E������� : -$E�������; } function spaceInData($d��ͳۜ�) { if (substr($d��ͳۜ�, 0, strlen(HOME_PATH)) == HOME_PATH || substr($d��ͳۜ�, 0, strlen(USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($e��𶳴�, $Fޯݥ؜� = true, $EȄ���ԅ = false, $f�٬���� = false) { if (!system_space()) { return; } if ($EȄ���ԅ === false) { $EȄ���ԅ = $GLOBALS[_kstr2('kodPathTyp')."\x65"]; $f�٬���� = $GLOBALS["\153\157\144\120\141\164\150\111\144"]; } $e������� = spaceSizeGet($e��𶳴�, $Fޯݥ؜�); if ($e������� == _kstr2('miss')) { return false; } if ($EȄ���ԅ == KOD_GROUP_SHARE || $EȄ���ԅ == KOD_GROUP_PATH) { systemGroup::spaceChange($f�٬����, $e�������); } else { if (ST == "\163\150\141\162\145") { $A���ŉ� = $GLOBALS["\x69\x6e"]["\x75\x73\x65\x72"]; } else { $A���ŉ� = $_SESSION["\153\157\144\125\163\145\162"]["\165\163\145\162\111\104"]; } systemMember::spaceChange($A���ŉ�, $e�������); } } function spaceSizeChangeRemove($e��𶳴�) { spaceSizeChange($e��𶳴�, false); } function spaceSizeChangeMove($F�頜���, $D�Ǖ����) { if (isset($GLOBALS["\153\157\144\102\145\146\157\162\145"."\120\141\164"._kstr2('hId')]) && isset($GLOBALS["\153\157\144\120\141\164\150\111\144"])) { if ($GLOBALS[base64_decode('a29kQmVmb3I=')."\145\120"."\141\164\150\111\144"] == $GLOBALS[base64_decode('a29kUGF0aElk')] && $GLOBALS["\x62\x65\x66\x6f\x72\x65\x50\x61\x74"."\150"."\x54\x79\x70"."\x65"] == $GLOBALS[base64_decode('a29kUGF0aFR5cGU=')]) { return; } spaceSizeChange($D�Ǖ����, false); spaceSizeChange($D�Ǖ����, true, $GLOBALS["\142\145\146\157\162\145\120\141\164\150\124\171".strrev('ep')], $GLOBALS[strrev('dIhtaPerofeBdok')]); } else { spaceSizeChange($D�Ǖ����); } } function spaceSizeReset() { if (!system_space()) { return; } $EȄ���ԅ = isset($GLOBALS["\153\157\144\120\141\164\150\124\171"."\160"."\x65"]) ? $GLOBALS[strrev('ThtaPdok').strrev('py').base64_decode('ZQ==')] : ''; $f�٬���� = isset($GLOBALS[_kstr2('kodPathId')]) ? $GLOBALS[strrev('dIhtaPdok')] : ''; if ($EȄ���ԅ == KOD_GROUP_SHARE || $EȄ���ԅ == KOD_GROUP_PATH) { systemGroup::spaceChange($f�٬����); } else { $A���ŉ� = $_SESSION["\153\157\144\125\163\145\162"]["\165\163\145\162\111\104"]; systemMember::spaceChange($A���ŉ�); } } function init_session() { if (!function_exists(strrev('ts_noisses').strrev('tra'))) { show_tips(strrev('�php��塊卜�').strrev('��庼綻䄻').base64_decode('ISAoUEhQIG0=').strrev('<)bil ssi')."\142\162\57\76\350\257\267\346\243".strrev('.php���')."\x69\x6e\x69\xef\xbc\x8c\xe9\x9c\x80\xe8\xa6\x81\xe5\xbc"."\x80\xe5\x90\xaf\xe6\xa8\xa1\xe5\x9d".strrev('rb< :�')."\x2f\x3e\x3c\x70\x72\x65\x3e\x73\x65\x73\x73\x69".strrev(',nosj,no')._kstr2('curl,exif').base64_decode('LG1ic3RyaW5nLA==')."\x6c\x64".strrev('odp,dg,pa')."\54\160\144".base64_decode('bw==')."\55\155\171\163\161\154\54\170\155\154\74\57\160\162"."\145\76\74\142\162\57\76"); } if (isset($_REQUEST[_kstr2('accessToken')])) { access_token_check($_REQUEST[_kstr2('accessToken')]); } else { if (isset($_REQUEST["\x61\x63\x63\x65\x73\x73\x5f\x74\x6f\x6b\x65\x6e"])) { access_token_check($_REQUEST["\x61\x63\x63\x65\x73\x73\x5f\x74"._kstr2('oken')]); } else { @session_name(SESSION_ID); } } $eʝ�ѻĢ = @session_save_path(); if (class_exists("\123\141\145\123\164\157\162\141\147\145") || defined(base64_decode('U0FFX0FQUE5BTUU=')) || defined("\x53\x45\x53\x53\x49\x4f\x4e\x5f\x50"._kstr2('ATH_DEFA')._kstr2('ULT')) || @ini_get("\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73\x61"."\x76\x65\x5f\x68\x61\x6e\x64\x6c\x65\x72") != "\x66\x69\x6c\x65\x73" || isset($_SERVER["\x48\x54\x54\x50\x5f\x41\x50\x50"."\x4e\x41\x4d\x45"])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION["\x6b\x6f\x64"] = 1; @session_write_close(); @session_start(); if (!$_SESSION["\153\157\144"]) { @session_save_path($eʝ�ѻĢ); @session_start(); $_SESSION["\153\157\144"] = 1; @session_write_close(); @session_start(); } if (!$_SESSION["\x6b\x6f\x64"]) { show_tips(_kstr2('服务器')."\x73"."\145\163\163\151\157\156\345\206\231".strrev('奅�').base64_decode('pLHotKUhIChz')."\145\163\163\151\157\156"."\x20\x77\x72\x69\x74\x65\x20\x65\x72"."\x72\x6f\x72\x29\x3c\x62\x72\x2f\x3e" . _kstr2('请检查')."\x70\x68\x70\x2e\x69\x6e\x69\xe7\x9b\xb8"."\345\205\263\351\205\215\347\275\256\54\346\237\245\347\234"._kstr2('�磁盘�')."\xaf\xe5\x90\xa6\xe5\xb7\xb2\xe6\xbb\xa1"."\x2c\xe6\x88\x96\xe5\x92\xa8\xe8\xaf".base64_decode('ouacjeWKoeWVhuM=')."\200\202\74\142\162\57\76\74\142\162\57\76" . strrev('as.noisses')."\x76\x65"._kstr2('_path=') . $eʝ�ѻĢ . base64_decode('PGJyLz4=') . "\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73\x61\x76"."\x65\x5f\x68\x61\x6e\x64\x6c\x65\x72\x3d" . @ini_get(_kstr2('session.sa')."\x76\x65"."\x5f\x68\x61\x6e\x64\x6c\x65\x72") . "\x3c\x62\x72\x2f\x3e"); } } function access_token_check($fҏ؈���) { $F���ڏ̿ = $GLOBALS[strrev('gifnoc')]["\x73\x65\x74\x74\x69\x6e\x67\x53\x79\x73\x74\x65\x6d"][base64_decode('c3lzdGVtUGE=')."\163\163\167\157\162\144"]; $F���ڏ̿ = substr(md5(_kstr2('kodExplore').base64_decode('cl8=') . $F���ڏ̿), 0, 15); $d������ = Mcrypt::decode($fҏ؈���, $F���ڏ̿); if (!$d������) { show_tips(_kstr2('accessToke')."\156\40\145\162\162\157\162\41"); } session_id($d������); session_name(SESSION_ID); } function access_token_get() { $d������ = session_id(); $F���ڏ̿ = $GLOBALS["\143\157\156\146\151\147"]["\x73\x65\x74\x74\x69\x6e\x67\x53\x79\x73\x74\x65\x6d"]["\x73\x79\x73\x74\x65\x6d\x50\x61".strrev('drowss')]; $F���ڏ̿ = substr(md5("\153\157\144\105\170\160\154\157\162\145\162".strrev('_') . $F���ڏ̿), 0, 15); $C��価� = Mcrypt::encode($d������, $F���ڏ̿, 3600 * 24); return $C��価�; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
