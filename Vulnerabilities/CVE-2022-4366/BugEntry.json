{"buggy_code": ["<?php\n/*********************************************************************\n* Name: logging.php\n* Author: Liran tal <liran.tal@gmail.com>\n*\n* This file is used for controlling the logging actions\n*\n*********************************************************************/\n\n\n/*\n* It is important to understand that when logging.php is included in\n* a page AFTER an include for config_read.php it gains access to all\n* of the variables it's scope including the $configValues[....] because\n* it was included just before it.\n*\n* But it should be noticed that these variables are only accessible\n* in the scope of the general or main block of php code and are\n* not accessible from functions, so we can't just use $configValues[...]\n* variables from within logMessageNotice() or any other function\n* and so we must use them here as references.\n*\n* The relevant variables are:\n*\n* $operator\n* $_SERVER[\"SCRIPT_NAME\"]\n* $configValues['CONFIG_LOG_FILE']\n*\n*/\n\nif ($configValues['CONFIG_LOG_PAGES'] == \"yes\") {\n\tif (isset($log)) {\n\t        $msgNotice = $operator . \" \" . $log;\n\t        logMessage(\"NOTICE\", $msgNotice, $configValues['CONFIG_LOG_FILE'], $_SERVER[\"SCRIPT_NAME\"]);\n\t}\n}\n\n\n\nif ($configValues['CONFIG_LOG_QUERIES'] == \"yes\") {\n\tif (isset($logQuery)) {\n\t        $msgQuery = $operator . \" \" . $logQuery;\n\t        logMessage(\"QUERY\", $msgQuery, $configValues['CONFIG_LOG_FILE'], $_SERVER[\"SCRIPT_NAME\"]);\n\t}\n}\n\n\n\nif ($configValues['CONFIG_LOG_ACTIONS'] == \"yes\") {\n\tif (isset($logAction)) {\n\t        $msgAction = $operator . \" \" . $logAction;\n\t        logMessage(\"ACTION\", $msgAction, $configValues['CONFIG_LOG_FILE'], $_SERVER[\"SCRIPT_NAME\"]);\n\t}\n}\n\n\n/********************************************************************************\n * evaluating whether we need to debug SQL queries to the database as well.\n * $logDebugSQL is set for each $sql = \"query statement...\" on the actual page\n * in the following form:         $logDebugSQL += $sql . \"\\n\";\n *\n ********************************************************************************/\nif ($configValues['CONFIG_DEBUG_SQL'] == \"yes\") {\n\tif (isset($logDebugSQL)) {\n\t        $msgDebugSQL = \"- SQL -\" . \" \" . $logDebugSQL . \" on page: \";\n\t        logMessage(\"DEBUG\", $msgDebugSQL, $configValues['CONFIG_LOG_FILE'], $_SERVER[\"SCRIPT_NAME\"]);\n\t}\n}\n\n/* the continuation of the CONFIG_DEBUG_SQL actually, this prints to the page\n * being viewed */\nif ($configValues['CONFIG_DEBUG_SQL_ONPAGE'] == \"yes\") {\n\tif (isset($logDebugSQL)) {\n\t\t\techo \"<br/><br/>\";\n\t\t\techo \"Debugging SQL Queries: <br/>\";\n\t\t\techo $logDebugSQL;\n\t\t\techo \"<br/><br/>\";\n\t\t}\n}\n\n\n\nfunction logMessage($type, $msg, $logFile, $currPage) {\n/*\n* @param $type               The message type, for example, NOTICE, DEBUG, ERROR, ACTION, etc...\n* @param $msg           \tThe message string which should be logged to the file\n* @param $logFile           The full path for the filename to write logs to\n* @param $currPage       The current page that we included from\n* @return $table              The table name, either radcheck or radreply\n*/\n\n        $date = date('M d G:i:s');\n        $msgString = $date . \" \" . $type . \" \" . $msg . \" \" . $currPage;\n\n        $fp = fopen($logFile, \"a\");\n        if ($fp) {\n        fwrite($fp, $msgString  . \"\\n\");\n                fclose($fp);\n        } else {\n\n                echo \"<font color='#FF0000'>error: could not open the file for writing:<b> $logFile </b><br/></font>\";\n                        echo \"Check file permissions. The file should be writable by the webserver's user/group<br/>\";\n        }\n\n}\n\n?>\n", "<?php\n/*********************************************************************\n* Name: actionMessages.php\n* Author: Liran tal <liran.tal@gmail.com>\n*\n* This file provides control for messages that are printed to the\n* screen in reply to actions such as applying forms, saving data,\n* removing data and such.\n*\n*********************************************************************/\n\n\nif ((isset($failureMsg)) && ($failureMsg != \"\")) {\n\techo \"<div class='failure'>\n\t\t$failureMsg\n\t</div>\n\t\";\n}\n\n\nif ((isset($successMsg)) && ($successMsg != \"\")) {\n\techo \"<div class='success'>\n\t\t$successMsg\n\t</div>\n\t\";\n}\n\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n * Description:\n *\t\tglobal error handling for all PEAR packages, it isn't too wise to do\n *\t\tthat as I've no idea what other php applications are running on this machine\n *\t\teven though this is really just about handling the error but still.\n *\t\tSo instead we're using the object's error handling method (see library/opendb.php)\n *\t\tPEAR::setErrorHandling(PEAR_ERROR_CALLBACK, 'errorHandler');\n *\n * Authors:\tLiran Tal <liran@enginx.com>\n *\n *********************************************************************************************************\n */\n\n\nfunction errorHandler($err) {\n\techo(\"<br/><b>Database error</b><br>\n\t\t<b>Error Message: </b>\" . $err->getMessage() . \"<br><b>Debug info: </b>\" . $err->getDebugInfo() . \"<br>\");\n}\n\n?>\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n * Description:\n *\t\tthis script displays the radius log file ofcourse\n *\t\tproper premissions must be applied on the log file for the web\n *\t\tserver to be able to read it\n *\n * Authors:\tLiran Tal <liran@enginx.com>\n *\n *********************************************************************************************************\n */\n\n$logfile_loc1 = '/var/log/dmesg';\n$logfile_loc2 = '/usr/local/var/log/dmesg';\n\nif (file_exists($logfile_loc1))\n\t$logfile = $logfile_loc1;\nelse if (file_exists($logfile_loc2))\n\t$logfile = $logfile_loc2;\nelse {\n\t$failureMsg = \"error reading log file: <br/>\".\n\t\t\"looked for log file in $logfile_loc1 and $logfile_loc2 but couldn't find it.<br/>\".\n\t\t\"if you know where your dmesg (boot) log file is located, set it's location in \" . $_SERVER[SCRIPT_NAME];\n\texit;\n}\n\t\n\nif (is_readable($logfile) == false) {\n\t$failureMsg = \"error reading log file: <u>$logfile</u> <br/>\".\n\t\t\"possible cause is file premissions or file doesn't exist.<br/>\";\n} else {\n                if (file_get_contents($logfile)) {\n                        $fileReversed = array_reverse(file($logfile));\n                        $counter = $bootLineCount;\n                        foreach ($fileReversed as $line) {\n                                if (preg_match(\"/$bootFilter/i\", $line)) {\n                                        if ($counter == 0)\n                                                break;\n                                        $ret = preg_replace(\"/\\n/i\", \"<br>\", $line);\n                                        echo $ret;\n                                        $counter--;\n                                }\n                        }\n                }\n}\n\n?>\n\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n * Description:\n *\t\tthis script displays the daloradius log file ofcourse\n *\t\tproper premissions must be applied on the log file for the web\n *\t\tserver to be able to read it\n *\n * Authors:\tLiran Tal <liran@enginx.com>\n *\n *********************************************************************************************************\n */\n\n\nif (isset($configValues['CONFIG_LOG_FILE'])) {\n\t$logfile = $configValues['CONFIG_LOG_FILE'];\n\n\tif (!file_exists($logfile)) {\n\n                $failureMsg = \"error reading log file: <b>$logfile</b><br/>\".\n\t\t\t\t\"looked for log file in $logfile but couldn't find it.<br/>\".\n\t\t\t\t\"if you know where your daloradius log file is located, set it's location in your library/daloradius.conf file\";\n\t} else {\n\n\n\t\tif (is_readable($logfile) == false) {\n\n\t                $failureMsg = \"error reading log file: <b>$logfile</b><br/>\".\n\t\t\t\t\"possible cause is file premissions or file doesn't exist.<br/>\";\n\n\t\t} else {\n\t\t    if (file_get_contents($logfile)) {\n\t\t\t\t$fileReversed = array_reverse(file($logfile));\n\t\t\t\t$counter = $daloradiusLineCount;\n\n\t\t\t\t// This doesn't take in any filter value\n\t\t\t\t// from the forms.\n\t\t\t\t// This takes in the log count though.\n\t\t\t\tforeach ($fileReversed as $line) {\n\t\t\t\t\tif ($counter == 0) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\techo $line . \"<br>\";\n\t\t\t\t\t$counter--;\n\t\t\t\t}\n\t\t\t\t// Old Code\n\t\t\t\t// $counter = $daloradiusLineCount;\n\t\t\t\t// foreach ($fileReversed as $line) {\n\t\t\t\t// \tif (preg_match(\"/$daloradiusFilter/i\", $line)) {\n\t\t\t\t// \t\tif ($counter == 0)\n\t\t\t\t// \t\t\tbreak;\n\t\t\t\t// \t\t$ret = eregi_replace(\"\\n\", \"<br>\", $line);\n\t\t\t\t// \t\techo $ret;\n\t\t\t\t// \t\t$counter--;\n\t\t\t\t// \t}\n\t\t\t\t// }\n\t\t\t}\n\t\t}\n\t}\n}\n\n?>\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n * Description:\n *\t\tThis code allows for running the 'radtest' binary tool provided with freeradius\n *\t\tfor performing a dry-run check to see if a user is able to successfully login\n *\t\tor that there may be problems connecting.\n *\n * Authors:\tLiran Tal <liran@enginx.com>\n *\t\tGiso Kegal <kegel@barum.de>\n *\n *********************************************************************************************************\n */\n\n\n// user_auth function\n// sends to the radius server an authentication request packet (for the sake of testing a user)\n// $radiusaddr\t- the server address, this would most likely be the radius server IP Address/Hostname\n// $radiusport  - the server's port number, radius server's port number (1812 or the old port for auth)\n// $options\t- the options passed to the radclient program\n// $command\t- the command string that radclient sends (auth, acct, status, coa, disconnect), by default this functions does 'auth'\nfunction user_auth($options,$user,$pass,$radiusaddr,$radiusport,$secret,$command=\"auth\",$additional=\"\") {\n\n\t$user = escapeshellarg($user);\n\t$pass = escapeshellarg($pass);\n\n\t$args = escapeshellarg(\"$radiusaddr:$radiusport\").\" \".escapeshellarg($command).\n\t\t\" \".escapeshellarg($secret);\n\t$query = \"User-Name=$user,User-Password=$pass\";\n\n\t$radclient = \"radclient\"; \t\t// or you can change this with the full path if the binary radcilent program can not be\n\t\t\t\t\t\t\t\t\t// found within your $PATH variable\n\n\t$radclient_options = \"-c \".escapeshellarg($options['count']).\n\t\t\t\t\" -n \".escapeshellarg($options['requests']).\n\t\t\t\t\" -r \".escapeshellarg($options['retries']).\n\t\t\t\t\" -t \".escapeshellarg($options['timeout']).\n\t\t\t\t\" \".$options['debug'];\n\n\tif ($options['dictionary'])\n\t\t$radclient_options .= \" -d \".escapeshellarg($options['dictionary']);\n\n\t$cmd = \"echo \".escapeshellcmd($query).\" | $radclient $radclient_options $args 2>&1\";\n\n\t$print_cmd = \"<b>Executed:</b><br/>$cmd<br/><br/><b>Results:</b><br/>\";\n\t$res = shell_exec($cmd);\n\n\tif ($res == \"\") {\n\t\techo \"<b>Error:</b> Command did not return any results<br/>\";\n\t\techo \"Please check that you have the radclient binary program installed and that\n\t\t\tit is found in your \\$PATH variable<br/>\n\t\t\tYou may also consult the file library/exten-maint-radclient.php for other problems<br/>\n\t\t\";\n\t}\n\n\t// todo better layout\n\t$output_html = nl2br($res);\n\treturn $print_cmd . $output_html;\n}\n\n\n// user_disconnect function\n// sends to the NAS a CoA (Change of Authorization) or a CoD (Disconnect) packet\n// $nasaddr\t- NAS address to receive the coa or disconnect request packet\n// $nasport\t- NAS Port address (depends on the configuration on the NAS, this may be a different port for either CoA or Disconnect packets).\nfunction user_disconnect($options,$user,$nasaddr,$nasport=\"3779\",$nassecret,$command=\"disconnect\",$additional=\"\") {\n\n\t$user = escapeshellarg($user);\n\n\t$args = escapeshellarg(\"$nasaddr:$nasport\").\" \".escapeshellarg($command).\" \".\n\t\t\tescapeshellarg($nassecret);\n\t$query = \"User-Name=$user\";\n\n\tif (!empty($additional)) {\n\t\t$query .= ','.$additional;\n\t}\n\n\t$radclient = \"radclient\"; \t\t// or you can change this with the full path if the binary radcilent program can not be\n\t\t\t\t\t\t// found within your $PATH variable\n\n\t$radclient_options = \"-c \".escapeshellarg($options['count']).\n\t\t\t\t\" -n \".escapeshellarg($options['requests']).\n\t\t\t\t\" -r \".escapeshellarg($options['retries']).\n\t\t\t\t\" -t \".escapeshellarg($options['timeout']).\n\t\t\t\t\" \".$options['debug'];\n\n\tif ($options['dictionary'])\n\t\t$radclient_options .= \" -d \".escapeshellarg($options['dictionary']);\n\n\t$cmd = \"echo \\\"\".escapeshellcmd($query).\"\\\" | $radclient $radclient_options $args 2>&1\";\n\t$print_cmd = \"<b>Executed:</b><br/>$cmd<br/><br/><b>Results:</b><br/>\";\n\t$res = shell_exec($cmd);\n\n\tif ($res == \"\") {\n\t\techo \"<b>Error:</b> Command did not return any results<br/>\";\n\t\techo \"Please check that you have the radclient binary program installed and that\n\t\t\tit is found in your \\$PATH variable<br/>\n\t\t\tYou may also consult the file library/exten-maint-radclient.php for other problems<br/>\n\t\t\";\n\t}\n\n\t// todo better layout\n\t$output_html = nl2br($res);\n\treturn $print_cmd . $output_html;\n}\n\n?>\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n * Description:\n *\t\tthis script displays the radius log file ofcourse\n *\t\tproper premissions must be applied on the log file for the web\n *\t\tserver to be able to read it\n *\n * Authors:\tLiran Tal <liran@enginx.com>\n *\n *********************************************************************************************************\n */\n \n\n$logfile_loc = array();\n$logfile_loc[1] = '/var/log/freeradius/radius.log';\n$logfile_loc[2] = '/usr/local/var/log/radius/radius.log';\n$logfile_loc[3] = '/var/log/radius/radius.log';\n\nforeach ($logfile_loc as $tmp) {\n\tif (file_exists($tmp)) { \n\t\t$logfile = $tmp; \n\t\tbreak;\n\t}\n}\n \n\nif (empty($logfile)) {\n\techo \"<br/><br/>\n\t\terror reading log file: <br/><br/>\n\t\tlooked for log file in '\".implode(\", \", $logfile_loc).\"' but couldn't find it.<br/>\n\t\tif you know where your freeradius log file is located, set it's location in \" . $_SERVER['SCRIPT_NAME'];\n\texit;\n}\n\t\n\nif (is_readable($logfile) == false) {\n\techo \"<br/><br/>\n\t\terror reading log file: <u>$logfile</u> <br/><br/>\n\t\tpossible cause is file premissions or file doesn't exist.<br/>\";\n} else {\n    if (file_get_contents($logfile)) {\n\n     $counter = $radiusLineCount;\n     $fileReversed = array_reverse(file($logfile));\n     foreach ($fileReversed as $line) {\n        if($counter == 0) {\n          break;\n        }\n        echo $line . \"<br>\";\n        $counter--;\n      }\n      // $counter = $radiusLineCount;\n      // foreach ($fileReversed as $line) {\n      //         if (preg_match(\"/$radiusFilter/i\", $line)) {\n      //                 if ($counter == 0)\n      //                         break;\n      //                 $ret = eregi_replace(\"\\n\", \"<br>\", $line);\n      //                 echo $ret;\n      //                 $counter--;\n      //         }\n      // }\n    }\n}\n\n?>\n\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n * Description:\n *\t\tthis script runs a check to see if freeradius is up and running\n*\t\tthe check is done by looking for a 'radius' process listening\n*\t\ton any socket interface. clumsy, but that's what we got for now\n *\n * Authors:\tLiran Tal <liran@enginx.com>\n *\n *********************************************************************************************************\n */\n \nfunction check_service($sname) {\n\tif ($sname != '') {\n\t\tsystem(\"pgrep \".escapeshellarg($sname).\" >/dev/null 2>&1\", $ret_service);\n\t\tif ($ret_service == 0) {\n\t\t\treturn \"Enabled\";\n\t\t} else {\n\t\t\treturn \"Disabled\";\n\t\t}\n\t} else {\n\t\treturn \"no service name\";\n\t}\n}\n\n?>\n\n<?php\n\techo \"<h3>Service Status</h3>\";\n?>\n\n<table class='summarySection'>\n  <tr>\n    <td class='summaryKey'> Radius </td>\n    <td class='summaryValue'><span class='sleft'><?php echo check_service(\"radius\"); ?></span> </td>\n  </tr>\n  <tr>\n    <td class='summaryKey'> Mysql </td>\n    <td class='summaryValue'><span class='sleft'><?php echo check_service(\"mysql\");  ?></span> </td>\n  </tr>\n</table>\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n * Description:\n * \t\tthis script process some important server information and displays it\n *\n * Authors:\tLiran Tal <liran@enginx.com>\n *\t\tCarlos Cesario <carloscesario@gmail.com>\n *\n *********************************************************************************************************\n */\n\tinclude_once('include/management/pages_common.php');\n\n// Display uptime system\n// @return string Return uptime system\nfunction uptime() {\n\t$file_name = \"/proc/uptime\";\n\n\t$fopen_file = fopen($file_name, 'r');\n\t$buffer = explode(' ', fgets($fopen_file, 4096));\n\tfclose($fopen_file);\n\n\t$sys_ticks = trim($buffer[0]);\n\t$min = $sys_ticks / 60;\n\t$hours = $min / 60;\n\t$days = floor($hours / 24);\n\t$hours = floor($hours - ($days * 24));\n\t$min = floor($min - ($days * 60 * 24) - ($hours * 60));\n\t$result = \"\";\n\n\tif ($days != 0) {\n\t\tif ($days > 1)\n\t\t\t$result = \"$days \" . \" days \";\n\t\telse\n\t\t\t$result = \"$days \" . \" day \";\n\t}\n\n\tif ($hours != 0) {\n\t\tif ($hours > 1)\n\t\t\t$result .= \"$hours \" . \" hours \";\n\t\telse\n\t\t\t$result .= \"$hours \" . \" hour \";\n\t}\n\n\tif ($min > 1 || $min == 0)\n\t\t$result .= \"$min \" . \" minutes \";\n\telseif ($min == 1)\n\t\t$result .= \"$min \" . \" minute \";\n\n\treturn $result;\n}\n\n\n// Display hostname system\n// @return string System hostname or none\nfunction get_hostname() {\n\t$file_name = \"/proc/sys/kernel/hostname\";\n\n\tif ($fopen_file = fopen($file_name, 'r')) {\n\t\t$result = trim(fgets($fopen_file, 4096));\n\t\tfclose($fopen_file);\n\t} else {\n\t\t$result = \"(none)\";\n\t}\n\n\treturn $result;\n}\n\n\n// Display currenty date/time\n// @return string Current system date/time or none\nfunction get_datetime() {\n\tif ($today = date(\"F j, Y, g:i a\")) {\n\t\t$result = $today;\n\t} else {\n\t\t$result = \"(none)\";\n\t}\n\n\treturn $result;\n}\n\n\n\n// Get System Load Average\n// @return array System Load Average\nfunction get_system_load() {\n\t$file_name = \"/proc/loadavg\";\n\t$result = \"\";\n\t$output = \"\";\n\n\t// get the /proc/loadavg information\n\tif ($fopen_file = fopen($file_name, 'r')) {\n\t\t$result = trim(fgets($fopen_file, 256));\n\t\tfclose($fopen_file);\n\t} else {\n\t\t$result = \"(none)\";\n\t}\n\n\t$loadavg = explode(\" \", $result);\n\t$output .= $loadavg[0] . \" \" . $loadavg[1] . \" \" . $loadavg[2] . \"<br/>\";\n\n\n\t// get information the 'top' program\n\t$file_name = \"top -b -n1 | grep \\\"Tasks:\\\" -A1\";\n\t$result = \"\";\n\n\tif ($popen_file = popen($file_name, 'r')) {\n\t\t$result = trim(fread($popen_file, 2048));\n\t\tpclose($popen_file);\n\t} else {\n\t\t$result = \"(none)\";\n\t}\n\n\t$result = str_replace(\"\\n\", \"<br/>\", $result);\n\t$output .= $result;\n\n\treturn $output;\n}\n\n\n// Get Memory System MemTotal|MemFree\n// @return array Memory System MemTotal|MemFree\nfunction get_memory() {\n\t$file_name = \"/proc/meminfo\";\n\t$mem_array = array();\n\n\t$buffer = file($file_name);\n\n\twhile (list($key, $value) = each($buffer)) {\n\t\tif (strpos($value, ':') !== false) {\n\t\t\t$match_line = explode(':', $value);\n\t\t\t$match_value = explode(' ', trim($match_line[1]));\n\t\t\tif (is_numeric($match_value[0])) {\n\t\t\t\t$mem_array[trim($match_line[0])] = trim($match_value[0]);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn $mem_array;\n}\n\n\n//Get FreeDiskSpace\nfunction get_hdd_freespace() {\n$df = disk_free_space(\"/\");\nreturn $df;\n}\n\n\n// Convert value to MB\n// @param decimal $value\n// @return int Memory MB\nfunction convert_ToMB($value) {\n\treturn round($value / 1024) . \" MB\\n\";\n}\n\n\n\n// Get all network names devices (eth[0-9])\n// @return array Get list network name interfaces\nfunction get_interface_list() {\n\t$devices = array();\n\t$file_name = \"/proc/net/dev\";\n\n\tif ($fopen_file = fopen($file_name, 'r')) {\n\t\twhile ($buffer = fgets($fopen_file, 4096)) {\n\t\t\tif (preg_match(\"/eth[0-9][0-9]*/i\", trim($buffer), $match)) {\n\t\t\t\t$devices[] = $match[0];\n\t\t\t}\n\t\t}\n\t\t$devices = array_unique($devices);\n\t\tsort($devices);\n\t\tfclose ($fopen_file);\n\t}\n\treturn $devices;\n}\n\n\n\n// Get ip address\n// @param string $ifname\n// @return string Ip address or (none)\nfunction get_ip_addr($ifname) {\n\t$command_name = \"/sbin/ifconfig $ifname\";\n\t$ifip = \"\";\n\n\texec($command_name , $command_result);\n\n\t$ifip = implode($command_result, \"\\n\");\n\tif (preg_match(\"/inet addr:[0-9\\.]*/i\", $ifip, $match)) {\n\t\t$match = explode(\":\", $match[0]);\n\t\treturn $match[1];\n\t} elseif (preg_match(\"/inet [0-9\\.]*/i\", $ifip, $match)) {\n\t\t$match = explode(\" \", $match[0]);\n\t\treturn $match[1];\n\t} else {\n\t\treturn \"(none)\";\n\t}\n}\n\n// Get mac address\n// @param string $ifname\n// @return string Mac address or (none)\nfunction get_mac_addr($ifname) {\n\t$command_name = \"/sbin/ifconfig $ifname\";\n\t$ifip = \"\";\n\n\texec($command_name , $command_result);\n\n\t$ifmac = implode($command_result, \"\\n\");\n\tif (preg_match(\"/hwaddr [0-9A-F:]*/i\", $ifmac, $match)) {\n\t\t$match = explode(\" \", $match[0]);\n\t\treturn $match[1];\n\t} elseif (preg_match(\"/ether [0-9A-F:]*/i\", $ifmac, $match)) {\n\t\t$match = explode(\" \", $match[0]);\n\t\treturn $match[1];\n\t} else {\n\t\treturn \"(none)\";\n\t}\n}\n\n\n// Get netmask address\n// @param string $ifname\n// @return string Netmask address or (none)\nfunction get_mask_addr($ifname) {\n\t$command_name = \"/sbin/ifconfig $ifname\";\n\t$ifmask = \"\";\n\n\texec($command_name , $command_result);\n\n\t$ifmask = implode($command_result, \"\\n\");\n\tif (preg_match(\"/mask:[0-9\\.]*/i\", $ifmask, $match)) {\n\t\t$match = explode(\":\", $match[0]);\n\t\treturn $match[1];\n\t} elseif (preg_match(\"/netmask [0-9\\.]*/i\", $ifmask, $match)) {\n\t\t$match = explode(\" \", $match[0]);\n\t\treturn $match[1];\n\t} else {\n\t\treturn \"(none)\";\n\t}\n}\n\n?>\n\n\n<?php\n\techo \"<h3>General Information</h3>\";\n?>\n\n<table class='summarySection'>\n  <tr>\n    <td class='summaryKey'> Uptime </td>\n    <td class='summaryValue'><span class='sleft'><?php echo uptime(); ?></span> </td>\n  </tr>\n  <tr>\n    <td class='summaryKey'> System Load </td>\n    <td class='summaryValue'><span class='sleft'><?php echo get_system_load(); ?></span> </td>\n  </tr>\n  <tr>\n    <td class='summaryKey'> Hostname </td>\n    <td class='summaryValue'><span class='sleft'><?php echo get_hostname(); ?></span> </td>\n  </tr>\n  <tr>\n    <td class='summaryKey'> Current Date </td>\n    <td class='summaryValue'><span class='sleft'><?php echo get_datetime(); ?></span> </td>\n  </tr>\n</table>\n\n\n<?php\n\techo \"<h3>Memory Information</h3>\";\n\t$meminfo = get_memory();\n?>\n\n\n<table class='summarySection'>\n  <tr>\n    <td class='summaryKey'> Mem. Total </td>\n    <td class='summaryValue'><span class='sleft'><?php echo convert_ToMB ($meminfo['MemTotal']); ?></span> </td>\n  </tr>\n  <tr>\n    <td class='summaryKey'> Mem. Free </td>\n    <td class='summaryValue'><span class='sleft'><?php echo convert_ToMB ($meminfo['MemFree']); ?></span> </td>\n  </tr>\n  <tr>\n    <td class='summaryKey'> Mem. Used </td>\n    <td class='summaryValue'>\n\t\t<span class='sleft'>\n\t\t\t<?php\n\t\t\t\t$memused = ($meminfo['MemTotal'] - $meminfo['MemFree']);\n\t\t\t\techo convert_ToMB ($memused);\n\t\t\t?>\n\t\t</span> </td>\n  </tr>\n</table>\n\n\n<?php\n\techo \"<h3>Harddrive Information</h3>\";\n\t$hddfreespace = get_hdd_freespace();\n?>\n\n\n<table class='summarySection'>\n  <tr>\n    <td class='summaryKey'> Free Drive Space </td>\n    <td class='summaryValue'><span class='sleft'><?php echo toxbyte ($hddfreespace); ?></span> </td>\n  </tr>\n\n</table>\n\n<?php\n\techo \"<h3>Network Interfaces</h3>\";\n\t$iflist = get_interface_list();\n\n\tforeach ($iflist as $ifname) {\n\t\t\techo \"\\t<table class='summarySection'>\\n\";\n\t\t\techo \"\\t<tr>\\n\";\n\t\t\techo \"\\t\\t<td class='summaryKey'></td>\\n\";\n\t\t\techo \"\\t\\t<td class='stitle'>\\n\";\n\t\t\techo \"\\t\\t\\t$ifname\\n\";\n\t\t\techo \"\\t\\t</td>\\n\";\n\t\t\techo \"\\t</tr>\\n\";\n\t\t\techo \"\\t<tr>\\n\";\n\t\t\techo \"\\t<tr>\\n\";\n\t\t\techo \"\\t\\t<td class='summaryKey'>\\n\";\n\t\t\techo \"\\t\\t\\tIp\\n\";\n\t\t\techo \"\\t\\t</td>\\n\";\n\t\t\techo \"\\t\\t<td class='summaryValue'>\\n\";\n\t\t\techo \"\\t\\t\\t\".get_ip_addr($ifname).\"\\n\";\n\t\t\techo \"\\t\\t</td>\\n\";\n\t\t\techo \"\\t</tr>\\n\";\n\t\t\techo \"\\t<tr>\\n\";\n\t\t\techo \"\\t\\t<td class='summaryKey'>\\n\";\n\t\t\techo \"\\t\\t\\tMask\\n\";\n\t\t\techo \"\\t\\t</td>\\n\";\n\t\t\techo \"\\t\\t<td class='summaryValue'>\\n\";\n\t\t\techo \"\\t\\t\\t\".get_mask_addr($ifname).\"\\n\";\n\t\t\techo \"\\t\\t</td>\\n\";\n\t\t\techo \"\\t</tr>\\n\";\n\t\t\techo \"\\t<tr>\\n\";\n\t\t\techo \"\\t\\t<td class='summaryKey'>\\n\";\n\t\t\techo \"\\t\\t\\tMAC address\\n\";\n\t\t\techo \"\\t\\t<td class='summaryValue'>\\n\";\n\t\t\techo \"\\t\\t\\t\".get_mac_addr($ifname).\"\\n\";\n\t\t\techo \"\\t\\t</td>\\n\";\n\t\t\techo \"\\t</tr>\\n\";\n\t\t}\n\n\techo \"\\t</table>\\n\";\n?>\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n * Description:\n *\t\tthis script displays the radius log file ofcourse\n *\t\tproper premissions must be applied on the log file for the web\n *\t\tserver to be able to read it\n *\n * Authors:\tLiran Tal <liran@enginx.com>\n *\n *********************************************************************************************************\n */\n\n\n$logfile_loc1 = '/var/log/syslog';\n$logfile_loc2 = '/var/log/messages';\n\nif (file_exists($logfile_loc1))\n\t$logfile = $logfile_loc1;\nelse if (file_exists($logfile_loc2))\n\t$logfile = $logfile_loc2;\nelse {\n\t$failureMsg = \"error reading system log file:<br/>\".\n\t\t\"looked for log file in $logfile_loc1 and $logfile_loc2 but couldn't find it.<br/>\".\n\t\t\"if you know where your system log file is located, set it's location in \" . $_SERVER[SCRIPT_NAME];\n\texit;\n}\n\nif (is_readable($logfile) == false) {\n\t$failureMsg = \"error reading log file: <u>$logfile</u> <br/>\".\n\t\t\"possible cause is file premissions or file doesn't exist.<br/>\";\n} else {\n                if (file_get_contents($logfile)) {\n                        $fileReversed = array_reverse(file($logfile));\n                        $counter = $systemLineCount;\n                        foreach ($fileReversed as $line) {\n                                if (preg_match(\"/$systemFilter/i\", $line)) {\n                                        if ($counter == 0)\n                                                break;\n                                        $ret = preg_replace(\"/\\n/i\", \"<br>\", $line);\n                                        echo $ret;\n                                        $counter--;\n                                }\n                        }\n                }\n}\n\n?>\n\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n * Description:\n *\t\tdisplays a welcome page for the main index.php file\n *\n * Authors:\tLiran Tal <liran@enginx.com>\n *          Miguel Garc\u00eda <miguelvisgarcia@gmail.com>\n *\n *********************************************************************************************************\n */\n\necho \"\n\t<center>\n\n\t\t<h2> daloRADIUS Web Management Server </h2>\n\t\t<h3> \".t('all','daloRADIUSVersion').\" / \".$configValues['DALORADIUS_DATE'].\" </h3>\n\t\t<h4> <a href=\\\"mailto:liran.tal@gmail.com\\\"> Liran Tal </a> </h4>\n\t\t<br/><br/><br/>\n\t\t<img src='images/daloradius_logo.jpg' border=0 />\n\t</center>\n\";\n\n?>\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n *\n * Authors:\tLiran Tal <liran@enginx.com>\n *\n *********************************************************************************************************\n */\n\n    include (\"library/checklogin.php\");\n    $operator = $_SESSION['operator_user'];\n\n\tinclude('library/check_operator_perm.php');\n\n        isset($_GET['bootLineCount']) ? $bootLineCount = $_GET['bootLineCount'] : $bootLineCount = 50;\n        isset($_GET['bootFilter']) ? $bootFilter = $_GET['bootFilter'] : $bootFilter = \".\";\n\n\n\tinclude_once('library/config_read.php');\n    $log = \"visited page: \";\n    $logQuery = \"performed query on page: \";\n    include('include/config/logging.php');\n\n?>\n\n<?php\n\n    include (\"menu-reports-logs.php\");\n  \t\n?>\t\n\t\t<div id=\"contentnorightbar\">\n\t\t\n\t\t<h2 id=\"Intro\"><a href=\"#\" onclick=\"javascript:toggleShowDiv('helpPage')\"><?php echo t('Intro','replogsboot.php'); ?>\n                :: <?php if (isset($bootLineCount)) { echo $bootLineCount . \" Lines Count \"; } ?>\n                   <?php if (isset($bootFilter)) { echo \" with filter set to \" . $bootFilter; } ?>\n\t\t<h144>&#x2754;</h144></a></h2>\n\n\t\t<div id=\"helpPage\" style=\"display:none;visibility:visible\" >\n\t\t\t<?php echo t('helpPage','replogsboot') ?>\n\t\t\t<br/>\n\t\t</div>\n\t\t<br/>\n\n<?php\n\tinclude 'library/exten-boot_log.php';\n?>\n\n                <?php\n                        include_once('include/management/actionMessages.php');\n                ?>\n\n\n\t\t</div>\n\t\t\n\t\t<div id=\"footer\">\n\t\t\n\t\t\t\t\t\t\t\t<?php\n        include 'page-footer.php';\n?>\n\t\t\n\t\t</div>\n\t\t\n</div>\n</div>\n\n\n</body>\n</html>\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n *\n * Authors:\tLiran Tal <liran@enginx.com>\n *\n *********************************************************************************************************\n */\n\n\tinclude (\"library/checklogin.php\");\n\t$operator = $_SESSION['operator_user'];\n\n\tinclude('library/check_operator_perm.php');\n\n\tisset($_GET['daloradiusLineCount']) ? $daloradiusLineCount = $_GET['daloradiusLineCount'] : $daloradiusLineCount = 50;\n\tisset($_GET['daloradiusFilter']) ? $daloradiusFilter = $_GET['daloradiusFilter'] : $daloradiusFilter = \".\";\n\n\tinclude_once('library/config_read.php');\n\t$log = \"visited page: \";\n\t$logQuery = \"performed query on page: \";\n\tinclude('include/config/logging.php');\n\n?>\n\n<?php\n\n    include (\"menu-reports-logs.php\");\n  \t\n?>\t\n\n\n\t<div id=\"contentnorightbar\">\n\t\t\n\t\t<h2 id=\"Intro\"><a href=\"#\"  onclick=\"javascript:toggleShowDiv('helpPage')\"><?php echo t('Intro','replogsdaloradius.php'); ?>\n\t\t:: <?php if (isset($daloradiusLineCount)) { echo $daloradiusLineCount . \" Lines Count \"; } ?>\n\t\t   <?php if (isset($daloradiusFilter)) { echo \" with filter set to \" . $daloradiusFilter; } ?>\n\t\t<h144>&#x2754;</h144></a></h2>\n\n\t\t<div id=\"helpPage\" style=\"display:none;visibility:visible\" >\n\t\t\t<?php echo t('helpPage','replogsdaloradius') ?>\n\t\t\t<br/>\n\t\t</div>\n\n<?php\n\tinclude 'library/exten-daloradius_log.php';\n?>\n\n                <?php\n                        include_once('include/management/actionMessages.php');\n                ?>\n\n\t</div>\n\t\n\t<div id=\"footer\">\n\t\n<?php\n\tinclude 'page-footer.php';\n?>\n\n\t</div>\n\n</div>\n</div>\n\n\n</body>\n</html>\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n *\n * Authors:\tLiran Tal <liran@enginx.com>\n *\n *********************************************************************************************************\n */\n\n    include (\"library/checklogin.php\");\n    $operator = $_SESSION['operator_user'];\n\n\tinclude('library/check_operator_perm.php');\n\n        isset($_GET['radiusLineCount']) ? $radiusLineCount = $_GET['radiusLineCount'] : $radiusLineCount = 50;\n        isset($_GET['radiusFilter']) ? $radiusFilter = $_GET['radiusFilter'] : $radiusFilter = \".\";\n\n\n\tinclude_once('library/config_read.php');\n    $log = \"visited page: \";\n    $logQuery = \"performed query on page: \";\n    include('include/config/logging.php');\n\n\n?>\n\n<?php\n\n    include (\"menu-reports-logs.php\");\n  \t\n?>\t\n\t\t\n\t\t\n\t\t<div id=\"contentnorightbar\">\n\t\t\n\t\t<h2 id=\"Intro\"><a href=\"#\"  onclick=\"javascript:toggleShowDiv('helpPage')\"><?php echo t('Intro','replogsradius.php'); ?>\n                :: <?php if (isset($radiusLineCount)) { echo $radiusLineCount . \" Lines Count \"; } ?>\n                   <?php if (isset($radiusFilter)) { echo \" with radiusFilter set to \" . $radiusFilter; } ?>\n\t\t<h144>&#x2754;</h144></a></h2>\n\n\t\t<div id=\"helpPage\" style=\"display:none;visibility:visible\" >\n\t\t\t<?php echo t('helpPage','replogsradius') ?>\n\t\t\t<br/>\n\t\t</div>\n\t\t<br/>\n\n<?php\n\tinclude 'library/exten-radius_log.php';\n?>\n\n\t\t</div>\n\t\t\n\t\t<div id=\"footer\">\n\t\t\n\t\t\t\t\t\t\t\t<?php\n        include 'page-footer.php';\n?>\n\t\t\n\t\t</div>\n\t\t\n</div>\n</div>\n\n\n</body>\n</html>\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n *\n * Authors:\tLiran Tal <liran@enginx.com>\n *\n *********************************************************************************************************\n */\n\n    include (\"library/checklogin.php\");\n    $operator = $_SESSION['operator_user'];\n\n\tinclude('library/check_operator_perm.php');\n\n        isset($_GET['systemLineCount']) ? $systemLineCount = $_GET['systemLineCount'] : $systemLineCount = 50;\n        isset($_GET['systemFilter']) ? $systemFilter = $_GET['systemFilter'] : $systemFilter = \".\";\n\n\tinclude_once('library/config_read.php');\n    $log = \"visited page: \";\n    $logQuery = \"performed query on page: \";\n    include('include/config/logging.php');\n\n?>\n\n<?php\n\n    include (\"menu-reports-logs.php\");\n  \t\n?>\t\n\t\t<div id=\"contentnorightbar\">\n\t\t\n\t\t<h2 id=\"Intro\"><a href=\"#\"  onclick=\"javascript:toggleShowDiv('helpPage')\"><?php echo t('Intro','replogssystem.php'); ?>\n                :: <?php if (isset($systemLineCount)) { echo $systemLineCount . \" Lines Count \"; } ?>\n                   <?php if (isset($systemFilter)) { echo \" with filter set to \" . $systemFilter; } ?>\n\t\t<h144>&#x2754;</h144></a></h2>\n\n\t\t<div id=\"helpPage\" style=\"display:none;visibility:visible\" >\n\t\t\t<?php echo t('helpPage','replogssystem') ?>\n\t\t\t<br/>\n\t\t</div>\n\t\t<br/>\n\n<?php\n\tinclude 'library/exten-syslog_log.php';\n?>\n\n                <?php\n                        include_once('include/management/actionMessages.php');\n                ?>\n\n\n\t\t</div>\n\t\t\n\t\t<div id=\"footer\">\n\t\t\n\t\t\t\t\t\t\t\t<?php\n        include 'page-footer.php';\n?>\n\t\t\n\t\t</div>\n\t\t\n</div>\n</div>\n\n\n</body>\n</html>\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n*\n * Authors:\tLiran Tal <liran@enginx.com>\n *\n *********************************************************************************************************\n */\n\n    include (\"library/checklogin.php\");\n    $operator = $_SESSION['operator_user'];\n        \n\tinclude_once('library/config_read.php');\n    $log = \"visited page: \";\n\n\n?>\n\n<?php\n\n    include (\"menu-reports-logs.php\");\n\n?>\n\t\t\n\t\t<div id=\"contentnorightbar\">\n\t\t\n\t\t<h2 id=\"Intro\"><a href=\"#\" onclick=\"javascript:toggleShowDiv('helpPage')\"><?php echo t('Intro','replogs.php'); ?>\n\t\t<h144>&#x2754;</h144></a></h2>\n\n\t\t<div id=\"helpPage\" style=\"display:none;visibility:visible\" >\n\t\t\t<?php echo t('helpPage','replogs') ?>\n\t\t\t<br/>\n\t\t</div>\n\t\t<br/>\n\n\n\n<?php\n\tinclude('include/config/logging.php');\n?>\n\n\t\t</div>\n\t\t\n\t\t<div id=\"footer\">\n\t\t\n\t\t\t\t\t\t\t\t<?php\n        include 'page-footer.php';\n?>\n\n\t\t\n\t\t</div>\n\t\t\n</div>\n</div>\n\n\n</body>\n</html>\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n*\n * Authors:\tLiran Tal <liran@enginx.com>\n *\n *********************************************************************************************************\n */\n\n    include (\"library/checklogin.php\");\n    //$operator = $_SESSION['operator_user']\n\t//include('library/check_operator_perm.php');\n\n\tinclude_once('library/config_read.php');\n    $log = \"visited page: \";\n    $logQuery = \"performed query on page: \";\n    include('include/config/logging.php');\n    \n    $cronUser = get_current_user();\n    \n    isset($_GET['cmd']) ? $cmd = $_GET['cmd'] : $cmd = \"\";\n    \n    $dalo_crontab_file = dirname(__FILE__) . '/contrib/scripts/dalo-crontab';\n    \n    \n    switch ($cmd) {\n    \t\n    \tcase \"disable\":\n    \t\texec(\"`which crontab` -u $cronUser -r\");\n    \t\tbreak;\n    \t\n    \tcase \"enable\":\n    \t\texec(\"`which crontab` -u $cronUser $dalo_crontab_file\");\n    \t\tbreak;\n    }\n    \n    \n?>\n\n\n<?php\n\n    include (\"menu-reports-status.php\");\n    \n?>\t\n\t\t\n\t\t\n\t\t\n\t\t<div id=\"contentnorightbar\">\n\t\t\n\t\t<h2 id=\"Intro\"><a href=\"#\"  onclick=\"javascript:toggleShowDiv('helpPage')\">CRON Status\n\t\t<h144>&#x2754;</h144></a></h2>\n\n\t\t<div id=\"helpPage\" style=\"display:none;visibility:visible\" >\n\t\t\t<br/>\n\t\t</div>\n\t\t<br/>\n\n\n<?php\n\t\n\texec(\"/usr/bin/crontab -u $cronUser -l\", $output, $retStatus);\n\t\n?>\n\n\n\t<h3>CRON Entries</h3>\n\n\t<a href='rep-stat-cron.php?cmd=enable' >Enable CRON</a>\n\t&nbsp;\n\t<a href='rep-stat-cron.php?cmd=disable' >Disable CRON</a>\n\n\t<br/>\n\t<br/>\n\n<?php \n\tif ($retStatus != 0):\t\t \n?>\n\t<font color='red'><b>Error</b> no crontab is configured for this user or user does not exist</font>\n\t<br/><br/>\n\n<?php\n\telse:\n\t\n\t$i = 0;\n\t\tforeach($output as $text) {\n\t\t\t$i++;\n\t\t\techo \"<b>#$i:</b> \" . $text . '<br/>';\n\t\t}\n\t\t\n\tendif;\n?>\n\n\t\t</div>\n\t\t\n\t\t<div id=\"footer\">\n\n<?php\n        include 'page-footer.php';\n?>\n\t\t\n\t\t</div>\n\t\t\n</div>\n</div>\n\n\n</body>\n</html>\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n*\n * Authors:\tLiran Tal <liran@enginx.com>\n *\n *********************************************************************************************************\n */\n\n    include (\"library/checklogin.php\");\n    $operator = $_SESSION['operator_user'];\n\n    include('library/check_operator_perm.php');\n\n\tinclude_once('library/config_read.php');\n    $log = \"visited page: \";\n    $logQuery = \"performed query on page: \";\n    include('include/config/logging.php');\n\n\n?>\n\n\n<?php\n\tinclude_once (\"library/tabber/tab-layout.php\");\n?>\n<?php\n\n    include (\"menu-reports-status.php\");\n  \t\n?>\t\n\t\t\n\t\t\n\t\t<div id=\"contentnorightbar\">\n\t\t\n\t\t<h2 id=\"Intro\"><a href=\"#\"  onclick=\"javascript:toggleShowDiv('helpPage')\">RAID Status\n\t\t<h144>&#x2754;</h144></a></h2>\n\n\t\t<div id=\"helpPage\" style=\"display:none;visibility:visible\" >\n\t\t\t<br/>\n\t\t</div>\n\t\t<br/>\n\n\n\n<div class=\"tabber\">\n\n\n<?php\n\n\tif (!file_exists('/proc/mdstat')):\n?>\n\t<font color='red'><b>Error</b> accessing RAID device information:</font>\n\t<br/><br/>\n\n<?php \n\telse: \n\texec(\"cat /proc/mdstat  | awk '/md/ {print $1}'\", $mdstat);\n\n?>\n\n\t<font color='red'><b>Error</b> accessing RAID device information:</font>\n\t<br/><br/>\n\n\t<?php\n\t\tforeach($mdstat as $mddevice):\n\t?>\n\n\t\t\t<div class=\"tabbertab\" title=\"<?php echo $mddevice ?>\">\n\n\t\t\t\t<?php\n\t\t\t\t\t$output = \"\";\n\t\t\t\t\t$cmd = \"sudo /sbin/mdadm --detail /dev/$mddevice\";\n\t\t\t\t\texec($cmd, $output);\n\t\t\t\t?>\n\t\t\n\t\t\t\t<table class='summarySection'>\n\t\t\n\t\t\t\t\t<?php\n\t\t\t\t\t\tforeach($output as $line):\n\t\t\t\t\t?>\n\t\t\t\n\t\t\t\t\t<?php\n\t\t\t\t\t\tlist($var, $val) = split(\":\", $line);\n\t\t\t\t\t?>\n\t\t\t\n\t\t\t\t\t  <tr>\n\t\t\t\t\t\t<td class='summaryKey'> <?php echo $var ?> </td>\n\t\t\t\t\t\t<td class='summaryValue'><span class='sleft'> <?php echo $val ?> </span> </td>\n\t\t\t\t\t  </tr>\n\t\t\t\n\t\t\t\t\t<?php endforeach; ?>\n\t\t\n\t\t\t\t</table>\n\t\t\n\t\t\t</div>\n\n\t<?php endforeach; ?>\n<?php endif; ?>\n\n</div>\n\n\n\n\n\t\t</div>\n\t\t\n\t\t<div id=\"footer\">\n\t\t\n<?php\n        include 'page-footer.php';\n?>\n\t\t\n\t\t</div>\n\t\t\n</div>\n</div>\n\n\n</body>\n</html>\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n*\n * Authors:\tLiran Tal <liran@enginx.com>\n *\n *********************************************************************************************************\n */\n\n    include (\"library/checklogin.php\");\n    $operator = $_SESSION['operator_user'];\n\n\tinclude('library/check_operator_perm.php');\n\n\n\n\tinclude_once('library/config_read.php');\n    $log = \"visited page: \";\n    $logQuery = \"performed query on page: \";\n    include('include/config/logging.php');\n\n?>\n\n<?php\n\n    include (\"menu-reports-status.php\");\n\t\n?>\t\n\t\t\n\t\t\n\t\t<div id=\"contentnorightbar\">\n\t\t\n\t\t<h2 id=\"Intro\"><a href=\"#\" onclick=\"javascript:toggleShowDiv('helpPage')\"><?php echo t('Intro','repstatserver.php'); ?>\n\t\t<h144>&#x2754;</h144></a></h2>\n\n\t\t<div id=\"helpPage\" style=\"display:none;visibility:visible\" >\n\t\t\t<?php echo t('helpPage','repstatserver') ?>\n\t\t\t<br/>\n\t\t</div>\n\t\t<br/>\n\t\t\t\t\n<?php\n\tinclude 'library/exten-server_info.php';\n?>\n\n\t\t</div>\n\t\t\n\t\t<div id=\"footer\">\n\t\t\n\t\t\t\t\t\t\t\t<?php\n        include 'page-footer.php';\n?>\n\t\t\n\t\t</div>\n\t\t\n</div>\n</div>\n\n\n</body>\n</html>\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n*\n * Authors:\tLiran Tal <liran@enginx.com>\n *\n *********************************************************************************************************\n */\n\n    include (\"library/checklogin.php\");\n    $operator = $_SESSION['operator_user'];\n\n\tinclude('library/check_operator_perm.php');\n\n\n\n\tinclude_once('library/config_read.php');\n    $log = \"visited page: \";\n    $logQuery = \"performed query on page: \";\n    include('include/config/logging.php');\n\n\n?>\n\n\n<?php\n\n    include (\"menu-reports-status.php\");\n  \t\n?>\t\n\t\t\n\t\t\n\t\t<div id=\"contentnorightbar\">\n\t\t\n\t\t<h2 id=\"Intro\"><a href=\"#\"  onclick=\"javascript:toggleShowDiv('helpPage')\"><?php echo t('Intro','repstatradius.php'); ?>\n\t\t<h144>&#x2754;</h144></a></h2>\n\n\t\t<div id=\"helpPage\" style=\"display:none;visibility:visible\" >\n\t\t\t<?php echo t('helpPage','repstatradius') ?>\n\t\t\t<br/>\n\t\t</div>\n\t\t<br/>\n\n<?php\n\tinclude 'library/exten-radius_server_info.php';\n?>\n\n\t\t</div>\n\t\t\n\t\t<div id=\"footer\">\n\t\t\n\t\t\t\t\t\t\t\t<?php\n        include 'page-footer.php';\n?>\n\t\t\n\t\t</div>\n\t\t\n</div>\n</div>\n\n\n</body>\n</html>\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n*\n * Authors:\tLiran Tal <liran@enginx.com>\n *\n *********************************************************************************************************\n */\n\n    include (\"library/checklogin.php\");\n    $operator = $_SESSION['operator_user'];\n\n    include('library/check_operator_perm.php');\n\n\tinclude_once('library/config_read.php');\n    $log = \"visited page: \";\n    $logQuery = \"performed query on page: \";\n    include('include/config/logging.php');\n\n\n?>\n\n\n<?php\n\n    include (\"menu-reports-status.php\");\n  \t\n?>\t\n\t\t\n\t\t\n\t\t<div id=\"contentnorightbar\">\n\t\t\n\t\t<h2 id=\"Intro\"><a href=\"#\"  onclick=\"javascript:toggleShowDiv('helpPage')\">UPS Status\n\t\t<h144>&#x2754;</h144></a></h2>\n\n\t\t<div id=\"helpPage\" style=\"display:none;visibility:visible\" >\n\t\t\t<br/>\n\t\t</div>\n\t\t<br/>\n\n\n\n\n<?php\n\texec(\"`which apcaccess`\", $output, $retStatus);\n?>\n\n\n\t<h3>General Information</h3>\n\n<?php \n\t$sep = \":\";\n\tif ($retStatus != 0):\n\t\t$sep = \"\\n\";\t\t \n?>\n\t<font color='red'><b>Error</b> accessing UPS device information:</font>\n\t<br/><br/>\n<?php endif; ?>\n\n<table class='summarySection'>\n\n\n<?php \n\tforeach($output as $line):\n\t\tlist($var, $val) = split($sep, $line);\n?>\n\n  <tr>\n    <td class='summaryKey'> <?php echo $var ?> </td>\n    <td class='summaryValue'><span class='sleft'> <?php echo $val ?> </span> </td>\n  </tr>\n\n<?php endforeach; ?>\n\n</table>\n\n\t\t</div>\n\t\t\n\t\t<div id=\"footer\">\n\n<?php\n        include 'page-footer.php';\n?>\n\t\t\n\t\t</div>\n\t\t\n</div>\n</div>\n\n\n</body>\n</html>\n"], "fixing_code": ["<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n * Description:\t   This file is used for controlling the logging actions\n * \n * Authors:        Liran Tal <liran@enginx.com>\n *                 Filippo Lauria <filippo.lauria@iit.cnr.it>\n *\n *********************************************************************************************************\n */\n\n// prevent this file to be directly accessed\nif (strpos($_SERVER['PHP_SELF'], '/include/config/logging.php') !== false) {\n    header(\"Location: ../../index.php\");\n    exit;\n}\n\n/*\n * It is important to understand that when logging.php is included in\n * a page AFTER an include for config_read.php it gains access to all\n * of the variables it's scope including the $configValues[....] because\n * it was included just before it.\n *\n * But it should be noticed that these variables are only accessible\n * in the scope of the general or main block of php code and are\n * not accessible from functions, so we can't just use $configValues[...]\n * variables from within logMessageNotice() or any other function\n * and so we must use them here as references.\n *\n * The relevant variables are:\n *\n * $operator\n * $_SERVER[\"SCRIPT_NAME\"]\n * $configValues['CONFIG_LOG_FILE']\n *\n */\n\n/*\n * @param $type        The message type, for example, NOTICE, DEBUG, ERROR, ACTION, etc...\n * @param $msg         The message string which should be logged to the file\n * @param $logFile     The full path for the filename to write logs to\n * @param $currPage    The current page that we included from\n * @return $table      The table name, either radcheck or radreply\n */\nfunction logMessage($type, $msg, $logFile, $currPage) {\n    $date = date('M d G:i:s');\n    $msgString = $date . \" \" . $type . \" \" . $msg . \" \" . $currPage;\n\n    $fp = fopen($logFile, \"a\");\n    if ($fp) {\n        fwrite($fp, $msgString  . \"\\n\");\n        fclose($fp);\n        return;\n    }\n\n    echo \"<div>\"\n       . '<span style=\"color: red\">error: could not open the file for writing: <strong>'\n       . $logFile . \"</strong></span><br>\"\n       . \"Check file permissions. The file should be writable by the webserver's user/group\"\n       . \"</div>\";\n}\n\n$logger_work = array();\n\nif ($configValues['CONFIG_LOG_PAGES'] == \"yes\" && isset($log) && !empty($log)) {\n    $logger_work['NOTICE'] = \"$operator $log\";\n}\n\nif ($configValues['CONFIG_LOG_QUERIES'] == \"yes\" && isset($logQuery) && !empty($logQuery)) {\n    $logger_work['QUERIES'] = \"$operator $logQuery\";\n}\n\n\nif ($configValues['CONFIG_LOG_ACTIONS'] == \"yes\" && isset($logAction) && !empty($logAction)) {\n    $logger_work['ACTIONS'] = \"$operator $logAction\";\n}\n\n/*\n ********************************************************************************\n * evaluating whether we need to debug SQL queries to the database as well.\n * $logDebugSQL is set for each $sql = \"query statement...\" on the actual page\n * in the following form:         $logDebugSQL += $sql . \"\\n\";\n *\n ********************************************************************************\n */\nif ($configValues['CONFIG_DEBUG_SQL'] == \"yes\" && isset($logDebugSQL) && !empty($logDebugSQL)) {\n    $logger_work['DEBUG'] = \"- SQL -\" . \" \" . $logDebugSQL . \" on page: \";\n}\n\nforeach ($logger_work as $type => $message) {\n    logMessage($type, $message, $configValues['CONFIG_LOG_FILE'], $_SERVER[\"SCRIPT_NAME\"]);\n}\n\n/* the continuation of the CONFIG_DEBUG_SQL actually, this prints to the page\n * being viewed */\nif ($configValues['CONFIG_DEBUG_SQL_ONPAGE'] == \"yes\"  && isset($logDebugSQL) && !empty($logDebugSQL)) {\n\techo \"<br><br>\"\n       . \"Debugging SQL Queries: <br>\"\n       . \"<pre>$logDebugSQL</pre>\"\n       . \"<br><br>\";\n}\n\n?>\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n *\n * Description:\n *             This file provides control for messages that are printed to the\n *             screen in reply to actions such as applying forms, saving data,\n *             removing data and such.\n * \n * Authors:    Liran Tal <liran@enginx.com>\n *             Filippo Lauria <filippo.lauria@iit.cnr.it>\n *\n *********************************************************************************************************\n */\n\n// prevent this file to be directly accessed\nif (strpos($_SERVER['PHP_SELF'], '/include/management/actionMessages.php') !== false) {\n    header(\"Location: ../../index.php\");\n    exit;\n}\n\nif (isset($failureMsg) && !empty($failureMsg)) {\n\tprintf('<div class=\"failure\">%s</div>', $failureMsg);\n}\n\nif (isset($successMsg) && !empty($successMsg)) {\n\tprintf('<div class=\"success\">%s</div>', $successMsg);\n}\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n * \n * Description:    global error handling for all PEAR packages, it isn't too wise to do\n *                 that as I've no idea what other php applications are running on this machine\n *                 even though this is really just about handling the error but still.\n *                 So instead we're using the object's error handling method (see library/opendb.php)\n *                 PEAR::setErrorHandling(PEAR_ERROR_CALLBACK, 'errorHandler');\n *\n * Authors:        Liran Tal <liran@enginx.com>\n *                 Filippo Lauria <filippo.lauria@iit.cnr.it>\n *\n *********************************************************************************************************\n */\n\n// prevent this file to be directly accessed\nif (strpos($_SERVER['PHP_SELF'], '/library/errorHandling.php') !== false) {\n    header(\"Location: ../index.php\");\n    exit;\n}\n\nfunction errorHandler($err) {\n    echo '<div class=\"failure\"><strong>Database error</strong><br>'\n       . \"Error message: <strong>\" . $err->getMessage() . \"</strong><br>\"\n       . \"Debug info: <br>\" . $err->getDebugInfo()\n       . \"</div>\";\n}\n\n?>\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n * Description:\n *        this script displays the radius log file.\n *        Of course proper premissions must be applied on the log file for the web\n *        server to be able to read it\n *\n * Authors:    Liran Tal <liran@enginx.com>\n *             Filippo Lauria <filippo.lauria@iit.cnr.it>\n *\n *********************************************************************************************************\n */\n\n// prevent this file to be directly accessed\n$extension_file = '/library/exten-boot_log.php';\nif (strpos($_SERVER['PHP_SELF'], $extension_file) !== false) {\n    header(\"Location: ../index.php\");\n    exit;\n}\n\n// possible locations for radius logs\n$logfile_loc = array(\n    '/var/log/boot',\n    '/var/log/dmesg',\n    '/usr/local/var/log/dmesg'\n);\n\n// select one log file\n$logfile = \"\";\n\nforeach ($logfile_loc as $tmp) {\n    if (file_exists($tmp)) { \n    $logfile = $tmp;\n        break;\n    }\n}\n\n$logfile_enc = (!empty($logfile)) ? htmlspecialchars($logfile, ENT_QUOTES, 'UTF-8') : '(none)';\n\n// check if it is empty\nif (empty($logfile)) {\n    $failureMsg = sprintf(\"<br><br>Error accessing log file: <strong>%s</strong><br><br>\" . \n                          \"Looked for log file in <strong>%s</strong> but could not find it.<br>\" .\n                          \"If you know where your <em>dmesg (boot) log file</em> is located, \" .\n                          \"specify its location in <strong>%s</strong>\",\n              $logfile_enc,\n              htmlspecialchars(implode(\", \", $logfile_loc), ENT_QUOTES, 'UTF-8'),\n              htmlspecialchars($extension_file, ENT_QUOTES, 'UTF-8'));\n} else {\n\n    // check if it is readable\n    if (is_readable($logfile) !== true) {\n        $failureMsg = sprintf(\"<br><br>Error reading log file: <strong>%s</strong>.<br><br>Is this file readable?<br>\",\n                              $logfile_enc);\n    } else {\n\n        // get its content\n        $logcontent = file_get_contents($logfile);\n        if (!empty($logcontent)) {\n            $counter = $bootLineCount;\n            $filter = (!empty($bootFilter)) ? preg_quote($bootFilter, \"/\") : \".+\";\n            $fileReversed = array_reverse(file($logfile));\n\n            echo '<div style=\"font-family: monospace\">';\n            foreach ($fileReversed as $line) {\n                if (preg_match(\"/$filter/i\", $line)) {\n                    if ($counter == 0) {\n                        break;\n                    }\n                    echo nl2br(htmlspecialchars($line, ENT_QUOTES, 'UTF-8'), false);\n                    $counter--;\n            }\n            }\n            echo '</div>';\n        }\n    }\n}\n\n?>\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n * Description:\n *        this script displays the daloradius log file ofcourse\n *        proper premissions must be applied on the log file for the web\n *        server to be able to read it\n *\n * Authors:    Liran Tal <liran@enginx.com>\n *             Filippo Lauria <filippo.lauria@iit.cnr.it>\n *\n *********************************************************************************************************\n */\n\n// prevent this file to be directly accessed\nif (strpos($_SERVER['PHP_SELF'], '/library/exten-daloradius_log.php') !== false) {\n    header(\"Location: ../index.php\");\n    exit;\n}\n\n// check if daloradius logfile is set\nif (array_key_exists('CONFIG_LOG_FILE', $configValues) && isset($configValues['CONFIG_LOG_FILE'])) {\n\n    $logfile = $configValues['CONFIG_LOG_FILE'];\n    $logfile_enc = (!empty($logfile)) ? htmlspecialchars($logfile, ENT_QUOTES, 'UTF-8') : '(none)';\n\n    // check if file exists\n    if (!file_exists($logfile)) {\n        $failureMsg = sprintf(\"<br><br>Error accessing log file: <strong>%s</strong><br><br>\"\n                            . \"Looked for log file in <strong>%s</strong> but could not find it.<br>\"\n                            . \"If you know where your <em>daloradius log file</em> is located, \"\n                            . \"specify its location in your <strong>library/daloradius.conf.php</strong> file\",\n                              $logfile_enc, $logfile_enc);\n    } else {\n        // check if it is readable\n        if (is_readable($logfile) !== true) {\n            $failureMsg = sprintf(\"<br><br>Error reading log file: <strong>%s</strong>.<br><br>Is this file readable?<br>\",\n                                  $logfile_enc);\n        } else {\n            // get its content\n            $logcontent = file_get_contents($logfile);\n            if (!empty($logcontent)) {\n                $counter = $daloradiusLineCount;\n                $fileReversed = array_reverse(file($logfile));\n\n                echo '<div style=\"font-family: monospace\">';\n                foreach ($fileReversed as $line) {\n                    if ($counter == 0) {\n                        break;\n                    }\n                    echo nl2br(htmlspecialchars($line, ENT_QUOTES, 'UTF-8'), false);\n                    $counter--;\n                \n                }\n                echo '</div>';\n            }\n        }\n    }\n}\n?>\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n * Description:\n *        This code allows for running the 'radtest' binary tool provided with freeradius\n *        for performing a dry-run check to see if a user is able to successfully login\n *        or that there may be problems connecting.\n *\n * Authors:    Liran Tal <liran@enginx.com>\n *             Giso Kegal <kegel@barum.de>\n *             Filippo Lauria <filippo.lauria@iit.cnr.it>\n *\n *********************************************************************************************************\n */\n\n\n// prevent this file to be directly accessed\n$extension_file = '/library/exten-maint-radclient.php';\nif (strpos($_SERVER['PHP_SELF'], $extension_file) !== false) {\n    header(\"Location: ../index.php\");\n    exit;\n}\n\n$extension_file_enc = htmlspecialchars($extension_file, ENT_QUOTES, 'UTF-8');\n\n// user_auth function\n// sends to the radius server an authentication request packet (for the sake of testing a user)\n// $radiusaddr  - the server address, this would most likely be the radius server IP Address/Hostname\n// $radiusport  - the server's port number, radius server's port number (1812 or the old port for auth)\n// $options     - the options passed to the radclient program\n// $command     - the command string that radclient sends (auth, acct, status, coa, disconnect), by default this functions does 'auth'\nfunction user_auth($options, $user, $pass, $radiusaddr, $radiusport, $secret, $command=\"auth\", $additional=\"\") {\n\n    $user = escapeshellarg($user);\n    $pass = escapeshellarg($pass);\n    $args = escapeshellarg(\"$radiusaddr:$radiusport\") . \" \" . escapeshellarg($command) . \" \" . escapeshellarg($secret);\n    $query = \"User-Name=$user,User-Password=$pass\";\n\n    $radclient = \"radclient\";       // or you can change this with the full path if the binary radcilent program can not be\n                                    // found within your $PATH variable\n\n    $radclient_options = \" -c \" . escapeshellarg($options['count'])\n                       . \" -n \" . escapeshellarg($options['requests'])\n                       . \" -r \" . escapeshellarg($options['retries'])\n                       . \" -t \" . escapeshellarg($options['timeout'])\n                       . \" \" . $options['debug'];\n\n    if ($options['dictionary']) {\n        $radclient_options .= \" -d \" . escapeshellarg($options['dictionary']);\n    }\n\n    $cmd = sprintf('echo \"%s\" | %s %s %s 2>&1', escapeshellcmd($query), $radclient, $radclient_options, $args);\n    $res = shell_exec($cmd);\n\n    $print_cmd = \"<strong>Executed:</strong><br>$cmd<br>\";\n    if ($res == \"\") {\n        echo \"<b>Error:</b> Command did not return any results.<br>\"\n           . \"Please check that you have the <em>radclient binary program</em> installed and that it is found in your \\$PATH variable<br>\"\n           . \"You may also consult the file <strong>$extension_file_enc</strong> for other problems<br>\";\n           return $print_cmd;\n    }\n\n    $output_html = '<br><strong>Results:</strong><br><div style=\"font-family: monospace\">' . nl2br($res) . '</div>';\n    return $print_cmd . $output_html;\n}\n\n\n// user_disconnect function\n// sends to the NAS a CoA (Change of Authorization) or a CoD (Disconnect) packet\n// $nasaddr    - NAS address to receive the coa or disconnect request packet\n// $nasport    - NAS Port address (depends on the configuration on the NAS, this may be a different port for either CoA or Disconnect packets).\nfunction user_disconnect($options, $user, $nasaddr, $nasport=\"3779\", $nassecret, $command=\"disconnect\", $additional=\"\") {\n\n    $user = escapeshellarg($user);\n\n    $args = escapeshellarg(\"$nasaddr:$nasport\") . \" \" . escapeshellarg($command). \" \" . escapeshellarg($nassecret);\n    $query = \"User-Name=$user\";\n\n    if (!empty($additional)) {\n        $query .= ',' . $additional;\n    }\n\n    $radclient = \"radclient\";    // or you can change this with the full path if the binary radcilent program can not be\n                                 // found within your $PATH variable\n\n    $radclient_options = \" -c \" . escapeshellarg($options['count'])\n                       . \" -n \" . escapeshellarg($options['requests'])\n                       . \" -r \" . escapeshellarg($options['retries'])\n                       . \" -t \" . escapeshellarg($options['timeout'])\n                       . \" \" . $options['debug'];\n\n    if ($options['dictionary']) {\n        $radclient_options .= \" -d \" . escapeshellarg($options['dictionary']);\n    }\n\n    $cmd = sprintf('echo \"%s\" | %s %s %s 2>&1', escapeshellcmd($query), $radclient, $radclient_options, $args);\n    $res = shell_exec($cmd);\n    \n    $print_cmd = \"<strong>Executed:</strong><br>$cmd<br>\";\n    if ($res == \"\") {\n        echo \"<b>Error:</b> Command did not return any results.<br>\"\n           . \"Please check that you have the <em>radclient binary program</em> installed and that it is found in your \\$PATH variable<br>\"\n           . \"You may also consult the file <strong>$extension_file_enc</strong> for other problems<br>\";\n           return $print_cmd;\n    }\n    \n    $output_html = '<br><strong>Results:</strong><br><div style=\"font-family: monospace\">' . nl2br($res) . '</div>';\n    return $print_cmd . $output_html;\n}\n\n?>\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n * Description:\n *        this script displays the radius log file.\n *              Of course proper premissions must be applied\n *              on the log file for the web server to be able to read it\n *\n * Authors:     Liran Tal <liran@enginx.com>\n *              Filippo Lauria <filippo.lauria@iit.cnr.it>\n *\n *********************************************************************************************************\n */\n\n// prevent this file to be directly accessed\n$extension_file = '/library/exten-radius_log.php';\nif (strpos($_SERVER['PHP_SELF'], $extension_file) !== false) {\n    header(\"Location: ../index.php\");\n    exit;\n}\n\n// possible locations for radius logs\n$logfile_loc = array(\n    '/var/log/freeradius/radius.log',\n    '/usr/local/var/log/radius/radius.log',\n    '/var/log/radius/radius.log'\n);\n\n// select one log file\n$logfile = \"\";\n\nforeach ($logfile_loc as $tmp) {\n    if (file_exists($tmp)) { \n    $logfile = $tmp;\n        break;\n    }\n}\n\n$logfile_enc = (!empty($logfile)) ? htmlspecialchars($logfile, ENT_QUOTES, 'UTF-8') : '(none)';\n\n// check if it is empty\nif (empty($logfile)) {\n    printf(\"<br><br>Error accessing log file: <strong>%s</strong>.<br><br>\"\n         . \"Looked for log file in <strong>%s</strong> but could not find it.<br>\"\n         . \"If you know where your <em>freeradius log file</em> is located, \"\n         . \"specify its location in <strong>%s</strong>\",\n           $logfile_enc, htmlspecialchars(implode(\", \", $logfile_loc), ENT_QUOTES, 'UTF-8'), $logfile_enc);\n    exit;\n}\n\n// check if it is readable\nif (is_readable($logfile) !== true) {\n    $failureMsg = sprintf(\"<br><br>Error reading log file: <strong>%s</strong>.<br><br>Is this file readable?<br>\",\n                          $logfile_enc);\n    exit;\n}\n\n// get its content\n$logcontent = file_get_contents($logfile);\nif (!empty($logcontent)) {\n    $counter = $radiusLineCount;\n    $filter = (!empty($radiusFilter)) ? preg_quote($radiusFilter, \"/\") : \".+\";\n    $fileReversed = array_reverse(file($logfile));\n\n    echo '<div style=\"font-family: monospace\">';\n    foreach ($fileReversed as $line) {\n    if (preg_match(\"/$filter/i\", $line)) {\n        if ($counter == 0) {\n            break;\n        }\n        echo nl2br(htmlspecialchars($line, ENT_QUOTES, 'UTF-8'), false);\n        $counter--;\n        }\n    }\n    echo '</div>';\n}\n\n?>\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n * Description:\n *        this script uses pgrep to check if services stored\n *              in $services_to_check are running\n *\n * Authors:    Liran Tal <liran@enginx.com>\n *              Filippo Lauria <filippo.lauria@iit.cnr.it>\n *\n *********************************************************************************************************\n */\n\n// prevent this file to be directly accessed\nif (strpos($_SERVER['PHP_SELF'], '/library/exten-radius_server_info.php') !== false) {\n    header(\"Location: ../index.php\");\n    exit;\n}\n\n// given the $service_name, this function returns \"Running\" if that service is running\nfunction check_service($service_name) {\n    if (empty($service_name)) {\n        return \"no service name\";\n    }\n\n    $command = sprintf(\"pgrep %s\", escapeshellarg($service_name));\n    exec($command, $output, $result_code);\n    return ($result_code === 0) ? \"Running\" : \"Not running\";\n}\n\n$services_to_check = array(\"FreeRADIUS\", \"MySQL\", \"MariaDB\");\n\n?>\n\n<h3>Service Status</h3>\n<table class=\"summarySection\">\n<?php\n    $format = '<tr><td class=\"summaryKey\">%s</td><td class=\"summaryValue\"><span class=\"sleft\">%s'\n            . \"</span></td></tr>\\n\";\n    foreach ($services_to_check as $service_name) {\n        printf($format, $service_name, check_service(strtolower($service_name)));\n    }\n?>\n</table>\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n * Description:\n *         this script process some important server information and displays it\n *\n * Authors:    Liran Tal <liran@enginx.com>\n *             Carlos Cesario <carloscesario@gmail.com>\n *             Filippo Lauria <filippo.lauria@iit.cnr.it>\n *\n *********************************************************************************************************\n */\n\n// prevent this file to be directly accessed\n$extension_file = '/library/exten-server_info.php';\nif (strpos($_SERVER['PHP_SELF'], $extension_file) !== false) {\n    header(\"Location: ../index.php\");\n    exit;\n}\n\ninclude_once('include/management/pages_common.php');\n\n// returns system name and version\nfunction get_system_name_and_version() {\n    $command = \"cat /etc/*release | grep ^NAME\\= | cut -d'=' -f2- | tr -d '\\\"'\";\n    exec($command, $output, $result_code);\n    if ($result_code !== 0) {\n        return \"(n/d)\";\n    }\n    \n    $result = $output[0];\n    $output = null;\n    $result_code = null;\n    \n    $command = \"cat /etc/*release | grep ^VERSION\\= | cut -d'=' -f2- | tr -d '\\\"'\";\n    exec($command, $output, $result_code);\n    if ($result_code === 0) {\n        $result .= sprintf(\", version %s\", $output[0]);\n    }\n    \n    return $result;\n}\n\n\n// Display uptime system\n// @return string Return uptime system\nfunction uptime() {\n    $file_name = \"/proc/uptime\";\n\n    $fopen_file = fopen($file_name, 'r');\n    $buffer = explode(' ', fgets($fopen_file, 4096));\n    fclose($fopen_file);\n\n    $sys_ticks = trim($buffer[0]);\n    $min = $sys_ticks / 60;\n    $hours = $min / 60;\n    $days = floor($hours / 24);\n    $hours = floor($hours - ($days * 24));\n    $min = floor($min - ($days * 60 * 24) - ($hours * 60));\n    $result = \"\";\n\n    if ($days != 0) {\n        $result .= $days;\n        $result .= ($days > 1) ? \" days \" : \" day \";\n    }\n\n    if ($hours != 0) {\n        $result .= $hours;\n        $result .= ($hours > 1) ? \" hours \" : \" hour \";\n    }\n\n    if ($min > 1 || $min == 0)\n        $result .= \"$min \" . \" minutes \";\n    elseif ($min == 1)\n        $result .= \"$min \" . \" minute \";\n\n    return $result;\n}\n\n\n// Display hostname system\n// @return string System hostname or none\nfunction get_hostname() {\n    $file_name = \"/proc/sys/kernel/hostname\";\n\n    if ($fopen_file = fopen($file_name, 'r')) {\n        $result = trim(fgets($fopen_file, 4096));\n        fclose($fopen_file);\n    } else {\n        $result = \"(n/d)\";\n    }\n\n    return $result;\n}\n\n\n// Display currenty date/time\n// @return string Current system date/time or none\nfunction get_datetime() {\n    $today = date(\"F j, Y, g:i a\");\n    return ($today) ? $today : \"(n/d)\";\n}\n\n\n\n// Get System Load Average\n// @return array System Load Average\nfunction get_system_load() {\n    $file_name = \"/proc/loadavg\";\n    $result = \"\";\n    $output = \"\";\n\n    // get the /proc/loadavg information\n    if ($fopen_file = fopen($file_name, 'r')) {\n        $result = trim(fgets($fopen_file, 256));\n        fclose($fopen_file);\n    } else {\n        $result = \"(n/d)\";\n    }\n\n    $loadavg = explode(\" \", $result);\n    $output .= $loadavg[0] . \" \" . $loadavg[1] . \" \" . $loadavg[2] . \"<br/>\";\n\n\n    // get information the 'top' program\n    $file_name = \"top -b -n1 | grep \\\"Tasks:\\\" -A1\";\n    $result = \"\";\n\n    if ($popen_file = popen($file_name, 'r')) {\n        $result = trim(fread($popen_file, 2048));\n        pclose($popen_file);\n    } else {\n        $result = \"(n/d)\";\n    }\n\n    $result = str_replace(\"\\n\", \"<br/>\", $result);\n    $output .= $result;\n\n    return $output;\n}\n\n\n// Get Memory System MemTotal|MemFree\n// @return array Memory System MemTotal|MemFree\nfunction get_memory() {\n    $file_name = \"/proc/meminfo\";\n    $mem_array = array();\n\n    $buffer = file($file_name);\n\n    while (list($key, $value) = each($buffer)) {\n        if (strpos($value, ':') !== false) {\n            $match_line = explode(':', $value);\n            $match_value = explode(' ', trim($match_line[1]));\n            if (is_numeric($match_value[0])) {\n                $mem_array[trim($match_line[0])] = trim($match_value[0]);\n            }\n        }\n    }\n\n    return $mem_array;\n}\n\n\n//Get FreeDiskSpace\nfunction get_hdd_freespace() {\n$df = disk_free_space(\"/\");\nreturn $df;\n}\n\n\n// Convert value to MB\n// @param decimal $value\n// @return int Memory MB\nfunction convert_ToMB($value) {\n    return round($value / 1024) . \" MB\\n\";\n}\n\n\n\n// Get all network names devices (eth[0-9])\n// @return array Get list network name interfaces\nfunction get_interface_list() {\n    $devices = array();\n    $file_name = \"/proc/net/dev\";\n\n    if ($fopen_file = fopen($file_name, 'r')) {\n        while ($buffer = fgets($fopen_file, 4096)) {\n            if (preg_match(\"/eth[0-9][0-9]*/i\", trim($buffer), $match)) {\n                $devices[] = $match[0];\n            }\n        }\n        $devices = array_unique($devices);\n        sort($devices);\n        fclose ($fopen_file);\n    }\n    return $devices;\n}\n\n\n\n// Get ip address\n// @param string $ifname\n// @return string Ip address or (none)\nfunction get_ip_addr($ifname) {\n    $command_formats = array(\n        '(ip addr show %s || /sbin/ip addr show %s) | grep inet | grep -v inet6 | sed -E \"s/^\\s+//g\" | cut -d\" \" -f2 | cut -d\"/\" -f1',\n        '(ifconfig %s || /sbin/ifconfig %s) | grep -oE \"inet ([0-9]{1,3}\\.?){4}\" | cut -d\" \" -f2'\n    );\n\n    foreach ($command_formats as $format) {\n        $command = sprintf($format, escapeshellarg($ifname), escapeshellarg($ifname));\n        exec($command, $output, $result_code);\n        if ($result_code === 0) {\n            return $output[0];\n        }\n    }\n\n    return \"(n/d)\";\n}\n\n// Get mac address\n// @param string $ifname\n// @return string Mac address or (none)\nfunction get_mac_addr($ifname) {\n    $command_formats = array(\n        '(ip addr show %s || /sbin/ip addr show %s) | grep \"link/ether\" | sed -E \"s/^\\s+//g\" | cut -d\" \" -f2',\n        '(ifconfig %s || /sbin/ifconfig %s) | grep \"ether\" | sed -E \"s/^\\s+//g\" | cut -d\" \" -f2'\n    );\n\n    foreach ($command_formats as $format) {\n        $command = sprintf($format, escapeshellarg($ifname), escapeshellarg($ifname));\n        exec($command, $output, $result_code);\n\n        if ($result_code === 0 && preg_match(\"/^([0-9A-F]{2}\\:){5}[0-9A-F]{2}$/i\", $output[0])) {\n            return $output[0];\n        }\n    }\n\n    return \"(n/d)\";\n}\n\n\n// Get netmask address\n// @param string $ifname\n// @return string Netmask address or (none)\nfunction get_mask_addr($ifname) {\n    $command_formats = array(\n        'echo -n \"/\"; (ip addr show %s || /sbin/ip addr show %s) | grep inet | grep -v inet6 | sed -E \"s/^\\s+//g\" | cut -d\" \" -f2 | cut -d\"/\" -f2',\n        '(ifconfig %s || /sbin/ifconfig %s) | grep -oE \"netmask ([0-9]{1,3}\\.?){4}\" | cut -d\" \" -f2'\n    );\n    \n    foreach ($command_formats as $format) {\n        $command = sprintf($format, escapeshellarg($ifname), escapeshellarg($ifname));\n        exec($command, $output, $result_code);\n        if ($result_code === 0) {\n            return $output[0];\n        }\n    }\n    \n    return \"(n/d)\";\n}\n\n// memory info\n$meminfo = get_memory();\n$memused = ($meminfo['MemTotal'] - $meminfo['MemFree']);\n\n// hdd info\n$hddfreespace = get_hdd_freespace();\n\n// network interfaces info\n$iflist = get_interface_list();\n\n?>\n\n<h3>General Information</h3>\n<table class=\"summarySection\">\n  <tr>\n    <td class=\"summaryKey\">System distro</td>\n    <td class=\"summaryValue\"><span class=\"sleft\"><?= get_system_name_and_version() ?></span></td>\n  </tr>\n    \n  <tr>\n    <td class=\"summaryKey\">Uptime</td>\n    <td class=\"summaryValue\"><span class=\"sleft\"><?= uptime() ?></span></td>\n  </tr>\n  <tr>\n    <td class=\"summaryKey\">System Load</td>\n    <td class=\"summaryValue\"><span class=\"sleft\"><?= get_system_load() ?></span></td>\n  </tr>\n  <tr>\n    <td class=\"summaryKey\">Hostname</td>\n    <td class=\"summaryValue\"><span class=\"sleft\"><?= get_hostname() ?></span></td>\n  </tr>\n  <tr>\n    <td class=\"summaryKey\">Current Date</td>\n    <td class=\"summaryValue\"><span class=\"sleft\"><?= get_datetime() ?></span></td>\n  </tr>\n</table>\n\n\n<h3>Memory Information</h3>\n<table class=\"summarySection\">\n  <tr>\n    <td class=\"summaryKey\">Mem. Total</td>\n    <td class=\"summaryValue\"><span class=\"sleft\"><?= convert_ToMB($meminfo['MemTotal']) ?></span></td>\n  </tr>\n  <tr>\n    <td class=\"summaryKey\">Mem. Free</td>\n    <td class=\"summaryValue\"><span class=\"sleft\"><?= convert_ToMB($meminfo['MemFree']) ?></span></td>\n  </tr>\n  <tr>\n    <td class=\"summaryKey\">Mem. Used</td>\n    <td class=\"summaryValue\"><span class=\"sleft\"><?= convert_ToMB($memused) ?></span></td>\n  </tr>\n</table>\n\n\n<h3>Harddrive Information</h3>\n<table class=\"summarySection\">\n  <tr>\n    <td class=\"summaryKey\">Free Drive Space</td>\n    <td class=\"summaryValue\"><span class=\"sleft\"><?= toxbyte($hddfreespace) ?></span></td>\n  </tr>\n</table>\n\n<h3>Network Interfaces</h3>\n\n<?php\n    foreach ($iflist as $ifname) {\n?>\n<table class=\"summarySection\">    \n  <tr>\n    <td class=\"summaryKey\">Interface</td>\n    <td class=\"stitle\"><?= $ifname ?></td>\n  </tr>\n  <tr>\n    <td class=\"summaryKey\">Ip</td>\n    <td class=\"summaryValue\"><span class=\"sleft\"><?= get_ip_addr($ifname) ?></span></td>\n  </tr>\n  <tr>\n    <td class=\"summaryKey\">Mask</td>\n    <td class=\"summaryValue\"><span class=\"sleft\"><?= get_mask_addr($ifname) ?></span></td>\n  </tr>\n  <tr>\n    <td class=\"summaryKey\">MAC address</td>\n    <td class=\"summaryValue\"><span class=\"sleft\"><?= get_mac_addr($ifname) ?></span></td>\n  </tr>\n</table>\n\n<?php\n    }\n?>\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n * Description:\n *             this script displays the radius log file ofcourse\n *             proper premissions must be applied on the log file for the web\n *             server to be able to read it\n *\n * Authors:    Liran Tal <liran@enginx.com>\n *             Filippo Lauria <filippo.lauria@iit.cnr.it>\n *\n *********************************************************************************************************\n */\n\n// prevent this file to be directly accessed\n$extension_file = '/library/exten-syslog_log.php';\nif (strpos($_SERVER['PHP_SELF'], $extension_file) !== false) {\n    header(\"Location: ../index.php\");\n    exit;\n}\n\n// possible locations for syslog files\n$logfile_loc = array(\n    '/var/log/syslog',\n    '/var/log/messages'\n);\n\n// select one log file\n$logfile = \"\";\n\nforeach ($logfile_loc as $tmp) {\n    if (file_exists($tmp)) { \n    $logfile = $tmp; \n        break;\n    }\n}\n\n$logfile_enc = (!empty($logfile)) ? htmlspecialchars($logfile, ENT_QUOTES, 'UTF-8') : '(none)';\n\n// check if it is empty\nif (empty($logfile)) {\n    $failureMsg = sprintf(\"<br><br>Error accessing log file: <strong>%s</strong>.<br><br>\" . \n                          \"Looked for log file in <strong>%s</strong> but could not find it.<br>\" .\n                          \"If you know where your <em>system log file</em> is located, specify its location in <strong>%s</strong>\",\n                          $logfile_enc, htmlspecialchars(implode(\", \", $logfile_loc), ENT_QUOTES, 'UTF-8'),\n                          htmlspecialchars($extension_file, ENT_QUOTES, 'UTF-8'));\n} else {\n\n    // check if it is readable\n    if (is_readable($logfile) !== true) {\n        $failureMsg = sprintf(\"<br><br>Error reading log file: <strong>%s</strong>.<br><br>Is this file readable?<br>\",\n                              $logfile_enc);\n    } else {\n\n        // get its content\n        $logcontent = file_get_contents($logfile);\n        if (!empty($logcontent)) {\n            $counter = $systemLineCount;\n            $filter = (!empty($systemFilter)) ? preg_quote($systemFilter, \"/\") : \".+\";\n            $fileReversed = array_reverse(file($logfile));\n\n            echo '<div style=\"font-family: monospace\">';\n            foreach ($fileReversed as $line) {\n                if (preg_match(\"/$filter/i\", $line)) {\n                    if ($counter == 0) {\n                        break;\n                    }\n                    echo nl2br(htmlspecialchars($line, ENT_QUOTES, 'UTF-8'), false);\n                    $counter--;\n                }\n            }\n            echo '</div>';\n        }\n    }\n}\n?>\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n * Description: displays a welcome page for the main index.php file\n *\n * Authors:     Liran Tal <liran@enginx.com>\n *              Miguel Garc\u00eda <miguelvisgarcia@gmail.com>\n *              Filippo Lauria <filippo.lauria@iit.cnr.it>\n *\n *********************************************************************************************************\n */\n\n// prevent this file to be directly accessed\nif (strpos($_SERVER['PHP_SELF'], '/library/exten-welcome_page.php') !== false) {\n    header(\"Location: ../index.php\");\n    exit;\n}\n?>\n\n<div style=\"text-align: center\">\n    <h2>daloRADIUS Web Management Server</h2>\n    <h3><?= t('all', 'daloRADIUSVersion') ?> / <?= htmlspecialchars($configValues['DALORADIUS_DATE'], ENT_QUOTES, 'UTF-8') ?></h3>\n    <h4><a href=\"mailto:liran.tal@gmail.com\">Liran Tal</a></h4>\n    <img src=\"images/daloradius_logo.jpg\" style=\"border: 0; margin-top: 50px\">\n</div>\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n *\n * Authors:    Liran Tal <liran@enginx.com>\n *             Filippo Lauria <filippo.lauria@iit.cnr.it>\n *\n *********************************************************************************************************\n */\n\n    include(\"library/checklogin.php\");\n    $operator = $_SESSION['operator_user'];\n\n    include('library/check_operator_perm.php');\n\n    // parameter validation\n    $bootLineCount = (array_key_exists('bootLineCount', $_GET) && isset($_GET['bootLineCount']) &&\n                      intval($_GET['bootLineCount']) > 0)\n                   ? intval($_GET['bootLineCount']) : 50;\n\n    // preg quoted before usage\n    $bootFilter = (array_key_exists('bootFilter', $_GET) && isset($_GET['bootFilter']))\n                ? $_GET['bootFilter'] : \"\";\n\n    include_once('library/config_read.php');\n    $log = \"visited page: \";\n    include('include/config/logging.php');\n\n    include(\"menu-reports-logs.php\");\n      \n?>    \n    <div id=\"contentnorightbar\">\n        <h2 id=\"Intro\">\n            <a href=\"#\" onclick=\"javascript:toggleShowDiv('helpPage')\">\n                <?= t('Intro','replogsboot.php') ?> :: <?= $bootLineCount . \" Lines Count \" ?>\n<?php \n    if (!empty($bootFilter) && $bootFilter !== '.+') {\n        echo \" with filter set to \" . htmlspecialchars($bootFilter, ENT_QUOTES, 'UTF-8');\n    }\n?>\n                <h144>&#x2754;</h144>\n            </a>\n        </h2>\n\n        <div id=\"helpPage\" style=\"display:none;visibility:visible\"><?= t('helpPage', 'replogsboot') ?><br></div>\n        <br>\n\n<?php\n    include('library/exten-boot_log.php');\n    include_once('include/management/actionMessages.php');\n?>\n        </div>\n\n        <div id=\"footer\">\n<?php\n    include('page-footer.php');\n?>\n        </div>\n        \n    </div>\n</div>\n\n\n</body>\n</html>\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n *\n * Authors:    Liran Tal <liran@enginx.com>\n *             Filippo Lauria <filippo.lauria@iit.cnr.it>\n *\n *********************************************************************************************************\n */\n\n    include(\"library/checklogin.php\");\n    $operator = $_SESSION['operator_user'];\n\n    include('library/check_operator_perm.php');\n\n    // parameter validation\n    $daloradiusLineCount = (array_key_exists('daloradiusLineCount', $_GET) && isset($_GET['daloradiusLineCount']) &&\n                            intval($_GET['daloradiusLineCount']) > 0)\n                         ? intval($_GET['daloradiusLineCount']) : 50;\n\n    include_once('library/config_read.php');\n    $log = \"visited page: \";\n    include('include/config/logging.php');\n\n    include(\"menu-reports-logs.php\");\n\n?>    \n\n    <div id=\"contentnorightbar\">\n        <h2 id=\"Intro\">\n            <a href=\"#\" onclick=\"javascript:toggleShowDiv('helpPage')\">\n                <?= t('Intro','replogsdaloradius.php') ?> :: <?= $daloradiusLineCount . \" Lines Count \" ?>\n                <h144>&#x2754;</h144>\n            </a>\n        </h2>\n\n        <div id=\"helpPage\" style=\"display:none;visibility:visible\"><?= t('helpPage','replogsdaloradius') ?><br></div>\n\n<?php\n    include('library/exten-daloradius_log.php');\n    include_once('include/management/actionMessages.php');\n?>\n        </div>\n\n        <div id=\"footer\">\n<?php\n    include('page-footer.php');\n?>\n        </div>\n        \n    </div>\n</div>\n\n\n</body>\n</html>\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n *\n * Authors:    Liran Tal <liran@enginx.com>\n *             Filippo Lauria <filippo.lauria@iit.cnr.it>\n *\n *********************************************************************************************************\n */\n\n    include(\"library/checklogin.php\");\n    $operator = $_SESSION['operator_user'];\n\n    include('library/check_operator_perm.php');\n\n    // parameter validation\n    $radiusLineCount = (array_key_exists('radiusLineCount', $_GET) && isset($_GET['radiusLineCount']) &&\n                        intval($_GET['radiusLineCount']) > 0)\n                     ? intval($_GET['radiusLineCount']) : 50;\n\n    // preg quoted before usage\n    $radiusFilter = (array_key_exists('radiusFilter', $_GET) && isset($_GET['radiusFilter']) &&\n                     in_array($_GET['radiusFilter'], array( \"Auth\", \"Info\", \"Error\" )))\n                  ? $_GET['radiusFilter'] : \"\";\n\n\n    include_once('library/config_read.php');\n    $log = \"visited page: \";\n    include('include/config/logging.php');\n\n    include (\"menu-reports-logs.php\");\n\n?>\n    <div id=\"contentnorightbar\">\n        <h2 id=\"Intro\">\n            <a href=\"#\" onclick=\"javascript:toggleShowDiv('helpPage')\">\n                <?= t('Intro', 'replogsradius.php') ?> :: <?= $radiusLineCount . \" Lines Count \" ?>\n<?php \n    if (!empty($radiusFilter) && $radiusFilter !== '.+') {\n        echo \" with filter set to \" . htmlspecialchars($radiusFilter, ENT_QUOTES, 'UTF-8');\n    }\n?>\n                <h144>&#x2754;</h144>\n            </a>\n        </h2>\n\n        <div id=\"helpPage\" style=\"display:none;visibility:visible\"><?= t('helpPage', 'replogsradius') ?><br></div>\n        <br>\n\n<?php\n    include('library/exten-radius_log.php');\n    include_once('include/management/actionMessages.php');\n?>\n        </div>\n        \n        <div id=\"footer\">\n<?php\n    include('page-footer.php');\n?>\n        </div>\n        \n    </div>\n</div>\n\n</body>\n</html>\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n *\n * Authors:    Liran Tal <liran@enginx.com>\n *             Filippo Lauria <filippo.lauria@iit.cnr.it>\n *\n *********************************************************************************************************\n */\n\n    include(\"library/checklogin.php\");\n    $operator = $_SESSION['operator_user'];\n\n    include('library/check_operator_perm.php');\n\n    // parameter validation\n    $systemLineCount = (array_key_exists('systemLineCount', $_GET) && isset($_GET['systemLineCount']) &&\n                        intval($_GET['systemLineCount']) > 0)\n                     ? intval($_GET['systemLineCount']) : 50;\n\n    // preg quoted before usage\n    $systemFilter = (array_key_exists('systemFilter', $_GET) && isset($_GET['systemFilter']))\n                  ? $_GET['systemFilter'] : \"\";\n\n    include_once('library/config_read.php');\n    $log = \"visited page: \";\n    include('include/config/logging.php');\n\n    include (\"menu-reports-logs.php\");      \n?>    \n        <div id=\"contentnorightbar\">\n            <h2 id=\"Intro\">\n                <a href=\"#\" onclick=\"javascript:toggleShowDiv('helpPage')\">\n                    <?= t('Intro', 'replogssystem.php'); ?> :: <?= $systemLineCount . \" Lines Count\" ?>\n<?php \n    if (!empty($systemFilter)) {\n        echo \" with filter set to \" . htmlspecialchars($systemFilter, ENT_QUOTES, 'UTF-8');\n    }\n?>\n                    <h144>&#x2754;</h144>\n                </a>\n            </h2>\n            \n            <div id=\"helpPage\" style=\"display:none;visibility:visible\"><?= t('helpPage', 'replogssystem') ?><br></div>\n            <br>\n\n<?php\n    include('library/exten-syslog_log.php');\n    include_once('include/management/actionMessages.php');\n?>\n        </div>\n        \n        <div id=\"footer\">\n<?php\n    include('page-footer.php');\n?>\n        </div>\n\n    </div>\n</div>\n\n</body>\n</html>\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n *\n * Authors:    Liran Tal <liran@enginx.com>\n *             Filippo Lauria <filippo.lauria@iit.cnr.it>\n *\n *********************************************************************************************************\n */\n\n    include(\"library/checklogin.php\");\n    $operator = $_SESSION['operator_user'];\n        \n    include_once('library/config_read.php');\n    $log = \"visited page: \";\n\n    include(\"menu-reports-logs.php\");\n\n?>\n        <div id=\"contentnorightbar\">\n            <h2 id=\"Intro\">\n                <a href=\"#\" onclick=\"javascript:toggleShowDiv('helpPage')\">\n                    <?= t('Intro','replogs.php'); ?>\n                    <h144>&#x2754;</h144>\n                </a>\n            </h2>\n\n            <div id=\"helpPage\" style=\"display:none;visibility:visible\"><?= t('helpPage','replogs') ?><br></div>\n            <br>\n\n<?php\n    include('include/config/logging.php');\n?>\n\n        </div>\n        \n        <div id=\"footer\">\n        \n<?php\n        include('page-footer.php');\n?>\n\n        \n        </div>\n    </div>\n</div>\n\n\n</body>\n</html>\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n *\n * Authors:     Liran Tal <liran@enginx.com>\n *              Filippo Lauria <filippo.lauria@iit.cnr.it>\n *\n *********************************************************************************************************\n */\n\n    include(\"library/checklogin.php\");\n    $operator = $_SESSION['operator_user'];\n\n    include('library/check_operator_perm.php');\n\n    include_once('library/config_read.php');\n    $log = \"visited page: \";\n    $logQuery = \"performed query on page: \";\n    include('include/config/logging.php');\n    \n    $cronUser = get_current_user();\n    \n    // validating params\n    $cmd = (array_key_exists('cmd', $_GET) && isset($_GET['cmd']) &&\n            in_array(strtolower($_GET['cmd']), array( \"enable\", \"disable\" )))\n         ? strtolower($_GET['cmd']) : \"\";\n\n    $dalo_crontab_file = dirname(__FILE__) . '/contrib/scripts/dalo-crontab';\n    \n    $exec = \"\";\n    \n    switch ($cmd) {\n        case \"disable\":\n        $exec = sprintf(\"$(which crontab || command -v crontab) -u %s -r\", escapeshellarg($cronUser));\n        break;\n        \n        case \"enable\":\n        $exec = sprintf(\"$(which crontab || command -v crontab) -u %s %s\", escapeshellarg($cronUser), $dalo_crontab_file);\n        break;\n    }\n    \n    if (!empty($exec)) {\n        exec($exec);\n    }\n    \n    include (\"menu-reports-status.php\");\n    \n?>        \n    <div id=\"contentnorightbar\">\n    \n        <h2 id=\"Intro\">\n            <a href=\"#\" onclick=\"javascript:toggleShowDiv('helpPage')\">CRON Status\n                <h144>&#x2754;</h144>\n            </a>\n            </h2>\n\n            <div id=\"helpPage\" style=\"display:none;visibility:visible\"><br></div>\n            <br>\n\n            <h3>CRON Entries</h3>\n            <a href=\"?cmd=enable\">Enable CRON</a>\n            &nbsp;\n            <a href=\"?cmd=disable\">Disable CRON</a>\n\n            <br>\n            <br>\n\n<?php\n    $failureMsg = \"\";\n\n    $exec = sprintf(\"$(which crontab || command -v crontab) -u %s -l\", escapeshellarg($cronUser));\n    exec($exec, $output, $retStatus);\n\n    if ($retStatus !== 0) {\n        $failureMsg = '<strong>Error</strong> no crontab is configured for this user or user does not exist<br><br>';\n    } else {\n        $i = 1;\n        foreach($output as $text) {\n            printf('<strong>#%d</strong>: %s<br>', $i, htmlspecialchars($text, ENT_QUOTES, 'UTF-8'));\n            $i++;\n        }\n    }\n    \n    if (!empty($failureMsg)) {\n        include_once('include/management/actionMessages.php');\n    }\n?>\n\n        </div>\n        \n        <div id=\"footer\">\n<?php\n    include('page-footer.php');\n?>\n        </div>\n        \n    </div>\n</div>\n\n</body>\n</html>\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n *\n * Authors:     Liran Tal <liran@enginx.com>\n *              Filippo Lauria <filippo.lauria@iit.cnr.it>\n *\n *********************************************************************************************************\n */\n\n    include (\"library/checklogin.php\");\n    $operator = $_SESSION['operator_user'];\n\n    include('library/check_operator_perm.php');\n\n    include_once('library/config_read.php');\n    $log = \"visited page: \";\n    $logQuery = \"performed query on page: \";\n    include('include/config/logging.php');\n\n    include (\"menu-reports-status.php\");\n      \n?>    \n        <div id=\"contentnorightbar\">\n            <h2 id=\"Intro\">\n                <a href=\"#\" onclick=\"javascript:toggleShowDiv('helpPage')\">\n                    RAID Status <h144>&#x2754;</h144>\n                </a>\n            </h2>\n\n            <div id=\"helpPage\" style=\"display:none;visibility:visible\"><br></div>\n            <br>\n\n<?php\n    $failureMsg = \"\";\n    $error = '<strong>Error</strong> accessing RAID device information<br><br>';\n    \n    if (!file_exists('/proc/mdstat')) {\n        $failureMsg = $error;\n    } else {\n        exec(\"cat /proc/mdstat | awk '/md/ {print $1}'\", $mdstat, $retStatus);\n        \n        if ($retStatus !== 0) {\n            $failureMsg = $error;\n        } else {\n            if (count($mdstat) > 0) {\n                include_once(\"library/tabber/tab-layout.php\");\n                echo '<div class=\"tabber\">';\n                foreach($mdstat as $mddevice) {\n                    printf('<div class=\"tabbertab\" title=\"%s\">', htmlspecialchars($mddevice, ENT_QUOTES, 'UTF-8'));\n                    \n                    $dev = \"/dev/$mddevice\";\n                    $cmd = sprintf(\"sudo /sbin/mdadm --detail %s\", escapeshellarg($dev));\n                    $output = \"\";\n                    exec($cmd, $output);\n\n                    echo '<table class=\"summarySection\">';\n                    foreach($output as $line) {\n                        list($var, $val) = split(\":\", $line);\n                        $var = htmlspecialchars($var, ENT_QUOTES, 'UTF-8');\n                        $val = htmlspecialchars($val, ENT_QUOTES, 'UTF-8');\n                        \n                        printf('<tr><td class=\"summaryKey\">%s</td>' .\n                               '<td class=\"summaryValue\"><span class=\"sleft\">%s</span></td></tr>', $var, $val); \n                    }\n                    echo '</table>'\n                       . '</div>';\n\n                }\n                echo '</div>';\n\n            } else {\n                $failureMsg = $error;\n            }\n        }\n    }\n    \n    if (!empty($failureMsg)) {\n        include_once('include/management/actionMessages.php');\n    }\n\n?>\n            \n        </div>\n        \n        <div id=\"footer\">\n<?php\n    include('page-footer.php');\n?>\n        </div>\n        \n    </div>\n</div>\n\n</body>\n</html>\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n *\n * Authors:    Liran Tal <liran@enginx.com>\n *             Filippo Lauria <filippo.lauria@iit.cnr.it>\n *\n *********************************************************************************************************\n */\n\n    include(\"library/checklogin.php\");\n    $operator = $_SESSION['operator_user'];\n\n    include('library/check_operator_perm.php');\n\n    include_once('library/config_read.php');\n    $log = \"visited page: \";\n    include('include/config/logging.php');\n\n    include(\"menu-reports-status.php\");\n    \n?>    \n        <div id=\"contentnorightbar\">\n            <h2 id=\"Intro\">\n                <a href=\"#\" onclick=\"javascript:toggleShowDiv('helpPage')\">\n                    <?= t('Intro','repstatserver.php'); ?>\n                    <h144>&#x2754;</h144>\n                </a>\n            </h2>\n\n            <div id=\"helpPage\" style=\"display:none;visibility:visible\"><?= t('helpPage','repstatserver') ?><br></div>\n            <br>\n                \n<?php\n    include('library/exten-server_info.php');\n?>\n\n        </div>\n        \n        <div id=\"footer\">\n        \n<?php\n    include('page-footer.php');\n?>\n        \n        </div>\n    </div>\n</div>\n\n\n</body>\n</html>\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n *\n * Authors:    Liran Tal <liran@enginx.com>\n *             Filippo Lauria <filippo.lauria@iit.cnr.it>\n *\n *********************************************************************************************************\n */\n\n    include(\"library/checklogin.php\");\n    $operator = $_SESSION['operator_user'];\n\n    include('library/check_operator_perm.php');\n\n    include_once('library/config_read.php');\n    $log = \"visited page: \";\n    include('include/config/logging.php');\n\n    include(\"menu-reports-status.php\");\n      \n?>    \n        <div id=\"contentnorightbar\">            \n            <h2 id=\"Intro\">\n                <a href=\"#\" onclick=\"javascript:toggleShowDiv('helpPage')\">\n                    <?= t('Intro','repstatradius.php'); ?>\n                    <h144>&#x2754;</h144>\n                </a>\n            </h2>\n\n            <div id=\"helpPage\" style=\"display:none;visibility:visible\" ><?= t('helpPage','repstatradius') ?><br></div>\n            <br>\n\n<?php\n    include('library/exten-radius_server_info.php');\n?>\n\n        </div>\n        \n        <div id=\"footer\">        \n<?php\n        include('page-footer.php');\n?>\n        \n        </div>\n    </div>\n</div>\n\n\n</body>\n</html>\n", "<?php\n/*\n *********************************************************************************************************\n * daloRADIUS - RADIUS Web Platform\n * Copyright (C) 2007 - Liran Tal <liran@enginx.com> All Rights Reserved.\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU General Public License\n * as published by the Free Software Foundation; either version 2\n * of the License, or (at your option) any later version.\n *\n * You should have received a copy of the GNU General Public License\n * along with this program; if not, write to the Free Software\n * Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.\n *\n *********************************************************************************************************\n *\n * Authors:     Liran Tal <liran@enginx.com>\n *              Filippo Lauria <filippo.lauria@iit.cnr.it>\n *\n *********************************************************************************************************\n */\n\n    include(\"library/checklogin.php\");\n    $operator = $_SESSION['operator_user'];\n\n    include('library/check_operator_perm.php');\n\n    include_once('library/config_read.php');\n    $log = \"visited page: \";\n    $logQuery = \"performed query on page: \";\n    include('include/config/logging.php');\n\n    include(\"menu-reports-status.php\");\n      \n?>\n        <div id=\"contentnorightbar\">\n            <h2 id=\"Intro\">\n                <a href=\"#\" onclick=\"javascript:toggleShowDiv('helpPage')\">\n                    UPS Status <h144>&#x2754;</h144>\n                </a>\n            </h2>\n\n            <div id=\"helpPage\" style=\"display:none;visibility:visible\"><br></div>\n            <br>\n\n<?php\n    exec(\"which apcaccess || command -v apcaccess\", $output, $retStatus);\n\n    $failureMsg = \"\";\n\n    $sep = \":\";\n    if ($retStatus !== 0) {\n        $sep = \"\\n\";\n        $failureMsg = '<strong>Error</strong> accessing UPS device information<br><br>';\n    } else {\n?>\n\n            <h3>General Information</h3>\n            <table class=\"summarySection\">\n\n<?php \n        foreach ($output as $line) {\n        list($var, $val) = split($sep, $line);\n        $var = htmlspecialchars($var, ENT_QUOTES, 'UTF-8');\n        $val = htmlspecialchars($val, ENT_QUOTES, 'UTF-8');\n?>\n                <tr>\n                <td class=\"summaryKey\"><?= $var ?></td>\n                <td class=\"summaryValue\"><span class=\"sleft\"><?= $val ?></span></td>\n                </tr>\n<?php\n        }\n?>\n            </table>\n<?php\n    }\n    \n    if (!empty($failureMsg)) {\n        include_once('include/management/actionMessages.php');\n    }\n?>\n        </div>\n        \n        <div id=\"footer\">\n<?php\n    include('page-footer.php');\n?>\n        </div>\n        \n    </div>\n</div>\n\n</body>\n</html>\n"], "filenames": ["include/config/logging.php", "include/management/actionMessages.php", "library/errorHandling.php", "library/exten-boot_log.php", "library/exten-daloradius_log.php", "library/exten-maint-radclient.php", "library/exten-radius_log.php", "library/exten-radius_server_info.php", "library/exten-server_info.php", "library/exten-syslog_log.php", "library/exten-welcome_page.php", "rep-logs-boot.php", "rep-logs-daloradius.php", "rep-logs-radius.php", "rep-logs-system.php", "rep-logs.php", "rep-stat-cron.php", "rep-stat-raid.php", "rep-stat-server.php", "rep-stat-services.php", "rep-stat-ups.php"], "buggy_code_start_loc": [2, 2, 17, 18, 18, 18, 18, 18, 18, 18, 17, 18, 18, 18, 18, 17, 17, 17, 17, 17, 17], "buggy_code_end_loc": [105, 27, 33, 63, 74, 118, 81, 55, 366, 63, 38, 77, 76, 77, 78, 67, 120, 132, 70, 72, 103], "fixing_code_start_loc": [2, 2, 17, 18, 18, 18, 18, 18, 18, 18, 17, 18, 18, 18, 18, 17, 17, 17, 17, 17, 17], "fixing_code_end_loc": [114, 42, 41, 93, 73, 122, 91, 56, 366, 89, 39, 74, 65, 76, 73, 59, 111, 106, 61, 60, 92], "type": "CWE-668", "message": "Exposure of Sensitive System Information to an Unauthorized Control Sphere in GitHub repository lirantal/daloradius prior to master branch.", "other": {"cve": {"id": "CVE-2022-4366", "sourceIdentifier": "security@huntr.dev", "published": "2022-12-08T19:15:10.157", "lastModified": "2022-12-12T15:29:16.477", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Exposure of Sensitive System Information to an Unauthorized Control Sphere in GitHub repository lirantal/daloradius prior to master branch."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 3.9, "impactScore": 3.6}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "NONE", "scope": "UNCHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 5.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 3.9, "impactScore": 1.4}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-668"}]}, {"source": "security@huntr.dev", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-497"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:daloradius:daloradius:-:*:*:*:*:*:*:*", "matchCriteriaId": "C90EA4F3-961C-4C47-80DE-0AC7BBCDCF3D"}]}]}], "references": [{"url": "https://github.com/lirantal/daloradius/commit/3d11f375a76ddb3741200296e15f81d82dfb80ce", "source": "security@huntr.dev", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://huntr.dev/bounties/f225d69a-d971-410d-a8f9-b0026143aed8", "source": "security@huntr.dev", "tags": ["Exploit", "Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/lirantal/daloradius/commit/3d11f375a76ddb3741200296e15f81d82dfb80ce"}}