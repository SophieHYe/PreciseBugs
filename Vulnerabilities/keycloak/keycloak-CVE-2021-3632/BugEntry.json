{"buggy_code": ["/*\n * Copyright 2019 Red Hat, Inc. and/or its affiliates\n * and other contributors as indicated by the @author tags.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\n\npackage org.keycloak.authentication.authenticators.browser;\n\nimport org.keycloak.authentication.Authenticator;\nimport org.keycloak.models.KeycloakSession;\nimport org.keycloak.models.credential.WebAuthnCredentialModel;\n\n/**\n * @author <a href=\"mailto:mposolda@redhat.com\">Marek Posolda</a>\n */\npublic class WebAuthnPasswordlessAuthenticatorFactory extends WebAuthnAuthenticatorFactory {\n\n    public static final String PROVIDER_ID = \"webauthn-authenticator-passwordless\";\n\n    @Override\n    public String getReferenceCategory() {\n        return WebAuthnCredentialModel.TYPE_PASSWORDLESS;\n    }\n\n    @Override\n    public String getDisplayType() {\n        return \"WebAuthn Passwordless Authenticator\";\n    }\n\n    @Override\n    public String getHelpText() {\n        return \"Authenticator for Passwordless WebAuthn authentication\";\n    }\n\n    @Override\n    public Authenticator create(KeycloakSession session) {\n        return new WebAuthnPasswordlessAuthenticator(session);\n    }\n\n    @Override\n    public String getId() {\n        return PROVIDER_ID;\n    }\n}\n"], "fixing_code": ["/*\n * Copyright 2019 Red Hat, Inc. and/or its affiliates\n * and other contributors as indicated by the @author tags.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\n\npackage org.keycloak.authentication.authenticators.browser;\n\nimport org.keycloak.authentication.Authenticator;\nimport org.keycloak.models.KeycloakSession;\nimport org.keycloak.models.credential.WebAuthnCredentialModel;\n\n/**\n * @author <a href=\"mailto:mposolda@redhat.com\">Marek Posolda</a>\n */\npublic class WebAuthnPasswordlessAuthenticatorFactory extends WebAuthnAuthenticatorFactory {\n\n    public static final String PROVIDER_ID = \"webauthn-authenticator-passwordless\";\n\n    @Override\n    public String getReferenceCategory() {\n        return WebAuthnCredentialModel.TYPE_PASSWORDLESS;\n    }\n\n    @Override\n    public String getDisplayType() {\n        return \"WebAuthn Passwordless Authenticator\";\n    }\n\n    @Override\n    public String getHelpText() {\n        return \"Authenticator for Passwordless WebAuthn authentication\";\n    }\n\n    @Override\n    public Authenticator create(KeycloakSession session) {\n        return new WebAuthnPasswordlessAuthenticator(session);\n    }\n\n    @Override\n    public String getId() {\n        return PROVIDER_ID;\n    }\n\n    @Override\n    public boolean isUserSetupAllowed() {\n        return false;\n    }\n\n}\n"], "buggy_code_start_loc": [55], "buggy_code_end_loc": [55], "fixing_code_start_loc": [56], "fixing_code_end_loc": [62], "type": "CWE-287", "message": "A flaw was found in Keycloak. This vulnerability allows anyone to register a new security device or key when there is not a device already registered for any user by using the WebAuthn password-less login flow.", "other": {"cve": {"id": "CVE-2021-3632", "sourceIdentifier": "secalert@redhat.com", "published": "2022-08-26T16:15:09.110", "lastModified": "2022-11-23T16:05:08.590", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "A flaw was found in Keycloak. This vulnerability allows anyone to register a new security device or key when there is not a device already registered for any user by using the WebAuthn password-less login flow."}, {"lang": "es", "value": "Se ha encontrado un fallo en Keycloak. Esta vulnerabilidad permite a cualquiera registrar un nuevo dispositivo de seguridad o llave cuando no se presenta un dispositivo ya registrado para ning\u00fan usuario, al usar el flujo de inicio de sesi\u00f3n sin contrase\u00f1a de WebAuthn."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.6, "impactScore": 5.9}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-287"}]}, {"source": "secalert@redhat.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-287"}]}], "configurations": [{"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:redhat:keycloak:*:*:*:*:*:*:*:*", "versionEndExcluding": "15.1.0", "matchCriteriaId": "08FEF5EB-2BDF-45E6-988A-D9B04FC9281D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:redhat:single_sign-on:7.0:*:*:*:*:*:*:*", "matchCriteriaId": "9EFEC7CA-8DDA-48A6-A7B6-1F1D14792890"}]}]}, {"operator": "AND", "nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:redhat:single_sign-on:*:*:*:*:*:*:*:*", "versionStartIncluding": "7.4", "versionEndExcluding": "7.4.9", "matchCriteriaId": "4DF7CC8E-B2F2-417A-B3CB-83A4F1869891"}]}, {"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": false, "criteria": "cpe:2.3:o:redhat:enterprise_linux:6.0:*:*:*:*:*:*:*", "matchCriteriaId": "2F6AB192-9D7D-4A9A-8995-E53A9DE9EAFC"}, {"vulnerable": false, "criteria": "cpe:2.3:o:redhat:enterprise_linux:7.0:*:*:*:*:*:*:*", "matchCriteriaId": "142AD0DD-4CF3-4D74-9442-459CE3347E3A"}, {"vulnerable": false, "criteria": "cpe:2.3:o:redhat:enterprise_linux:8.0:*:*:*:*:*:*:*", "matchCriteriaId": "F4CFF558-3C47-480D-A2F0-BABF26042943"}]}]}], "references": [{"url": "https://access.redhat.com/security/cve/CVE-2021-3632", "source": "secalert@redhat.com", "tags": ["Vendor Advisory"]}, {"url": "https://bugzilla.redhat.com/show_bug.cgi?id=1978196", "source": "secalert@redhat.com", "tags": ["Issue Tracking", "Vendor Advisory"]}, {"url": "https://github.com/keycloak/keycloak/commit/65480cb5a11630909c086f79d396004499fbd1e4", "source": "secalert@redhat.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/keycloak/keycloak/pull/8203", "source": "secalert@redhat.com", "tags": ["Issue Tracking", "Patch", "Third Party Advisory"]}, {"url": "https://issues.redhat.com/browse/KEYCLOAK-18500", "source": "secalert@redhat.com", "tags": ["Permissions Required", "Vendor Advisory"]}]}, "github_commit_url": "https://github.com/keycloak/keycloak/commit/65480cb5a11630909c086f79d396004499fbd1e4"}}