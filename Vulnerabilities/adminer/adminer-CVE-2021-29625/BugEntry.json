{"buggy_code": ["<?php\n/** Print select result\n* @param Min_Result\n* @param Min_DB connection to examine indexes\n* @param array\n* @param int\n* @return array $orgtables\n*/\nfunction select($result, $connection2 = null, $orgtables = array(), $limit = 0) {\n\tglobal $jush;\n\t$links = array(); // colno => orgtable - create links from these columns\n\t$indexes = array(); // orgtable => array(column => colno) - primary keys\n\t$columns = array(); // orgtable => array(column => ) - not selected columns in primary key\n\t$blobs = array(); // colno => bool - display bytes for blobs\n\t$types = array(); // colno => type - display char in <code>\n\t$return = array(); // table => orgtable - mapping to use in EXPLAIN\n\todd(''); // reset odd for each result\n\tfor ($i=0; (!$limit || $i < $limit) && ($row = $result->fetch_row()); $i++) {\n\t\tif (!$i) {\n\t\t\techo \"<div class='scrollable'>\\n\";\n\t\t\techo \"<table cellspacing='0' class='nowrap'>\\n\";\n\t\t\techo \"<thead><tr>\";\n\t\t\tfor ($j=0; $j < count($row); $j++) {\n\t\t\t\t$field = $result->fetch_field();\n\t\t\t\t$name = $field->name;\n\t\t\t\t$orgtable = $field->orgtable;\n\t\t\t\t$orgname = $field->orgname;\n\t\t\t\t$return[$field->table] = $orgtable;\n\t\t\t\tif ($orgtables && $jush == \"sql\") { // MySQL EXPLAIN\n\t\t\t\t\t$links[$j] = ($name == \"table\" ? \"table=\" : ($name == \"possible_keys\" ? \"indexes=\" : null));\n\t\t\t\t} elseif ($orgtable != \"\") {\n\t\t\t\t\tif (!isset($indexes[$orgtable])) {\n\t\t\t\t\t\t// find primary key in each table\n\t\t\t\t\t\t$indexes[$orgtable] = array();\n\t\t\t\t\t\tforeach (indexes($orgtable, $connection2) as $index) {\n\t\t\t\t\t\t\tif ($index[\"type\"] == \"PRIMARY\") {\n\t\t\t\t\t\t\t\t$indexes[$orgtable] = array_flip($index[\"columns\"]);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t$columns[$orgtable] = $indexes[$orgtable];\n\t\t\t\t\t}\n\t\t\t\t\tif (isset($columns[$orgtable][$orgname])) {\n\t\t\t\t\t\tunset($columns[$orgtable][$orgname]);\n\t\t\t\t\t\t$indexes[$orgtable][$orgname] = $j;\n\t\t\t\t\t\t$links[$j] = $orgtable;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ($field->charsetnr == 63) { // 63 - binary\n\t\t\t\t\t$blobs[$j] = true;\n\t\t\t\t}\n\t\t\t\t$types[$j] = $field->type;\n\t\t\t\techo \"<th\" . ($orgtable != \"\" || $field->name != $orgname ? \" title='\" . h(($orgtable != \"\" ? \"$orgtable.\" : \"\") . $orgname) . \"'\" : \"\") . \">\" . h($name)\n\t\t\t\t\t. ($orgtables ? doc_link(array(\n\t\t\t\t\t\t'sql' => \"explain-output.html#explain_\" . strtolower($name),\n\t\t\t\t\t\t'mariadb' => \"explain/#the-columns-in-explain-select\",\n\t\t\t\t\t)) : \"\")\n\t\t\t\t;\n\t\t\t}\n\t\t\techo \"</thead>\\n\";\n\t\t}\n\t\techo \"<tr\" . odd() . \">\";\n\t\tforeach ($row as $key => $val) {\n\t\t\t$link = \"\";\n\t\t\tif (isset($links[$key]) && !$columns[$links[$key]]) {\n\t\t\t\tif ($orgtables && $jush == \"sql\") { // MySQL EXPLAIN\n\t\t\t\t\t$table = $row[array_search(\"table=\", $links)];\n\t\t\t\t\t$link = ME . $links[$key] . urlencode($orgtables[$table] != \"\" ? $orgtables[$table] : $table);\n\t\t\t\t} else {\n\t\t\t\t\t$link = ME . \"edit=\" . urlencode($links[$key]);\n\t\t\t\t\tforeach ($indexes[$links[$key]] as $col => $j) {\n\t\t\t\t\t\t$link .= \"&where\" . urlencode(\"[\" . bracket_escape($col) . \"]\") . \"=\" . urlencode($row[$j]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} elseif (is_url($val)) {\n\t\t\t\t$link = $val;\n\t\t\t}\n\t\t\tif ($val === null) {\n\t\t\t\t$val = \"<i>NULL</i>\";\n\t\t\t} elseif ($blobs[$key] && !is_utf8($val)) {\n\t\t\t\t$val = \"<i>\" . lang('%d byte(s)', strlen($val)) . \"</i>\"; //! link to download\n\t\t\t} else {\n\t\t\t\t$val = h($val);\n\t\t\t\tif ($types[$key] == 254) { // 254 - char\n\t\t\t\t\t$val = \"<code>$val</code>\";\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ($link) {\n\t\t\t\t$val = \"<a href='\" . h($link) . \"'\" . (is_url($link) ? target_blank() : '') . \">$val</a>\";\n\t\t\t}\n\t\t\techo \"<td>$val\";\n\t\t}\n\t}\n\techo ($i ? \"</table>\\n</div>\" : \"<p class='message'>\" . lang('No rows.')) . \"\\n\";\n\treturn $return;\n}\n\n/** Get referencable tables with single column primary key except self\n* @param string\n* @return array ($table_name => $field)\n*/\nfunction referencable_primary($self) {\n\t$return = array(); // table_name => field\n\tforeach (table_status('', true) as $table_name => $table) {\n\t\tif ($table_name != $self && fk_support($table)) {\n\t\t\tforeach (fields($table_name) as $field) {\n\t\t\t\tif ($field[\"primary\"]) {\n\t\t\t\t\tif ($return[$table_name]) { // multi column primary key\n\t\t\t\t\t\tunset($return[$table_name]);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\t$return[$table_name] = $field;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn $return;\n}\n\n/** Get settings stored in a cookie\n* @return array\n*/\nfunction adminer_settings() {\n\tparse_str($_COOKIE[\"adminer_settings\"], $settings);\n\treturn $settings;\n}\n\n/** Get setting stored in a cookie\n* @param string\n* @return array\n*/\nfunction adminer_setting($key) {\n\t$settings = adminer_settings();\n\treturn $settings[$key];\n}\n\n/** Store settings to a cookie\n* @param array\n* @return bool\n*/\nfunction set_adminer_settings($settings) {\n\treturn cookie(\"adminer_settings\", http_build_query($settings + adminer_settings()));\n}\n\n/** Print SQL <textarea> tag\n* @param string\n* @param string or array in which case [0] of every element is used\n* @param int\n* @param int\n* @return null\n*/\nfunction textarea($name, $value, $rows = 10, $cols = 80) {\n\tglobal $jush;\n\techo \"<textarea name='$name' rows='$rows' cols='$cols' class='sqlarea jush-$jush' spellcheck='false' wrap='off'>\";\n\tif (is_array($value)) {\n\t\tforeach ($value as $val) { // not implode() to save memory\n\t\t\techo h($val[0]) . \"\\n\\n\\n\"; // $val == array($query, $time, $elapsed)\n\t\t}\n\t} else {\n\t\techo h($value);\n\t}\n\techo \"</textarea>\";\n}\n\n/** Print table columns for type edit\n* @param string\n* @param array\n* @param array\n* @param array returned by referencable_primary()\n* @param array extra types to prepend\n* @return null\n*/\nfunction edit_type($key, $field, $collations, $foreign_keys = array(), $extra_types = array()) {\n\tglobal $structured_types, $types, $unsigned, $on_actions;\n\t$type = $field[\"type\"];\n\t?>\n<td><select name=\"<?php echo h($key); ?>[type]\" class=\"type\" aria-labelledby=\"label-type\"><?php\nif ($type && !isset($types[$type]) && !isset($foreign_keys[$type]) && !in_array($type, $extra_types)) {\n\t$extra_types[] = $type;\n}\nif ($foreign_keys) {\n\t$structured_types[lang('Foreign keys')] = $foreign_keys;\n}\necho optionlist(array_merge($extra_types, $structured_types), $type);\n?></select><td><input name=\"<?php echo h($key); ?>[length]\" value=\"<?php echo h($field[\"length\"]); ?>\" size=\"3\"<?php echo (!$field[\"length\"] && preg_match('~var(char|binary)$~', $type) ? \" class='required'\" : \"\"); //! type=\"number\" with enabled JavaScript ?> aria-labelledby=\"label-length\"><td class=\"options\"><?php\n\techo \"<select name='\" . h($key) . \"[collation]'\" . (preg_match('~(char|text|enum|set)$~', $type) ? \"\" : \" class='hidden'\") . '><option value=\"\">(' . lang('collation') . ')' . optionlist($collations, $field[\"collation\"]) . '</select>';\n\techo ($unsigned ? \"<select name='\" . h($key) . \"[unsigned]'\" . (!$type || preg_match(number_type(), $type) ? \"\" : \" class='hidden'\") . '><option>' . optionlist($unsigned, $field[\"unsigned\"]) . '</select>' : '');\n\techo (isset($field['on_update']) ? \"<select name='\" . h($key) . \"[on_update]'\" . (preg_match('~timestamp|datetime~', $type) ? \"\" : \" class='hidden'\") . '>' . optionlist(array(\"\" => \"(\" . lang('ON UPDATE') . \")\", \"CURRENT_TIMESTAMP\"), (preg_match('~^CURRENT_TIMESTAMP~i', $field[\"on_update\"]) ? \"CURRENT_TIMESTAMP\" : $field[\"on_update\"])) . '</select>' : '');\n\techo ($foreign_keys ? \"<select name='\" . h($key) . \"[on_delete]'\" . (preg_match(\"~`~\", $type) ? \"\" : \" class='hidden'\") . \"><option value=''>(\" . lang('ON DELETE') . \")\" . optionlist(explode(\"|\", $on_actions), $field[\"on_delete\"]) . \"</select> \" : \" \"); // space for IE\n}\n\n/** Filter length value including enums\n* @param string\n* @return string\n*/\nfunction process_length($length) {\n\tglobal $enum_length;\n\treturn (preg_match(\"~^\\\\s*\\\\(?\\\\s*$enum_length(?:\\\\s*,\\\\s*$enum_length)*+\\\\s*\\\\)?\\\\s*\\$~\", $length) && preg_match_all(\"~$enum_length~\", $length, $matches)\n\t\t? \"(\" . implode(\",\", $matches[0]) . \")\"\n\t\t: preg_replace('~^[0-9].*~', '(\\0)', preg_replace('~[^-0-9,+()[\\]]~', '', $length))\n\t);\n}\n\n/** Create SQL string from field type\n* @param array\n* @param string\n* @return string\n*/\nfunction process_type($field, $collate = \"COLLATE\") {\n\tglobal $unsigned;\n\treturn \" $field[type]\"\n\t\t. process_length($field[\"length\"])\n\t\t. (preg_match(number_type(), $field[\"type\"]) && in_array($field[\"unsigned\"], $unsigned) ? \" $field[unsigned]\" : \"\")\n\t\t. (preg_match('~char|text|enum|set~', $field[\"type\"]) && $field[\"collation\"] ? \" $collate \" . q($field[\"collation\"]) : \"\")\n\t;\n}\n\n/** Create SQL string from field\n* @param array basic field information\n* @param array information about field type\n* @return array array(\"field\", \"type\", \"NULL\", \"DEFAULT\", \"ON UPDATE\", \"COMMENT\", \"AUTO_INCREMENT\")\n*/\nfunction process_field($field, $type_field) {\n\treturn array(\n\t\tidf_escape(trim($field[\"field\"])),\n\t\tprocess_type($type_field),\n\t\t($field[\"null\"] ? \" NULL\" : \" NOT NULL\"), // NULL for timestamp\n\t\tdefault_value($field),\n\t\t(preg_match('~timestamp|datetime~', $field[\"type\"]) && $field[\"on_update\"] ? \" ON UPDATE $field[on_update]\" : \"\"),\n\t\t(support(\"comment\") && $field[\"comment\"] != \"\" ? \" COMMENT \" . q($field[\"comment\"]) : \"\"),\n\t\t($field[\"auto_increment\"] ? auto_increment() : null),\n\t);\n}\n\n/** Get default value clause\n* @param array\n* @return string\n*/\nfunction default_value($field) {\n\t$default = $field[\"default\"];\n\treturn ($default === null ? \"\" : \" DEFAULT \" . (preg_match('~char|binary|text|enum|set~', $field[\"type\"]) || preg_match('~^(?![a-z])~i', $default) ? q($default) : $default));\n}\n\n/** Get type class to use in CSS\n* @param string\n* @return string class=''\n*/\nfunction type_class($type) {\n\tforeach (array(\n\t\t'char' => 'text',\n\t\t'date' => 'time|year',\n\t\t'binary' => 'blob',\n\t\t'enum' => 'set',\n\t) as $key => $val) {\n\t\tif (preg_match(\"~$key|$val~\", $type)) {\n\t\t\treturn \" class='$key'\";\n\t\t}\n\t}\n}\n\n/** Print table interior for fields editing\n* @param array\n* @param array\n* @param string TABLE or PROCEDURE\n* @param array returned by referencable_primary()\n* @return null\n*/\nfunction edit_fields($fields, $collations, $type = \"TABLE\", $foreign_keys = array()) {\n\tglobal $inout;\n\t$fields = array_values($fields);\n\t$default_class = (($_POST ? $_POST[\"defaults\"] : adminer_setting(\"defaults\")) ? \"\" : \" class='hidden'\");\n\t$comment_class = (($_POST ? $_POST[\"comments\"] : adminer_setting(\"comments\")) ? \"\" : \" class='hidden'\");\n\t?>\n<thead><tr>\n<?php if ($type == \"PROCEDURE\") { ?><td><?php } ?>\n<th id=\"label-name\"><?php echo ($type == \"TABLE\" ? lang('Column name') : lang('Parameter name')); ?>\n<td id=\"label-type\"><?php echo lang('Type'); ?><textarea id=\"enum-edit\" rows=\"4\" cols=\"12\" wrap=\"off\" style=\"display: none;\"></textarea><?php echo script(\"qs('#enum-edit').onblur = editingLengthBlur;\"); ?>\n<td id=\"label-length\"><?php echo lang('Length'); ?>\n<td><?php echo lang('Options'); /* no label required, options have their own label */ ?>\n<?php if ($type == \"TABLE\") { ?>\n<td id=\"label-null\">NULL\n<td><input type=\"radio\" name=\"auto_increment_col\" value=\"\"><acronym id=\"label-ai\" title=\"<?php echo lang('Auto Increment'); ?>\">AI</acronym><?php echo doc_link(array(\n\t'sql' => \"example-auto-increment.html\",\n\t'mariadb' => \"auto_increment/\",\n\t'sqlite' => \"autoinc.html\",\n\t'pgsql' => \"datatype.html#DATATYPE-SERIAL\",\n\t'mssql' => \"ms186775.aspx\",\n)); ?>\n<td id=\"label-default\"<?php echo $default_class; ?>><?php echo lang('Default value'); ?>\n<?php echo (support(\"comment\") ? \"<td id='label-comment'$comment_class>\" . lang('Comment') : \"\"); ?>\n<?php } ?>\n<td><?php echo \"<input type='image' class='icon' name='add[\" . (support(\"move_col\") ? 0 : count($fields)) . \"]' src='../adminer/static/plus.gif' alt='+' title='\" . lang('Add next') . \"'>\" . script(\"row_count = \" . count($fields) . \";\"); ?>\n</thead>\n<tbody>\n<?php\n\techo script(\"mixin(qsl('tbody'), {onclick: editingClick, onkeydown: editingKeydown, oninput: editingInput});\");\n\tforeach ($fields as $i => $field) {\n\t\t$i++;\n\t\t$orig = $field[($_POST ? \"orig\" : \"field\")];\n\t\t$display = (isset($_POST[\"add\"][$i-1]) || (isset($field[\"field\"]) && !$_POST[\"drop_col\"][$i])) && (support(\"drop_col\") || $orig == \"\");\n\t\t?>\n<tr<?php echo ($display ? \"\" : \" style='display: none;'\"); ?>>\n<?php echo ($type == \"PROCEDURE\" ? \"<td>\" . html_select(\"fields[$i][inout]\", explode(\"|\", $inout), $field[\"inout\"]) : \"\"); ?>\n<th><?php if ($display) { ?><input name=\"fields[<?php echo $i; ?>][field]\" value=\"<?php echo h($field[\"field\"]); ?>\" data-maxlength=\"64\" autocapitalize=\"off\" aria-labelledby=\"label-name\"><?php } ?>\n<input type=\"hidden\" name=\"fields[<?php echo $i; ?>][orig]\" value=\"<?php echo h($orig); ?>\"><?php edit_type(\"fields[$i]\", $field, $collations, $foreign_keys); ?>\n<?php if ($type == \"TABLE\") { ?>\n<td><?php echo checkbox(\"fields[$i][null]\", 1, $field[\"null\"], \"\", \"\", \"block\", \"label-null\"); ?>\n<td><label class=\"block\"><input type=\"radio\" name=\"auto_increment_col\" value=\"<?php echo $i; ?>\"<?php if ($field[\"auto_increment\"]) { ?> checked<?php } ?> aria-labelledby=\"label-ai\"></label><td<?php echo $default_class; ?>><?php\n\t\t\techo checkbox(\"fields[$i][has_default]\", 1, $field[\"has_default\"], \"\", \"\", \"\", \"label-default\"); ?><input name=\"fields[<?php echo $i; ?>][default]\" value=\"<?php echo h($field[\"default\"]); ?>\" aria-labelledby=\"label-default\"><?php\n\t\t\techo (support(\"comment\") ? \"<td$comment_class><input name='fields[$i][comment]' value='\" . h($field[\"comment\"]) . \"' data-maxlength='\" . (min_version(5.5) ? 1024 : 255) . \"' aria-labelledby='label-comment'>\" : \"\");\n\t\t}\n\t\techo \"<td>\";\n\t\techo (support(\"move_col\") ?\n\t\t\t\"<input type='image' class='icon' name='add[$i]' src='../adminer/static/plus.gif' alt='+' title='\" . lang('Add next') . \"'> \"\n\t\t\t. \"<input type='image' class='icon' name='up[$i]' src='../adminer/static/up.gif' alt='\u2191' title='\" . lang('Move up') . \"'> \"\n\t\t\t. \"<input type='image' class='icon' name='down[$i]' src='../adminer/static/down.gif' alt='\u2193' title='\" . lang('Move down') . \"'> \"\n\t\t: \"\");\n\t\techo ($orig == \"\" || support(\"drop_col\") ? \"<input type='image' class='icon' name='drop_col[$i]' src='../adminer/static/cross.gif' alt='x' title='\" . lang('Remove') . \"'>\" : \"\");\n\t}\n}\n\n/** Move fields up and down or add field\n* @param array\n* @return bool\n*/\nfunction process_fields(&$fields) {\n\t$offset = 0;\n\tif ($_POST[\"up\"]) {\n\t\t$last = 0;\n\t\tforeach ($fields as $key => $field) {\n\t\t\tif (key($_POST[\"up\"]) == $key) {\n\t\t\t\tunset($fields[$key]);\n\t\t\t\tarray_splice($fields, $last, 0, array($field));\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (isset($field[\"field\"])) {\n\t\t\t\t$last = $offset;\n\t\t\t}\n\t\t\t$offset++;\n\t\t}\n\t} elseif ($_POST[\"down\"]) {\n\t\t$found = false;\n\t\tforeach ($fields as $key => $field) {\n\t\t\tif (isset($field[\"field\"]) && $found) {\n\t\t\t\tunset($fields[key($_POST[\"down\"])]);\n\t\t\t\tarray_splice($fields, $offset, 0, array($found));\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (key($_POST[\"down\"]) == $key) {\n\t\t\t\t$found = $field;\n\t\t\t}\n\t\t\t$offset++;\n\t\t}\n\t} elseif ($_POST[\"add\"]) {\n\t\t$fields = array_values($fields);\n\t\tarray_splice($fields, key($_POST[\"add\"]), 0, array(array()));\n\t} elseif (!$_POST[\"drop_col\"]) {\n\t\treturn false;\n\t}\n\treturn true;\n}\n\n/** Callback used in routine()\n* @param array\n* @return string\n*/\nfunction normalize_enum($match) {\n\treturn \"'\" . str_replace(\"'\", \"''\", addcslashes(stripcslashes(str_replace($match[0][0] . $match[0][0], $match[0][0], substr($match[0], 1, -1))), '\\\\')) . \"'\";\n}\n\n/** Issue grant or revoke commands\n* @param string GRANT or REVOKE\n* @param array\n* @param string\n* @param string\n* @return bool\n*/\nfunction grant($grant, $privileges, $columns, $on) {\n\tif (!$privileges) {\n\t\treturn true;\n\t}\n\tif ($privileges == array(\"ALL PRIVILEGES\", \"GRANT OPTION\")) {\n\t\t// can't be granted or revoked together\n\t\treturn ($grant == \"GRANT\"\n\t\t\t? queries(\"$grant ALL PRIVILEGES$on WITH GRANT OPTION\")\n\t\t\t: queries(\"$grant ALL PRIVILEGES$on\") && queries(\"$grant GRANT OPTION$on\")\n\t\t);\n\t}\n\treturn queries(\"$grant \" . preg_replace('~(GRANT OPTION)\\([^)]*\\)~', '\\1', implode(\"$columns, \", $privileges) . $columns) . $on);\n}\n\n/** Drop old object and create a new one\n* @param string drop old object query\n* @param string create new object query\n* @param string drop new object query\n* @param string create test object query\n* @param string drop test object query\n* @param string\n* @param string\n* @param string\n* @param string\n* @param string\n* @param string\n* @return null redirect in success\n*/\nfunction drop_create($drop, $create, $drop_created, $test, $drop_test, $location, $message_drop, $message_alter, $message_create, $old_name, $new_name) {\n\tif ($_POST[\"drop\"]) {\n\t\tquery_redirect($drop, $location, $message_drop);\n\t} elseif ($old_name == \"\") {\n\t\tquery_redirect($create, $location, $message_create);\n\t} elseif ($old_name != $new_name) {\n\t\t$created = queries($create);\n\t\tqueries_redirect($location, $message_alter, $created && queries($drop));\n\t\tif ($created) {\n\t\t\tqueries($drop_created);\n\t\t}\n\t} else {\n\t\tqueries_redirect(\n\t\t\t$location,\n\t\t\t$message_alter,\n\t\t\tqueries($test) && queries($drop_test) && queries($drop) && queries($create)\n\t\t);\n\t}\n}\n\n/** Generate SQL query for creating trigger\n* @param string\n* @param array result of trigger()\n* @return string\n*/\nfunction create_trigger($on, $row) {\n\tglobal $jush;\n\t$timing_event = \" $row[Timing] $row[Event]\" . (preg_match('~ OF~', $row[\"Event\"]) ? \" $row[Of]\" : \"\"); // SQL injection\n\treturn \"CREATE TRIGGER \"\n\t\t. idf_escape($row[\"Trigger\"])\n\t\t. ($jush == \"mssql\" ? $on . $timing_event : $timing_event . $on)\n\t\t. rtrim(\" $row[Type]\\n$row[Statement]\", \";\")\n\t\t. \";\"\n\t;\n}\n\n/** Generate SQL query for creating routine\n* @param string \"PROCEDURE\" or \"FUNCTION\"\n* @param array result of routine()\n* @return string\n*/\nfunction create_routine($routine, $row) {\n\tglobal $inout, $jush;\n\t$set = array();\n\t$fields = (array) $row[\"fields\"];\n\tksort($fields); // enforce fields order\n\tforeach ($fields as $field) {\n\t\tif ($field[\"field\"] != \"\") {\n\t\t\t$set[] = (preg_match(\"~^($inout)\\$~\", $field[\"inout\"]) ? \"$field[inout] \" : \"\") . idf_escape($field[\"field\"]) . process_type($field, \"CHARACTER SET\");\n\t\t}\n\t}\n\t$definition = rtrim(\"\\n$row[definition]\", \";\");\n\treturn \"CREATE $routine \"\n\t\t. idf_escape(trim($row[\"name\"]))\n\t\t. \" (\" . implode(\", \", $set) . \")\"\n\t\t. (isset($_GET[\"function\"]) ? \" RETURNS\" . process_type($row[\"returns\"], \"CHARACTER SET\") : \"\")\n\t\t. ($row[\"language\"] ? \" LANGUAGE $row[language]\" : \"\")\n\t\t. ($jush == \"pgsql\" ? \" AS \" . q($definition) : \"$definition;\")\n\t;\n}\n\n/** Remove current user definer from SQL command\n* @param string\n* @return string\n*/\nfunction remove_definer($query) {\n\treturn preg_replace('~^([A-Z =]+) DEFINER=`' . preg_replace('~@(.*)~', '`@`(%|\\1)', logged_user()) . '`~', '\\1', $query); //! proper escaping of user\n}\n\n/** Format foreign key to use in SQL query\n* @param array (\"db\" => string, \"ns\" => string, \"table\" => string, \"source\" => array, \"target\" => array, \"on_delete\" => one of $on_actions, \"on_update\" => one of $on_actions)\n* @return string\n*/\nfunction format_foreign_key($foreign_key) {\n\tglobal $on_actions;\n\t$db = $foreign_key[\"db\"];\n\t$ns = $foreign_key[\"ns\"];\n\treturn \" FOREIGN KEY (\" . implode(\", \", array_map('idf_escape', $foreign_key[\"source\"])) . \") REFERENCES \"\n\t\t. ($db != \"\" && $db != $_GET[\"db\"] ? idf_escape($db) . \".\" : \"\")\n\t\t. ($ns != \"\" && $ns != $_GET[\"ns\"] ? idf_escape($ns) . \".\" : \"\")\n\t\t. table($foreign_key[\"table\"])\n\t\t. \" (\" . implode(\", \", array_map('idf_escape', $foreign_key[\"target\"])) . \")\" //! reuse $name - check in older MySQL versions\n\t\t. (preg_match(\"~^($on_actions)\\$~\", $foreign_key[\"on_delete\"]) ? \" ON DELETE $foreign_key[on_delete]\" : \"\")\n\t\t. (preg_match(\"~^($on_actions)\\$~\", $foreign_key[\"on_update\"]) ? \" ON UPDATE $foreign_key[on_update]\" : \"\")\n\t;\n}\n\n/** Add a file to TAR\n* @param string\n* @param TmpFile\n* @return null prints the output\n*/\nfunction tar_file($filename, $tmp_file) {\n\t$return = pack(\"a100a8a8a8a12a12\", $filename, 644, 0, 0, decoct($tmp_file->size), decoct(time()));\n\t$checksum = 8*32; // space for checksum itself\n\tfor ($i=0; $i < strlen($return); $i++) {\n\t\t$checksum += ord($return[$i]);\n\t}\n\t$return .= sprintf(\"%06o\", $checksum) . \"\\0 \";\n\techo $return;\n\techo str_repeat(\"\\0\", 512 - strlen($return));\n\t$tmp_file->send();\n\techo str_repeat(\"\\0\", 511 - ($tmp_file->size + 511) % 512);\n}\n\n/** Get INI bytes value\n* @param string\n* @return int\n*/\nfunction ini_bytes($ini) {\n\t$val = ini_get($ini);\n\tswitch (strtolower(substr($val, -1))) {\n\t\tcase 'g': $val *= 1024; // no break\n\t\tcase 'm': $val *= 1024; // no break\n\t\tcase 'k': $val *= 1024;\n\t}\n\treturn $val;\n}\n\n/** Create link to database documentation\n* @param array $jush => $path\n* @param string HTML code\n* @return string HTML code\n*/\nfunction doc_link($paths, $text = \"<sup>?</sup>\") {\n\tglobal $jush, $connection;\n\t$server_info = $connection->server_info;\n\t$version = preg_replace('~^(\\d\\.?\\d).*~s', '\\1', $server_info); // two most significant digits\n\t$urls = array(\n\t\t'sql' => \"https://dev.mysql.com/doc/refman/$version/en/\",\n\t\t'sqlite' => \"https://www.sqlite.org/\",\n\t\t'pgsql' => \"https://www.postgresql.org/docs/$version/\",\n\t\t'mssql' => \"https://msdn.microsoft.com/library/\",\n\t\t'oracle' => \"https://www.oracle.com/pls/topic/lookup?ctx=db\" . preg_replace('~^.* (\\d+)\\.(\\d+)\\.\\d+\\.\\d+\\.\\d+.*~s', '\\1\\2', $server_info) . \"&id=\",\n\t);\n\tif (preg_match('~MariaDB~', $server_info)) {\n\t\t$urls['sql'] = \"https://mariadb.com/kb/en/library/\";\n\t\t$paths['sql'] = (isset($paths['mariadb']) ? $paths['mariadb'] : str_replace(\".html\", \"/\", $paths['sql']));\n\t}\n\treturn ($paths[$jush] ? \"<a href='$urls[$jush]$paths[$jush]'\" . target_blank() . \">$text</a>\" : \"\");\n}\n\n/** Wrap gzencode() for usage in ob_start()\n* @param string\n* @return string\n*/\nfunction ob_gzencode($string) {\n\t// ob_start() callback recieves an optional parameter $phase but gzencode() accepts optional parameter $level\n\treturn gzencode($string);\n}\n\n/** Compute size of database\n* @param string\n* @return string formatted\n*/\nfunction db_size($db) {\n\tglobal $connection;\n\tif (!$connection->select_db($db)) {\n\t\treturn \"?\";\n\t}\n\t$return = 0;\n\tforeach (table_status() as $table_status) {\n\t\t$return += $table_status[\"Data_length\"] + $table_status[\"Index_length\"];\n\t}\n\treturn format_number($return);\n}\n\n/** Print SET NAMES if utf8mb4 might be needed\n* @param string\n* @return null\n*/\nfunction set_utf8mb4($create) {\n\tglobal $connection;\n\tstatic $set = false;\n\tif (!$set && preg_match('~\\butf8mb4~i', $create)) { // possible false positive\n\t\t$set = true;\n\t\techo \"SET NAMES \" . charset($connection) . \";\\n\\n\";\n\t}\n}\n", "Adminer 4.8.1-dev:\nFix more PHP 8 warnings (bug #781)\nAvoid PHP warnings with PDO drivers (bug #786, regression from 4.7.8)\nMySQL: Allow moving views to other DB and renaming DB with views (bug #783)\nMariaDB: Do not treat sequences as views (PR #416)\nPostgreSQL: Support UPDATE OF triggers (bug #789)\nPostgreSQL: Support triggers with more events (OR)\nPostgreSQL: Fix parsing of foreign keys with non-ASCII column names\nPostgreSQL < 10 PDO: Avoid displaying GENERATED ALWAYS BY IDENTITY everywhere (bug #785, regression from 4.7.9)\nSQLite: Fix displayed types (bug #784, regression from 4.8.0)\n\nAdminer 4.8.0 (released 2021-02-10):\nSupport function default values in insert (bug #713)\nAllow SQL pseudo-function in insert\nSkip date columns for non-date values in search anywhere\nAdd DB version to comment in export\nSupport PHP 8 in create table (regression from 4.7.9)\nMySQL 8: Fix EXPLAIN in SQL command\nPostgreSQL: Create PRIMARY KEY for auto increment columns\nPostgreSQL: Avoid exporting empty sequence last value (bug #768)\nPostgreSQL: Do not show triggers from other schemas (PR #412)\nPostgreSQL: Fix multi-parameter functions in default values (bug #736)\nPostgreSQL: Fix displaying NULL bytea fields\nPostgreSQL PDO: Do not select NULL function for false values in edit\nOracle: Alter indexes\nOracle: Count tables\nOracle: Import from CSV\nOracle: Fix column size with string type\nMongoDB: Handle errors\nSimpleDB, Firebird, ClickHouse: Move to plugin\n\nAdminer 4.7.9 (released 2021-02-07):\nFix XSS in browsers which don't encode URL parameters (bug #775, regression from 4.7.0)\nElasticsearch, ClickHouse: Do not print response if HTTP code is not 200\nDon't syntax highlight during IME composition (bug #747)\nQuote values with leading and trailing zeroes in CSV export (bug #777)\nLink URLs in SQL command (PR #411)\nFix displayed foreign key columns from other DB (bug #766)\nRe-enable PHP warnings (regression from 4.7.8)\nMySQL: Do not export names in quotes with sql_mode='ANSI_QUOTES' (bug #749)\nMySQL: Avoid error in PHP 8 when connecting to socket (PR #409)\nMySQL: Don't quote default value of text fields (bug #779)\nPostgreSQL: Export all FKs after all CREATE TABLE (PR #351)\nPostgreSQL: Fix dollar-quoted syntax highlighting (bug #738)\nPostgreSQL: Do not show view definition from other schema (PR #392)\nPostgreSQL: Use bigserial for bigint auto increment (bug #765, regression from 3.0.0)\nPostgreSQL PDO: Support PgBouncer, unsupport PostgreSQL < 9.1 (bug #771)\nPostgreSQL 10: Support GENERATED ALWAYS BY IDENTITY (PR #386)\nPostgreSQL 10: Support partitioned tables (PR #396)\nPostgreSQL 11: Create PRIMARY KEY for auto increment columns\nSQLite: Set busy_timeout to 500\nMS SQL: Don't truncate comments to 30 chars (PR #376)\nElasticsearch 6: Fix displaying type mapping (PR #402)\nMongoDB: Fix password-less check in the mongo extension (PR #405)\nEditor: Cast to string when searching (bug #325)\nEditor: Avoid trailing dot in export filename\n\nAdminer 4.7.8 (released 2020-12-06):\nSupport PHP 8\nDisallow connecting to privileged ports (bug #769)\n\nAdminer 4.7.7 (released 2020-05-11):\nFix open redirect if Adminer is accessible at //adminer.php%2F@\n\nAdminer 4.7.6 (released 2020-01-31):\nSpeed up alter table form (regression from 4.4.0)\nFix clicking on non-input fields in alter table (regression from 4.6.2)\nDisplay time of procedure execution\nDisallow connecting to ports > 65535 (bug #730)\nMySQL: Always set foreign_key_checks in export\nPostgreSQL: Support exporting views\nEditor: Fix focusing foreign key search in select\n\nAdminer 4.7.5 (released 2019-11-13):\nAdd id=\"\" to cells with failed inline edit (bug #708)\nPostgreSQL: Fix getting default value in PostgreSQL 12 (bug #719)\nPostgreSQL, Oracle: Set schema for EXPLAIN queries in SQL command (bug #706)\nClickHouse: SQL command\nSwedish translation\n\nAdminer 4.7.4 (released 2019-10-22):\nFix XSS if Adminer is accessible at URL /data:\n\nAdminer 4.7.3 (released 2019-08-27):\nAllow editing foreign keys pointing to tables in other database/schema (bug #694)\nFix blocking of concurrent instances in PHP >7.2 (bug #703)\nMySQL: Speed up displaying tables in large databases (bug #700, regression from 4.7.2)\nMySQL: Allow editing rows identified by negative floats (bug #695)\nMySQL: Skip editing generated columns\nSQLite: Quote strings stored in integer columns in export (bug #696)\nSQLite: Handle error in altering table (bug #697)\nSQLite: Allow setting auto increment for empty tables\nSQLite: Preserve auto increment when recreating table\nMS SQL: Support foreign keys to other DB\nMongoDB: Allow setting authSource from environment variable \n\nAdminer 4.7.2 (released 2019-07-18):\nDo not attempt logging in without password (bug #676)\nStretch footer over the whole table width (bug #624)\nAllow overwriting tables when copying them\nFix displaying SQL command after Save and continue edit\nCache busting for adminer.css\nMySQL: Fix displaying multi-columns foreign keys (bug #675, regression from 4.7.0)\nMySQL: Fix creating users and changing password in MySQL 8 (bug #663)\nMySQL: Pass SRID to GeomFromText\nPostgreSQL: Fix setting column comments on new table\nPostgreSQL: Display definitions of materialized views (bug #682)\nPostgreSQL: Fix table status in PostgreSQL 12 (bug #683)\nMS SQL: Support comments\nElasticsearch: Fix setting number of rows\n\nAdminer 4.7.1 (released 2019-01-24):\nDisplay the tables scrollbar (bug #647)\nRemember visible columns in Create Table form (bug #493)\nAdd autocomplete attributes to login form\nPHP <5.4 compatibility even with ClickHouse enabled (regression from 4.7.0)\nSQLite: Hide server field in login form\nEditor: Allow disabling boolean fields in PostgreSQL (bug #640)\n\nAdminer 4.7.0 (released 2018-11-24):\nSimplify storing executed SQL queries to bookmarks\nWarn when using password with leading or trailing spaces\nHide import from server if importServerPath() returns an empty string\nFix inline editing of empty cells (regression from 4.6.3)\nAllow adding more than two indexes and forign key columns at a time (regression from 4.4.0)\nAvoid overwriting existing tables when copying tables (bug #642)\nFix function change with set data type\nIncrease username maxlength to 80 (bug #623)\nMake maxlength in all fields a soft limit\nMake tables horizontally scrollable\nMySQL: Support foreign keys created with ANSI quotes (bug #620)\nMySQL: Recognize ON UPDATE current_timestamp() (bug #632, bug #638)\nMySQL: Descending indexes in MySQL 8 (bug #643)\nPostgreSQL: Quote array values in export (bug #621)\nPostgreSQL: Export DESC indexes (bug #639)\nPostgreSQL: Support GENERATED BY DEFAULT AS IDENTITY in PostgreSQL 10\nMS SQL: Pass database when connecting\nClickHouse: Connect, databases list, tables list, select, SQL command\nGeorgian translation\n\nAdminer 4.6.3 (released 2018-06-28):\nDisallow using password-less databases\nCopy triggers when copying table\nStop session before connecting\nSimplify running slow queries\nDecrease timeout for running slow queries from 5 seconds to 2 seconds\nFix displaying info about non-alphabetical objects (bug #599)\nUse secure cookies on HTTP if session.cookie_secure is set\nPDO: Support binary fields download\nMySQL: Disallow LOAD DATA LOCAL INFILE\nMySQL: Use CONVERT() only when searching for non-ASCII (bug #603)\nMySQL: Order database names in MySQL 8 (bug #613)\nPostgreSQL: Fix editing data in views (bug #605, regression from 4.6.0)\nPostgreSQL: Do not cast date/time/number/uuid searches to text (bug #608)\nPostgreSQL: Export false as 0 in PDO (bug #619)\nMS SQL: Support port with sqlsrv\nEditor: Do not check boolean checkboxes with false in PostgreSQL (bug #607)\n\nAdminer 4.6.2 (released 2018-02-20):\nSemi-transparent border on table actions\nShorten JSON values in select (bug #594)\nSpeed up alter table form (regression from 4.4.0)\nStore current version without authentication and in Editor\nPostgreSQL: Fix exporting string default values\nPostgreSQL: Fix exporting sequences in PostgreSQL 10\nPostgreSQL: Add IF EXISTS to DROP SEQUENCE in export (bug #595)\nEditor: Fix displaying of true boolean values (regression from 4.5.0)\n\nAdminer 4.6.1 (released 2018-02-09):\nSticky position of table actions\nSpeed up rendering of long tables (regression from 4.4.0)\nDisplay notification about performing action after relogin\nAdd system tables help links\nMySQL: Support non-utf8 charset in search in column\nMySQL: Support geometry in MySQL 8 (bug #574)\nMariaDB: Links to documentation\nSQLite: Allow deleting PRIMARY KEY from tables with auto increment\nPostgreSQL: Support binary files in bytea fields\nPostgreSQL: Don't treat interval type as number (bug #474)\nPostgreSQL: Cast to string when searching using LIKE (bug #325)\nPostgreSQL: Fix condition for selecting no rows\nPostgreSQL: Support TRUNCATE+INSERT export\nCustomization: Support connecting to MySQL via SSL\nCustomization: Allow specifying server name displayed in breadcrumbs\n\nAdminer 4.6.0 (released 2018-02-05):\nFix counting selected rows after going back to select page\nPHP <5.3 compatibility even with Elasticsearch enabled\nFully support functions in default values\nStop redirecting links via adminer.org\nSupport X-Forwarded-Prefix\nDisplay options for timestamp columns when creating a new table\nDisable autocompleting password on create user page\nUse primary key to edit rows even if not selected\nMySQL, PostgreSQL: Display warnings\nMySQL: Add floor and ceil select functions\nMySQL: Add FIND_IN_SET search operator\nMariaDB: Support JSON since MariaDB 10.2\nSQLite, PostgreSQL: Limit rows in data manipulation without unique key\nPostgreSQL: Support routines\nPostgreSQL: Allow editing views with uppercase letters (bug #467)\nPostgreSQL: Allow now() as default value (bug #525)\nSimpleDB: Document that allow_url_fopen is required\nMalay translation\n\nAdminer 4.5.0 (released 2018-01-24):\nDisplay name of the object in confirmation when dropping it\nDisplay newlines in column comments (bug #573)\nSupport current_timestamp() as default of time fields (bug #572)\nHide window.opener from pages opened in a new window (bug #561)\nDisplay error when getting row to edit\nStore current Adminer version server-side to avoid excessive requests\nAdminer: Fix Search data in tables (regression from 4.4.0)\nCSP: Allow any styles, images, media and fonts, disallow base-uri\nMySQL: Support geometry in MySQL 8 (bug #574)\nMySQL: Support routines with comments in parameters (bug #460)\nMariaDB: Support fulltext and spatial indexes in InnoDB (bug #583)\nSQLite: Enable foreign key checks\nPostgreSQL: Respect NULL default value\nPostgreSQL: Display foreign tables (bug #576)\nPostgreSQL: Do not export triggers if not requested\nPostgreSQL: Export DROP SEQUENCE if dropping table\nPostgreSQL: Display boolean values as code (bug #562)\nMS SQL: Support freetds\nnon-MySQL: Avoid CONVERT() (bug #509)\nElasticsearch: Insert, update, delete\nMongoDB: Support mongodb PHP extension\nEditor: Fix displaying of false values in PostgreSQL (bug #568)\n\nAdminer 4.4.0 (released 2018-01-17):\nAdd Content Security Policy\nDisallow scripts without nonce\nRate limit password-less login attempts from the same IP address\nDisallow connecting to privileged ports\nAdd nosniff header\nPHP 7.1: Prevent warning when using empty limit\nPHP 7.2: Prevent warning when searching in select\nMySQL: Remove dedicated view for replication status (added in 4.3.0)\nPostgreSQL: Sort table names (regression from 4.3.1)\nEditor: Don't set time zone from PHP, fixes DST\nEditor: Display field comment's text inside [] only in edit form\nEditor: Fix doubleclick on database page\nEditor: Fix Search data in tables\nCustomization: Always send security headers\nHebrew translation\n\nAdminer 4.3.1 (released 2017-04-14):\nFix permanent login after logout (bug #539)\nFix SQL command autofocus (regression from 4.0.0)\nPostgreSQL: Support JSON and JSONB data types\nPostgreSQL: Fix index size computation in PostgreSQL < 9.0 (regression from 4.3.0)\nPostgreSQL: Fix nullable fields in export\n\nAdminer 4.3.0 (released 2017-03-15):\nMake maxlength in edit fields a soft limit\nAdd accessibility labels\nAdd Cache-Control: immutable to static files\nMySQL: Support MySQL 8\nMySQL: Support JSON data type\nMySQL: Add dedicated view for replication status\nMySQL: Support spatial indexes\nPostgreSQL: Export\nPostgreSQL: Don't treat partial indexes as unique\nMS SQL: Support pdo_dblib\nElasticsearch: Support HTTPS by inputting https://server\n\nAdminer 4.2.5 (released 2016-06-01):\nFix remote execution in SQLite query\nSQLite: Require credentials to use\nPostgreSQL: Support KILL\n\nAdminer 4.2.4 (released 2016-02-06):\nFix remote execution in SQLite query\nMySQL: Support PHP 7\nBosnian translation\nFinnish translation\n\nAdminer 4.2.3 (released 2015-11-15):\nFix XSS in indexes (non-MySQL only)\nSupport PHP 7\nGreek translation\nGalician translation\nBulgarian translation\n\nAdminer 4.2.2 (released 2015-08-05):\nFix XSS in alter table (found by HP Fortify)\n\nAdminer 4.2.1 (released 2015-03-10):\nSend referrer header to the same domain\nMySQL: Fix usage of utf8mb4 if the client library doesn't support it\nMySQL: Use utf8mb4 in export only if required\nSQLite: Use EXPLAIN QUERY PLAN in SQL query\n\nAdminer 4.2.0 (released 2015-02-07):\nFix XSS in login form (bug #436)\nAllow limiting number of displayed rows in SQL command\nFix reading routine column collations\nUnlock session in alter database\nMake master key unreadable to others (bug #410)\nFix edit by long non-utf8 string\nSpecify encoding for PHP 5.6 with invalid default_charset\nFix saving NULL value, bug since Adminer 4.0.3\nSend 403 for auth error\nReport offline and other AJAX errors (bug #419)\nDon't alter table comment if not changed\nAdd links to documentation on table status page\nFix handling of 64 bit numbers in auto_increment\nAdd referrer: never meta tag\nMySQL: Use utf8mb4 if available\nMySQL: Support foreign keys in NDB storage\nPostgreSQL: Materialized views\nSQLite: Support CURRENT_* default values (bug #417)\nElasticsearch: Use where in select\nFirebird: Alpha version\nDanish translation\n\nAdminer 4.1.0 (released 2014-04-18):\nProvide size of all databases in the overview\nPrevent against brute force login attempts from the same IP address\nCompute number of tables in the overview explicitly\nDisplay edit form after error in clone or multi-edit\nTrim trailing non-breaking spaces in SQL textarea\nDisplay time of the select command\nPrint elapsed time in HTML instead of SQL command comment\nImprove gzip export ratio (bug #387)\nUse rel=\"noreferrer\" for external links, skip adminer.org redirect in WebKit\nMySQL: Fix enum types in routines (bug #391)\nMySQL: Fix editing rows by binary values, bug since Adminer 3.7.1\nMySQL: Respect daylight saving time in dump, bug since Adminer 3.6.4\nMySQL 5.6.5+: Support ON UPDATE on datatime column\nSQLite: Support UPDATE OF triggers\nSQLite: Display auto-created unique indexes, bug since Adminer 3.5.0\nEditor: Fix login() method, bug since Adminer 4.0.0\nTranslate numbers in ar, bn, fa\nVietnamese translation\n\nAdminer 4.0.3 (released 2014-02-01)\nMongoDB: insert, truncate, indexes\nSimpleDB, MongoDB: insert more fields at once\nSQLite: Fix creating table and altering primary key, bug since Adminer 4.0.0\nDon't store invalid credentials to session, bug since Adminer 4.0.0\nNorweigan translation\n\nAdminer 4.0.2 (released 2014-01-11):\nFix handling of long text in SQL textarea\nSupport paste to SQL textarea in Opera\n\nAdminer 4.0.1 (released 2014-01-11):\nDon't use type=number if a SQL function is used\nDisable highlighting in textareas with long texts\nDon't autofocus SQL textarea in Firefox\nDon't link NULL foreign key values\nFix displaying images in Editor, bug since Adminer 3.6.0\nFix uploading files, bug since Adminer 4.0.0\nMongoDB: Count tables, display ObjectIds, sort, limit, offset, count rows\nElasticsearch: Fix compiled version, create and drop DB, drop table\n\nAdminer 4.0.0 (released 2014-01-08):\nDriver for SimpleDB, MongoDB and Elasticsearch\nHighlight SQL in textareas\nSave and continue edit by AJAX\nSplit SQL command and import\nAdd a new column in alter table on key press\nMark length as required for strings\nAdd label to database selection, move logout button\nAdd button for dropping an index\nDisplay number of selected rows\nAdd links to documentation\nDisable underlining links\nDifferentiate views in navigation\nImprove speed of CSV import\nKeep form values after refresh in Firefox\nMark auto_increment fields in edit\nDon't append newlines to uploaded files, bug since Adminer 3.7.0\nDon't display SQL edit form on Ctrl+click on the select query, introduced in Adminer 3.6.4\nUse MD5 for editing long keys only in supported drivers, bug since Adminer 3.6.4\nDon't reset column when searching for an empty value with Enter, bug since Adminer 3.6.4\nEncrypt passwords stored in session by a key stored in cookie\nDon't execute external JavaScript when verifying version\nInclude JUSH in the compiled version\nProtect CSRF token against BREACH\nNon-MySQL: View triggers\nSQLite: Allow editing primary key\nSQLite: Allow editing foreign keys\nPostgreSQL: Fix handling of nextval() default values\nPostgreSQL: Support creating array columns\nCustomization: Provide schemas()\nPortugal Portuguese translation\nThai translation\n\nAdminer 3.7.1 (released 2013-06-29):\nIncrease click target for checkboxes\nUse shadow for highlighting default button\nDon't use LIMIT 1 if inline updating unique row\nDon't check previous checkbox on added column in create table (bug #326)\nOrder table list by name\nVerify UTF-8 encoding of CSV import\nNotify user about expired master password for permanent login\nHighlight table being altered in navigation\nSend 404 for invalid database and schema\nFix title and links on invalid table pages\nDisplay error on invalid alter table and view pages\nMySQL: Speed up updating rows without numeric or UTF-8 primary key\nNon-MySQL: Descending indexes\nPostgreSQL: Fix detecting oid column in PDO\nPostgreSQL: Handle timestamp types (bug #324)\nAdd Korean translation\n\nAdminer 3.7.0 (released 2013-05-19):\nAllow more SQL files to be uploaded at the same time\nPrint run time next to executed queries\nDon't drop original view and routine before creating the new one\nHighlight default submit button\nAdd server placeholder to login form\nDisable SQL export when applying functions in select\nAllow using lang() in plugins (customization)\nRemove bzip2 compression support\nConstraint memory used in TAR export\nAllow exporting views dependent on each other (bug #214)\nFix resetting search (bug #318)\nDon't use LIMIT 1 if updating unique row (bug #320)\nRestrict editing rows without unique identifier to search results\nDisplay navigation bellow main content on mobile browsers\nGet number of rows on export page asynchronously\nRespect 'whole result' even if some rows are checked (bug #339 since Adminer 3.7.0)\nMySQL: Optimize create table page and Editor navigation\nMySQL: Display bit type as binary number\nMySQL: Improve export of binary data types\nMySQL: Fix handling of POINT data type (bug #282)\nMySQL: Don't export binary and geometry columns twice in select\nMySQL: Fix EXPLAIN in MySQL < 5.1, bug since Adminer 3.6.4\nSQLite: Export views\nPostgreSQL: Fix swapped NULL and NOT NULL columns in PDO\n\nAdminer 3.6.4 (released 2013-04-26):\nDisplay pagination on a fixed position\nIncrease default select limit to 50\nDisplay SQL edit form on Ctrl+click on the select query\nDisplay SQL history from newest\nRecover original view, trigger, routine if creating fails\nDo not store plain text password to history in creating user\nSelectable ON UPDATE CURRENT_TIMESTAMP field in create table\nOpen database to a new window after selecting it with Ctrl\nClear column name after resetting search (bug #296)\nExplain partitions in SQL query (bug #294)\nAllow loading more data with inline edit (bug #299)\nStay on the same page after deleting rows (bug #301)\nRespect checked tables in export filename (bug #133)\nRespect PHP configuration max_input_vars\nFix unsetting permanent login after logout\nDisable autocapitalize in identifiers on mobile browsers\nMySQL: Compatibility with MySQL 5.6\nMySQL: Move ALTER export to plugin\nMySQL: Use numeric time zone in export\nMySQL: Link processlist documentation\nSQLite: Export indexes\n\nAdminer 3.6.3 (released 2013-01-23):\nDisplay error code in SQL query\nAllow specifying external links\nTreat Meta key same as Ctrl\nFix XSS in displaying non-UTF-8 strings\nDon't use type=\"number\" for decimal numbers\n\nAdminer 3.6.2 (released 2012-12-21):\nEdit values by Ctrl+click instead of double click\nDon't select row on double click\nSupport NULL in routine calls\nShorten printed values in varchar fields\nDisplay table default values on wide screens\nDisplay date in SQL history\nHTML5 input fields\nDisplay warning for missing UPDATE privilege\nFix switching language on first load\nSupport enabled mbstring.func_overload\nMySQL: Prolong comment length since MySQL 5.5\nPostgreSQL: Fix process list in version 9.2\nMS SQL: Support databases starting with number\n\nAdminer 3.6.1 (released 2012-09-17):\nFix compiled version on PHP with multibyte support\n\nAdminer 3.6.0 (released 2012-09-16):\nLoad more data in select\nEdit strings with \\n in textarea\nTime out long running database list and select count\nUse VALUES() in INSERT+UPDATE export\nStyle logout button as link\nStore selected database to permanent login\nCtrl+click and Shift+click on button opens form to a blank window\nSwitch language by POST\nCompress translations\nMySQL: Support geometry data types\nselectQueryBuild() method (customization)\nSerbian translation\n\nAdminer 3.5.1 (released 2012-08-10):\nSupport same name fields in CSV export\nSupport Shift+click in export\n\nAdminer 3.5.0 (released 2012-08-05):\nLinks for column search in select\nAutohide column context menu in select\nAutodisplay long table names in tables list\nDisplay assigned auto_increment after clone\nSQLite: Full alter table\nSQLite: Better editing in tables without primary key\nSQLite: Display number of rows in database overview\n\nAdminer 3.4.0 (released 2012-06-30):\nLink to descending order\nShift+click on checkbox to select consecutive rows\nPrint current time next to executed SQL queries\nWarn about selecting data without index\nAllow specifying database in login form\nLink to original table in EXPLAIN of SELECT * FROM table t\nFormat numbers in translations\nMySQL: inform about disabled event_scheduler\nSQLite: support binary data\nPostgreSQL: approximate row count in table overview\nPostgreSQL: improve PDO support in SQL command\nOracle: schema, processlist, table overview numbers\nSimplify work with NULL values (customization)\nUse namespace in login form (customization)\nCustomizable export filename (customization)\nReplace JSMin by better JavaScript minifier\nDon't use AJAX links and forms\nIndonesian translation\nUkrainian translation\nBengali translation\n\nAdminer 3.3.4 (released 2012-03-07):\nForeign keys default actions (bug #188)\nSET DEFAULT foreign key action\nFix minor parser bug in SQL command with webserver file\nCtrl+click on button opens form to a blank window\nTrim table and column names (bug #195)\nError message with no response from server in AJAX\nEsc to cancel AJAX request\nMove AJAX loading indicator to the right\nDon't quote bit type in export\nDon't check row while selecting text\nFix invalid references line position on Database schema\nDisable selecting text on Database schema\nAbility to disable export (customization)\nExtensible list of databases (customization)\nMySQL: set autocommit after connect\nSQLite, PostgreSQL: vacuum\nSQLite, PostgreSQL: don't use LIKE for numbers (bug #202)\nPostgreSQL: fix alter foreign key\nPostgreSQL over PDO: connect if the eponymous database does not exist (bug #185)\nBoolean search (Editor)\nPersian translation\n\nAdminer 3.3.3 (released 2011-08-12):\nHighlight checked rows\nTitles of links in database overview and navigation\nFix trigger export (SQLite)\nDefault trigger statement (SQLite, PostgreSQL)\nRemove search by expression (PostgreSQL, MS SQL)\n\nAdminer 3.3.2 (released 2011-08-08):\nDisplay error with non-existent row in edit\nFix minor parser bug in SQL command with webserver file\nFix SQL command Stop on error\nDon't scroll with AJAX select order and alter move column\nFast number of rows with big tables (PostgreSQL)\nSort databases and schemas (PostgreSQL)\n\nAdminer 3.3.1 (released 2011-07-27):\nFix XSS introduced in Adminer 3.2.0\nFix altering default values (PostgreSQL)\nProcess list (PostgreSQL)\n\nAdminer 3.3.0 (released 2011-07-19):\nUse Esc to disable in-place edit\nShortcut for database privileges\nEditable index names\nAppend new index with auto index selection (bug #138)\nPreserve original timestamp value in multiple update (bug #158)\nBit type default value\nDisplay foreign key name in tooltip\nDisplay default column value in table overview\nDisplay column collation in tooltip\nKeyboard shortcuts: Alt+Shift+1 for homepage, Ctrl+Shift+Enter for Save and continue edit\nShow only errors with Webserver file SQL command\nRemember select export and import options\nLink tables and indexes from SQL command EXPLAIN (MySQL)\nDisplay error with all wrong SQL commands (MySQL)\nDisplay foreign keys from other schemas (PostgreSQL)\nPagination support (Oracle)\nAutocomplete for big foreign keys (Editor)\nDisplay name of the referenced record in PostgreSQL (Editor)\nPrefer NULL to empty string (Editor, bug #162)\nDisplay searched columns (Editor)\nCustomizable favicon (customization)\nMethod name can return a link (customization)\nEasier sending of default headers (customization)\nLithuanian and Romanian translation\n\nAdminer 3.2.2 (released 2011-03-28):\nFix AJAX history after reload\n\nAdminer 3.2.1 (released 2011-03-23):\nAbility to save expression in edit\nRespect default database collation (bug #119)\nDon't export triggers without table (bug #123)\nEsc to focus next field in Tab textarea\nSend forms by Ctrl+Enter on <select>\nEnum editor and textarea Ctrl+Enter working in IE\nAJAX forms in Google Chrome\nParse UTF-16 and UTF-8 BOM in all text uploads\nDisplay ; in history\nUse DELIMITER in history\nShow databases even with skip_show_database in MySQL 5\nDisable maxlength with functions in edit\nBetter placement of AJAX icon\nTable header in CSV export (Editor)\nTime format hint (Editor)\nRespect order after search (Editor)\nSet MySQL time zone by PHP setting (Editor)\nAllow own code in <head> (customization)\nPolish translation\n\nAdminer 3.2.0 (released 2011-02-24):\nGet long texts and slow information by AJAX\nMost links and forms by AJAX in browsers with support for history.pushState\nCopy tables\nAbility to search by expression in select\nExport SQL command result (bug #99)\nFocus first field with insert (bug #106)\nPermanent link in schema\nDisplay total time in show only errors mode in SQL command\nHistory: edit all\nMS SQL: auto primary and foreign key\nSQLite: display 0\nCreate table default data type: int\nFocus upper/lower fields by Ctrl+Up/Ctrl+Down\nHide credentials for SQLite\nUtilize oids in PostgreSQL\nHomepage customization\nUse IN for search in numeric fields (Editor)\nUse password input for _md5 and _sha1 fields (Editor)\nWork without session.use_cookies (bug #107)\nFix saving schema to cookie in Opera\nPortuguese, Slovenian and Turkish translation\n\nAdminer 3.1.0 (released 2010-11-16):\nTSV export and import\nCustomizable export\nOption to show only errors in SQL command\nLink to bookmark SQL command\nRecognize $$ strings in SQL command (PostgreSQL)\nHighlight and edit SQL command in processlist\nAlways display all drivers\nTimestamp at the end of export\nLink to refresh database cache (bug #96)\nSupport for virtual foreign keys\nDisable XSS \"protection\" of IE8\nImmunity against zend.ze1_compatibility_mode (bug #86)\nFix last page with empty result set\nArabic translation and RTL support\nDual licensing: Apache or GPL\n\nAdminer 3.0.1 (released 2010-10-18):\nSend the form by Ctrl+Enter in all textareas\nDisable creating SQLite databases with extension other than db, sdb, sqlite\nAbility to use Adminer in a frame through customization\nCatalan translation\nMS SQL 2005 compatibility\nPostgreSQL: connect if the eponymous database does not exist\n\nAdminer 3.0.0 (released 2010-10-15):\nDrivers for MS SQL, SQLite, PostgreSQL, Oracle\nAllow concurrent logins on the same server\nAllow permanent login without customization\nIn-place editation in select\nForeign key options in Table creation\nTreat binary type as hex\nShow number of tables in server overview\nOperator LIKE %%\nRemember export parameters in cookie\nAllow semicolon as CSV separator\nSchemas, sequences and types support (PostgreSQL)\nAutofocus username in login form\nAllow to insert Tab in SQL textareas and send the form by Ctrl+Enter\nDisable spellchecking in SQL textareas\nDisplay auto_increment value of inserted item\nAllow disabling auto_increment value export\nPrefill auto_increment column name\nAbility to jump to any page in select by JavaScript\nDisplay comment in table overview\nLink last page above data in select\nLink table names in SQL queries\nHungarian, Japanese and Tamil translation\nDefer table information in database overview to JavaScript (performance)\nBig tables optimizations (performance)\n\nAdminer 2.3.2 (released 2010-04-21):\nFix COUNT(*) link\nFix Save and continue edit\n\nAdminer 2.3.1 (released 2010-04-06):\nAdd Drop button to Alter pages (regression from 2.0.0)\nLink COUNT(*) result to listing\nNewlines in select query edit\nReturn to referrer after edit\nRespect session.auto_start (bug #42)\n\nAdminer 2.3.0 (released 2010-02-26):\nSupport for permanent login (customization required)\nSearch in all tables\nShow status variables\nPrint sums in tables overview\nAdd Delete button to Edit page (regression from 2.0.0)\nPrint error summary in SQL command\nSimplify SQL syntax error message\nShow SQL query info if available\nDelete length when changing type in alter table\nAbility to check table prefix in export\n\nAdminer 2.2.1 (released 2009-11-26):\nHighlight current links\nImprove concurrency\nMove number of tables to DB info (performance)\nSearch by foreign keys (Editor)\nLink new item in backward keys (Editor)\n\nAdminer 2.2.0 (released 2009-10-20):\nDatabase list - bulk drop, number of tables\nEnlarge field for enum and set definition\nDisplay table links above table structure\nLink URLs in select\nDisplay number of manipulated rows in JS confirm\nSet required memory in SQL command\nFix removed default in ALTER\nDisplay whitespace in texts (bug #11)\nClickJacking protection in modern browsers\nE-mail attachments (Editor)\nOptional year in date (Editor)\nSearch operators (Editor)\nAlign numbers to right in select (Editor)\nMove <h1> to $adminer->navigation (customization)\nRename get_dbh to connection (customization)\n\nAdminer 2.1.0 (released 2009-09-12):\nEdit default values directly in table creation\nExecute SQL file stored on server disk\nDisplay EXPLAIN in SQL query\nCompress export and import\nDisplay column comments in table overview\nUse ON DUPLICATE KEY UPDATE for CSV import\nPrint ALTER export instead of executing it\nClick on row selects it\nFix Editor date format\nFix long SQL query crash (bug #3)\nSpeed up simple alter table\nTraditional Chinese translation\n\nAdminer 2.0.0 (released 2009-08-06):\nEditor: User friendly data editor\nCustomization: Adminer class\nCreate single column foreign key in table structure\nTable relations (Editor)\nSend e-mails (Editor)\nDisplay images in blob (Editor)\nLocalize date (Editor)\nTreat tinyint(1) as bool (Editor)\nDivide types to groups in table creation\nLink e-mails in select\nShow type in field name title\nPreselect now() for timestamp columns\nClear history\nPrefill insert by foreign key searches\nPrint number of rows in SQL command\nRemove Delete button from Edit page - use mass operation for it\nFaster multiple update, clone and delete\nFaster table list in navigation\nDownload version checker and syntax highlighting from HTTPS\nUse HTML Strict instead of XHTML\nRemove function minification in favor of performance and customization\nFix grant ALL PRIVILEGES with GRANT OPTION\nFix CSV import\nFix work with default values\n\nAdminer 1.11.1 (released 2009-07-03):\nFix problem with enabled Filter extension\n\nAdminer 1.11.0 (released 2009-07-02):\nConnection through socket by server :/path/to/socket\nSimplify export\nDisplay execution time in SQL query\nRelative date and time functions\nVersion checker\nSave queries to history and display it on SQL page\nDisplay MySQL variables\nAbility to select all rows on current page of select\nSeparate JavaScript functions\nAlways use the default style before the external one\nAlways try to use the syntax highlighter\nAll privileges in user rights\nFix FOUND_ROWS() in SQL command\nExport only selected columns in select\nBulk database creation\nInclude views in drop and move on database overview\nHide fieldsets in select\nAutomatically add new fields in table creation\nUse \\n in SQL commands\n\nphpMinAdmin 1.10.1 (released 2009-05-07):\nHighlight odd and hover rows\nPartition editing comfort (bug #12)\nAllow full length in limited int\n\nphpMinAdmin 1.10.0 (released 2009-04-28):\nPartitioning (MySQL 5.1)\nCSV import\nPlus and minus functions\nOption to stop on error in SQL command\nCross links to select and table (bug #2236232), link new item\nSuhosin compatibility\nRemove max_allowed_packet from export\nRead style from phpMinAdmin.css if exists\nSize reduction by minification of variables and functions\nRussian translation\n\nphpMinAdmin 1.9.1 (released 2008-10-27):\nUpdate translations\n\nphpMinAdmin 1.9.0 (released 2008-10-16):\nList of tables and views with maintenance commands\nClone rows\nBulk edit and clone\nFunction results in edit\nNOT operators in select\nSearch without column restriction\nUse type=password for unhashed password\nOnly one button for each action in select\nChoose language through option-list\nXHTML syntax errors\nDon't set global variable in export\nSHOW DATABASES can be revoked\nOrder by function result working also in older MySQL versions\nTested on IIS\n\nphpMinAdmin 1.8.0 (released 2008-09-12):\nEvents (MySQL 5.1)\nAccess without login - accept ?username=\nPrint SQL query in select, messages and warnings\nDisplay number of found rows\nDon't wrap lines in select table\nItalian and Estonian translation\nOrder by COUNT(*)\n\nphpMinAdmin 1.7.0 (released 2008-08-26):\nCustomizable export (select objects to export, SQL or CSV)\nAbility to alter existing tables and drop old tables in export\nChoose columns in select, aggregation\nOrder rows by clicking on table heading\nTruncate only search results\nAutomatically select name for trigger\nChinese and French translation\nPreserve default values when altering table\nMaintain auto_increment when moving columns\nSmaller multilingual file\nCache static files\nFaster checking of number of results\n\nphpMinAdmin 1.6.1 (released 2008-05-22):\nSet session parameters only if not session.auto_start\n\nphpMinAdmin 1.6.0 (released 2008-05-16):\nOrder of columns in table\nSet max_allowed_packet in dump and use extended insert\nSpanish and German translations\nUse images for editing buttons\nProtection against big POST data\nLogout by POST\nInformation about logged user\nSeparate stylesheet\nLast-Modified header for files\nSeveral bug fixes\n\nphpMinAdmin 1.5.0 (released 2008-01-09):\nMass delete\nVertical privileges\nSpecify connection port by colon in server\nIgnore length in date and time types\nBoolean fulltext search for all columns in MyISAM\nShrink compiled output\nRemove maxlength from server and username\nUncheck NULL by change\nMark shortened fields in select\n\nphpMinAdmin 1.4.0 (released 2007-08-15):\nPrivileges\nNew design\nDutch translation\nUse NULL for auto_increment (bug #1)\nFix dropping procedure parameters\n\nphpMinAdmin 1.3.2 (released 2007-08-06):\nNext field by JavaScript in foreign keys\nSet time zone in dump\nRefresh lang cookie\nRemember drop result in case of faulty create\nMove vertical lines in schema properly\nFix maximum page in select\n\nphpMinAdmin 1.3.1 (released 2007-07-31):\nMove references lines in schema\nFix dump\nFix update links\n\nphpMinAdmin 1.3.0 (released 2007-07-27):\nBreadcrumb navigation\nOperator IN\nTimestamp default values\nDraggable tables in schema\nNumber of rows in navigation\nDisplay MySQL version and used PHP extension\nMore friendly user interface\nSlovak translation\n\nphpMinAdmin 1.2.0 (released 2007-07-25):\nManipulate triggers\nPDO Abstraction\nAuto_increment value\nJavaScript for adding rows\n\nphpMinAdmin 1.1.0 (released 2007-07-19):\nRoutines manipulation\nViews manipulation\nForeign keys manipulation\nDatabase schema with references\nProcesslist\nIndex length\nDump individual tables\nJavaScript for next rows in table edit\nCache databases list\n\nphpMinAdmin 1.0.0 (released 2007-07-11):\nFirst official release\n"], "fixing_code": ["<?php\n/** Print select result\n* @param Min_Result\n* @param Min_DB connection to examine indexes\n* @param array\n* @param int\n* @return array $orgtables\n*/\nfunction select($result, $connection2 = null, $orgtables = array(), $limit = 0) {\n\tglobal $jush;\n\t$links = array(); // colno => orgtable - create links from these columns\n\t$indexes = array(); // orgtable => array(column => colno) - primary keys\n\t$columns = array(); // orgtable => array(column => ) - not selected columns in primary key\n\t$blobs = array(); // colno => bool - display bytes for blobs\n\t$types = array(); // colno => type - display char in <code>\n\t$return = array(); // table => orgtable - mapping to use in EXPLAIN\n\todd(''); // reset odd for each result\n\tfor ($i=0; (!$limit || $i < $limit) && ($row = $result->fetch_row()); $i++) {\n\t\tif (!$i) {\n\t\t\techo \"<div class='scrollable'>\\n\";\n\t\t\techo \"<table cellspacing='0' class='nowrap'>\\n\";\n\t\t\techo \"<thead><tr>\";\n\t\t\tfor ($j=0; $j < count($row); $j++) {\n\t\t\t\t$field = $result->fetch_field();\n\t\t\t\t$name = $field->name;\n\t\t\t\t$orgtable = $field->orgtable;\n\t\t\t\t$orgname = $field->orgname;\n\t\t\t\t$return[$field->table] = $orgtable;\n\t\t\t\tif ($orgtables && $jush == \"sql\") { // MySQL EXPLAIN\n\t\t\t\t\t$links[$j] = ($name == \"table\" ? \"table=\" : ($name == \"possible_keys\" ? \"indexes=\" : null));\n\t\t\t\t} elseif ($orgtable != \"\") {\n\t\t\t\t\tif (!isset($indexes[$orgtable])) {\n\t\t\t\t\t\t// find primary key in each table\n\t\t\t\t\t\t$indexes[$orgtable] = array();\n\t\t\t\t\t\tforeach (indexes($orgtable, $connection2) as $index) {\n\t\t\t\t\t\t\tif ($index[\"type\"] == \"PRIMARY\") {\n\t\t\t\t\t\t\t\t$indexes[$orgtable] = array_flip($index[\"columns\"]);\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t$columns[$orgtable] = $indexes[$orgtable];\n\t\t\t\t\t}\n\t\t\t\t\tif (isset($columns[$orgtable][$orgname])) {\n\t\t\t\t\t\tunset($columns[$orgtable][$orgname]);\n\t\t\t\t\t\t$indexes[$orgtable][$orgname] = $j;\n\t\t\t\t\t\t$links[$j] = $orgtable;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif ($field->charsetnr == 63) { // 63 - binary\n\t\t\t\t\t$blobs[$j] = true;\n\t\t\t\t}\n\t\t\t\t$types[$j] = $field->type;\n\t\t\t\techo \"<th\" . ($orgtable != \"\" || $field->name != $orgname ? \" title='\" . h(($orgtable != \"\" ? \"$orgtable.\" : \"\") . $orgname) . \"'\" : \"\") . \">\" . h($name)\n\t\t\t\t\t. ($orgtables ? doc_link(array(\n\t\t\t\t\t\t'sql' => \"explain-output.html#explain_\" . strtolower($name),\n\t\t\t\t\t\t'mariadb' => \"explain/#the-columns-in-explain-select\",\n\t\t\t\t\t)) : \"\")\n\t\t\t\t;\n\t\t\t}\n\t\t\techo \"</thead>\\n\";\n\t\t}\n\t\techo \"<tr\" . odd() . \">\";\n\t\tforeach ($row as $key => $val) {\n\t\t\t$link = \"\";\n\t\t\tif (isset($links[$key]) && !$columns[$links[$key]]) {\n\t\t\t\tif ($orgtables && $jush == \"sql\") { // MySQL EXPLAIN\n\t\t\t\t\t$table = $row[array_search(\"table=\", $links)];\n\t\t\t\t\t$link = ME . $links[$key] . urlencode($orgtables[$table] != \"\" ? $orgtables[$table] : $table);\n\t\t\t\t} else {\n\t\t\t\t\t$link = ME . \"edit=\" . urlencode($links[$key]);\n\t\t\t\t\tforeach ($indexes[$links[$key]] as $col => $j) {\n\t\t\t\t\t\t$link .= \"&where\" . urlencode(\"[\" . bracket_escape($col) . \"]\") . \"=\" . urlencode($row[$j]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} elseif (is_url($val)) {\n\t\t\t\t$link = $val;\n\t\t\t}\n\t\t\tif ($val === null) {\n\t\t\t\t$val = \"<i>NULL</i>\";\n\t\t\t} elseif ($blobs[$key] && !is_utf8($val)) {\n\t\t\t\t$val = \"<i>\" . lang('%d byte(s)', strlen($val)) . \"</i>\"; //! link to download\n\t\t\t} else {\n\t\t\t\t$val = h($val);\n\t\t\t\tif ($types[$key] == 254) { // 254 - char\n\t\t\t\t\t$val = \"<code>$val</code>\";\n\t\t\t\t}\n\t\t\t}\n\t\t\tif ($link) {\n\t\t\t\t$val = \"<a href='\" . h($link) . \"'\" . (is_url($link) ? target_blank() : '') . \">$val</a>\";\n\t\t\t}\n\t\t\techo \"<td>$val\";\n\t\t}\n\t}\n\techo ($i ? \"</table>\\n</div>\" : \"<p class='message'>\" . lang('No rows.')) . \"\\n\";\n\treturn $return;\n}\n\n/** Get referencable tables with single column primary key except self\n* @param string\n* @return array ($table_name => $field)\n*/\nfunction referencable_primary($self) {\n\t$return = array(); // table_name => field\n\tforeach (table_status('', true) as $table_name => $table) {\n\t\tif ($table_name != $self && fk_support($table)) {\n\t\t\tforeach (fields($table_name) as $field) {\n\t\t\t\tif ($field[\"primary\"]) {\n\t\t\t\t\tif ($return[$table_name]) { // multi column primary key\n\t\t\t\t\t\tunset($return[$table_name]);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\t$return[$table_name] = $field;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn $return;\n}\n\n/** Get settings stored in a cookie\n* @return array\n*/\nfunction adminer_settings() {\n\tparse_str($_COOKIE[\"adminer_settings\"], $settings);\n\treturn $settings;\n}\n\n/** Get setting stored in a cookie\n* @param string\n* @return array\n*/\nfunction adminer_setting($key) {\n\t$settings = adminer_settings();\n\treturn $settings[$key];\n}\n\n/** Store settings to a cookie\n* @param array\n* @return bool\n*/\nfunction set_adminer_settings($settings) {\n\treturn cookie(\"adminer_settings\", http_build_query($settings + adminer_settings()));\n}\n\n/** Print SQL <textarea> tag\n* @param string\n* @param string or array in which case [0] of every element is used\n* @param int\n* @param int\n* @return null\n*/\nfunction textarea($name, $value, $rows = 10, $cols = 80) {\n\tglobal $jush;\n\techo \"<textarea name='$name' rows='$rows' cols='$cols' class='sqlarea jush-$jush' spellcheck='false' wrap='off'>\";\n\tif (is_array($value)) {\n\t\tforeach ($value as $val) { // not implode() to save memory\n\t\t\techo h($val[0]) . \"\\n\\n\\n\"; // $val == array($query, $time, $elapsed)\n\t\t}\n\t} else {\n\t\techo h($value);\n\t}\n\techo \"</textarea>\";\n}\n\n/** Print table columns for type edit\n* @param string\n* @param array\n* @param array\n* @param array returned by referencable_primary()\n* @param array extra types to prepend\n* @return null\n*/\nfunction edit_type($key, $field, $collations, $foreign_keys = array(), $extra_types = array()) {\n\tglobal $structured_types, $types, $unsigned, $on_actions;\n\t$type = $field[\"type\"];\n\t?>\n<td><select name=\"<?php echo h($key); ?>[type]\" class=\"type\" aria-labelledby=\"label-type\"><?php\nif ($type && !isset($types[$type]) && !isset($foreign_keys[$type]) && !in_array($type, $extra_types)) {\n\t$extra_types[] = $type;\n}\nif ($foreign_keys) {\n\t$structured_types[lang('Foreign keys')] = $foreign_keys;\n}\necho optionlist(array_merge($extra_types, $structured_types), $type);\n?></select><td><input name=\"<?php echo h($key); ?>[length]\" value=\"<?php echo h($field[\"length\"]); ?>\" size=\"3\"<?php echo (!$field[\"length\"] && preg_match('~var(char|binary)$~', $type) ? \" class='required'\" : \"\"); //! type=\"number\" with enabled JavaScript ?> aria-labelledby=\"label-length\"><td class=\"options\"><?php\n\techo \"<select name='\" . h($key) . \"[collation]'\" . (preg_match('~(char|text|enum|set)$~', $type) ? \"\" : \" class='hidden'\") . '><option value=\"\">(' . lang('collation') . ')' . optionlist($collations, $field[\"collation\"]) . '</select>';\n\techo ($unsigned ? \"<select name='\" . h($key) . \"[unsigned]'\" . (!$type || preg_match(number_type(), $type) ? \"\" : \" class='hidden'\") . '><option>' . optionlist($unsigned, $field[\"unsigned\"]) . '</select>' : '');\n\techo (isset($field['on_update']) ? \"<select name='\" . h($key) . \"[on_update]'\" . (preg_match('~timestamp|datetime~', $type) ? \"\" : \" class='hidden'\") . '>' . optionlist(array(\"\" => \"(\" . lang('ON UPDATE') . \")\", \"CURRENT_TIMESTAMP\"), (preg_match('~^CURRENT_TIMESTAMP~i', $field[\"on_update\"]) ? \"CURRENT_TIMESTAMP\" : $field[\"on_update\"])) . '</select>' : '');\n\techo ($foreign_keys ? \"<select name='\" . h($key) . \"[on_delete]'\" . (preg_match(\"~`~\", $type) ? \"\" : \" class='hidden'\") . \"><option value=''>(\" . lang('ON DELETE') . \")\" . optionlist(explode(\"|\", $on_actions), $field[\"on_delete\"]) . \"</select> \" : \" \"); // space for IE\n}\n\n/** Filter length value including enums\n* @param string\n* @return string\n*/\nfunction process_length($length) {\n\tglobal $enum_length;\n\treturn (preg_match(\"~^\\\\s*\\\\(?\\\\s*$enum_length(?:\\\\s*,\\\\s*$enum_length)*+\\\\s*\\\\)?\\\\s*\\$~\", $length) && preg_match_all(\"~$enum_length~\", $length, $matches)\n\t\t? \"(\" . implode(\",\", $matches[0]) . \")\"\n\t\t: preg_replace('~^[0-9].*~', '(\\0)', preg_replace('~[^-0-9,+()[\\]]~', '', $length))\n\t);\n}\n\n/** Create SQL string from field type\n* @param array\n* @param string\n* @return string\n*/\nfunction process_type($field, $collate = \"COLLATE\") {\n\tglobal $unsigned;\n\treturn \" $field[type]\"\n\t\t. process_length($field[\"length\"])\n\t\t. (preg_match(number_type(), $field[\"type\"]) && in_array($field[\"unsigned\"], $unsigned) ? \" $field[unsigned]\" : \"\")\n\t\t. (preg_match('~char|text|enum|set~', $field[\"type\"]) && $field[\"collation\"] ? \" $collate \" . q($field[\"collation\"]) : \"\")\n\t;\n}\n\n/** Create SQL string from field\n* @param array basic field information\n* @param array information about field type\n* @return array array(\"field\", \"type\", \"NULL\", \"DEFAULT\", \"ON UPDATE\", \"COMMENT\", \"AUTO_INCREMENT\")\n*/\nfunction process_field($field, $type_field) {\n\treturn array(\n\t\tidf_escape(trim($field[\"field\"])),\n\t\tprocess_type($type_field),\n\t\t($field[\"null\"] ? \" NULL\" : \" NOT NULL\"), // NULL for timestamp\n\t\tdefault_value($field),\n\t\t(preg_match('~timestamp|datetime~', $field[\"type\"]) && $field[\"on_update\"] ? \" ON UPDATE $field[on_update]\" : \"\"),\n\t\t(support(\"comment\") && $field[\"comment\"] != \"\" ? \" COMMENT \" . q($field[\"comment\"]) : \"\"),\n\t\t($field[\"auto_increment\"] ? auto_increment() : null),\n\t);\n}\n\n/** Get default value clause\n* @param array\n* @return string\n*/\nfunction default_value($field) {\n\t$default = $field[\"default\"];\n\treturn ($default === null ? \"\" : \" DEFAULT \" . (preg_match('~char|binary|text|enum|set~', $field[\"type\"]) || preg_match('~^(?![a-z])~i', $default) ? q($default) : $default));\n}\n\n/** Get type class to use in CSS\n* @param string\n* @return string class=''\n*/\nfunction type_class($type) {\n\tforeach (array(\n\t\t'char' => 'text',\n\t\t'date' => 'time|year',\n\t\t'binary' => 'blob',\n\t\t'enum' => 'set',\n\t) as $key => $val) {\n\t\tif (preg_match(\"~$key|$val~\", $type)) {\n\t\t\treturn \" class='$key'\";\n\t\t}\n\t}\n}\n\n/** Print table interior for fields editing\n* @param array\n* @param array\n* @param string TABLE or PROCEDURE\n* @param array returned by referencable_primary()\n* @return null\n*/\nfunction edit_fields($fields, $collations, $type = \"TABLE\", $foreign_keys = array()) {\n\tglobal $inout;\n\t$fields = array_values($fields);\n\t$default_class = (($_POST ? $_POST[\"defaults\"] : adminer_setting(\"defaults\")) ? \"\" : \" class='hidden'\");\n\t$comment_class = (($_POST ? $_POST[\"comments\"] : adminer_setting(\"comments\")) ? \"\" : \" class='hidden'\");\n\t?>\n<thead><tr>\n<?php if ($type == \"PROCEDURE\") { ?><td><?php } ?>\n<th id=\"label-name\"><?php echo ($type == \"TABLE\" ? lang('Column name') : lang('Parameter name')); ?>\n<td id=\"label-type\"><?php echo lang('Type'); ?><textarea id=\"enum-edit\" rows=\"4\" cols=\"12\" wrap=\"off\" style=\"display: none;\"></textarea><?php echo script(\"qs('#enum-edit').onblur = editingLengthBlur;\"); ?>\n<td id=\"label-length\"><?php echo lang('Length'); ?>\n<td><?php echo lang('Options'); /* no label required, options have their own label */ ?>\n<?php if ($type == \"TABLE\") { ?>\n<td id=\"label-null\">NULL\n<td><input type=\"radio\" name=\"auto_increment_col\" value=\"\"><acronym id=\"label-ai\" title=\"<?php echo lang('Auto Increment'); ?>\">AI</acronym><?php echo doc_link(array(\n\t'sql' => \"example-auto-increment.html\",\n\t'mariadb' => \"auto_increment/\",\n\t'sqlite' => \"autoinc.html\",\n\t'pgsql' => \"datatype.html#DATATYPE-SERIAL\",\n\t'mssql' => \"ms186775.aspx\",\n)); ?>\n<td id=\"label-default\"<?php echo $default_class; ?>><?php echo lang('Default value'); ?>\n<?php echo (support(\"comment\") ? \"<td id='label-comment'$comment_class>\" . lang('Comment') : \"\"); ?>\n<?php } ?>\n<td><?php echo \"<input type='image' class='icon' name='add[\" . (support(\"move_col\") ? 0 : count($fields)) . \"]' src='../adminer/static/plus.gif' alt='+' title='\" . lang('Add next') . \"'>\" . script(\"row_count = \" . count($fields) . \";\"); ?>\n</thead>\n<tbody>\n<?php\n\techo script(\"mixin(qsl('tbody'), {onclick: editingClick, onkeydown: editingKeydown, oninput: editingInput});\");\n\tforeach ($fields as $i => $field) {\n\t\t$i++;\n\t\t$orig = $field[($_POST ? \"orig\" : \"field\")];\n\t\t$display = (isset($_POST[\"add\"][$i-1]) || (isset($field[\"field\"]) && !$_POST[\"drop_col\"][$i])) && (support(\"drop_col\") || $orig == \"\");\n\t\t?>\n<tr<?php echo ($display ? \"\" : \" style='display: none;'\"); ?>>\n<?php echo ($type == \"PROCEDURE\" ? \"<td>\" . html_select(\"fields[$i][inout]\", explode(\"|\", $inout), $field[\"inout\"]) : \"\"); ?>\n<th><?php if ($display) { ?><input name=\"fields[<?php echo $i; ?>][field]\" value=\"<?php echo h($field[\"field\"]); ?>\" data-maxlength=\"64\" autocapitalize=\"off\" aria-labelledby=\"label-name\"><?php } ?>\n<input type=\"hidden\" name=\"fields[<?php echo $i; ?>][orig]\" value=\"<?php echo h($orig); ?>\"><?php edit_type(\"fields[$i]\", $field, $collations, $foreign_keys); ?>\n<?php if ($type == \"TABLE\") { ?>\n<td><?php echo checkbox(\"fields[$i][null]\", 1, $field[\"null\"], \"\", \"\", \"block\", \"label-null\"); ?>\n<td><label class=\"block\"><input type=\"radio\" name=\"auto_increment_col\" value=\"<?php echo $i; ?>\"<?php if ($field[\"auto_increment\"]) { ?> checked<?php } ?> aria-labelledby=\"label-ai\"></label><td<?php echo $default_class; ?>><?php\n\t\t\techo checkbox(\"fields[$i][has_default]\", 1, $field[\"has_default\"], \"\", \"\", \"\", \"label-default\"); ?><input name=\"fields[<?php echo $i; ?>][default]\" value=\"<?php echo h($field[\"default\"]); ?>\" aria-labelledby=\"label-default\"><?php\n\t\t\techo (support(\"comment\") ? \"<td$comment_class><input name='fields[$i][comment]' value='\" . h($field[\"comment\"]) . \"' data-maxlength='\" . (min_version(5.5) ? 1024 : 255) . \"' aria-labelledby='label-comment'>\" : \"\");\n\t\t}\n\t\techo \"<td>\";\n\t\techo (support(\"move_col\") ?\n\t\t\t\"<input type='image' class='icon' name='add[$i]' src='../adminer/static/plus.gif' alt='+' title='\" . lang('Add next') . \"'> \"\n\t\t\t. \"<input type='image' class='icon' name='up[$i]' src='../adminer/static/up.gif' alt='\u2191' title='\" . lang('Move up') . \"'> \"\n\t\t\t. \"<input type='image' class='icon' name='down[$i]' src='../adminer/static/down.gif' alt='\u2193' title='\" . lang('Move down') . \"'> \"\n\t\t: \"\");\n\t\techo ($orig == \"\" || support(\"drop_col\") ? \"<input type='image' class='icon' name='drop_col[$i]' src='../adminer/static/cross.gif' alt='x' title='\" . lang('Remove') . \"'>\" : \"\");\n\t}\n}\n\n/** Move fields up and down or add field\n* @param array\n* @return bool\n*/\nfunction process_fields(&$fields) {\n\t$offset = 0;\n\tif ($_POST[\"up\"]) {\n\t\t$last = 0;\n\t\tforeach ($fields as $key => $field) {\n\t\t\tif (key($_POST[\"up\"]) == $key) {\n\t\t\t\tunset($fields[$key]);\n\t\t\t\tarray_splice($fields, $last, 0, array($field));\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (isset($field[\"field\"])) {\n\t\t\t\t$last = $offset;\n\t\t\t}\n\t\t\t$offset++;\n\t\t}\n\t} elseif ($_POST[\"down\"]) {\n\t\t$found = false;\n\t\tforeach ($fields as $key => $field) {\n\t\t\tif (isset($field[\"field\"]) && $found) {\n\t\t\t\tunset($fields[key($_POST[\"down\"])]);\n\t\t\t\tarray_splice($fields, $offset, 0, array($found));\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (key($_POST[\"down\"]) == $key) {\n\t\t\t\t$found = $field;\n\t\t\t}\n\t\t\t$offset++;\n\t\t}\n\t} elseif ($_POST[\"add\"]) {\n\t\t$fields = array_values($fields);\n\t\tarray_splice($fields, key($_POST[\"add\"]), 0, array(array()));\n\t} elseif (!$_POST[\"drop_col\"]) {\n\t\treturn false;\n\t}\n\treturn true;\n}\n\n/** Callback used in routine()\n* @param array\n* @return string\n*/\nfunction normalize_enum($match) {\n\treturn \"'\" . str_replace(\"'\", \"''\", addcslashes(stripcslashes(str_replace($match[0][0] . $match[0][0], $match[0][0], substr($match[0], 1, -1))), '\\\\')) . \"'\";\n}\n\n/** Issue grant or revoke commands\n* @param string GRANT or REVOKE\n* @param array\n* @param string\n* @param string\n* @return bool\n*/\nfunction grant($grant, $privileges, $columns, $on) {\n\tif (!$privileges) {\n\t\treturn true;\n\t}\n\tif ($privileges == array(\"ALL PRIVILEGES\", \"GRANT OPTION\")) {\n\t\t// can't be granted or revoked together\n\t\treturn ($grant == \"GRANT\"\n\t\t\t? queries(\"$grant ALL PRIVILEGES$on WITH GRANT OPTION\")\n\t\t\t: queries(\"$grant ALL PRIVILEGES$on\") && queries(\"$grant GRANT OPTION$on\")\n\t\t);\n\t}\n\treturn queries(\"$grant \" . preg_replace('~(GRANT OPTION)\\([^)]*\\)~', '\\1', implode(\"$columns, \", $privileges) . $columns) . $on);\n}\n\n/** Drop old object and create a new one\n* @param string drop old object query\n* @param string create new object query\n* @param string drop new object query\n* @param string create test object query\n* @param string drop test object query\n* @param string\n* @param string\n* @param string\n* @param string\n* @param string\n* @param string\n* @return null redirect in success\n*/\nfunction drop_create($drop, $create, $drop_created, $test, $drop_test, $location, $message_drop, $message_alter, $message_create, $old_name, $new_name) {\n\tif ($_POST[\"drop\"]) {\n\t\tquery_redirect($drop, $location, $message_drop);\n\t} elseif ($old_name == \"\") {\n\t\tquery_redirect($create, $location, $message_create);\n\t} elseif ($old_name != $new_name) {\n\t\t$created = queries($create);\n\t\tqueries_redirect($location, $message_alter, $created && queries($drop));\n\t\tif ($created) {\n\t\t\tqueries($drop_created);\n\t\t}\n\t} else {\n\t\tqueries_redirect(\n\t\t\t$location,\n\t\t\t$message_alter,\n\t\t\tqueries($test) && queries($drop_test) && queries($drop) && queries($create)\n\t\t);\n\t}\n}\n\n/** Generate SQL query for creating trigger\n* @param string\n* @param array result of trigger()\n* @return string\n*/\nfunction create_trigger($on, $row) {\n\tglobal $jush;\n\t$timing_event = \" $row[Timing] $row[Event]\" . (preg_match('~ OF~', $row[\"Event\"]) ? \" $row[Of]\" : \"\"); // SQL injection\n\treturn \"CREATE TRIGGER \"\n\t\t. idf_escape($row[\"Trigger\"])\n\t\t. ($jush == \"mssql\" ? $on . $timing_event : $timing_event . $on)\n\t\t. rtrim(\" $row[Type]\\n$row[Statement]\", \";\")\n\t\t. \";\"\n\t;\n}\n\n/** Generate SQL query for creating routine\n* @param string \"PROCEDURE\" or \"FUNCTION\"\n* @param array result of routine()\n* @return string\n*/\nfunction create_routine($routine, $row) {\n\tglobal $inout, $jush;\n\t$set = array();\n\t$fields = (array) $row[\"fields\"];\n\tksort($fields); // enforce fields order\n\tforeach ($fields as $field) {\n\t\tif ($field[\"field\"] != \"\") {\n\t\t\t$set[] = (preg_match(\"~^($inout)\\$~\", $field[\"inout\"]) ? \"$field[inout] \" : \"\") . idf_escape($field[\"field\"]) . process_type($field, \"CHARACTER SET\");\n\t\t}\n\t}\n\t$definition = rtrim(\"\\n$row[definition]\", \";\");\n\treturn \"CREATE $routine \"\n\t\t. idf_escape(trim($row[\"name\"]))\n\t\t. \" (\" . implode(\", \", $set) . \")\"\n\t\t. (isset($_GET[\"function\"]) ? \" RETURNS\" . process_type($row[\"returns\"], \"CHARACTER SET\") : \"\")\n\t\t. ($row[\"language\"] ? \" LANGUAGE $row[language]\" : \"\")\n\t\t. ($jush == \"pgsql\" ? \" AS \" . q($definition) : \"$definition;\")\n\t;\n}\n\n/** Remove current user definer from SQL command\n* @param string\n* @return string\n*/\nfunction remove_definer($query) {\n\treturn preg_replace('~^([A-Z =]+) DEFINER=`' . preg_replace('~@(.*)~', '`@`(%|\\1)', logged_user()) . '`~', '\\1', $query); //! proper escaping of user\n}\n\n/** Format foreign key to use in SQL query\n* @param array (\"db\" => string, \"ns\" => string, \"table\" => string, \"source\" => array, \"target\" => array, \"on_delete\" => one of $on_actions, \"on_update\" => one of $on_actions)\n* @return string\n*/\nfunction format_foreign_key($foreign_key) {\n\tglobal $on_actions;\n\t$db = $foreign_key[\"db\"];\n\t$ns = $foreign_key[\"ns\"];\n\treturn \" FOREIGN KEY (\" . implode(\", \", array_map('idf_escape', $foreign_key[\"source\"])) . \") REFERENCES \"\n\t\t. ($db != \"\" && $db != $_GET[\"db\"] ? idf_escape($db) . \".\" : \"\")\n\t\t. ($ns != \"\" && $ns != $_GET[\"ns\"] ? idf_escape($ns) . \".\" : \"\")\n\t\t. table($foreign_key[\"table\"])\n\t\t. \" (\" . implode(\", \", array_map('idf_escape', $foreign_key[\"target\"])) . \")\" //! reuse $name - check in older MySQL versions\n\t\t. (preg_match(\"~^($on_actions)\\$~\", $foreign_key[\"on_delete\"]) ? \" ON DELETE $foreign_key[on_delete]\" : \"\")\n\t\t. (preg_match(\"~^($on_actions)\\$~\", $foreign_key[\"on_update\"]) ? \" ON UPDATE $foreign_key[on_update]\" : \"\")\n\t;\n}\n\n/** Add a file to TAR\n* @param string\n* @param TmpFile\n* @return null prints the output\n*/\nfunction tar_file($filename, $tmp_file) {\n\t$return = pack(\"a100a8a8a8a12a12\", $filename, 644, 0, 0, decoct($tmp_file->size), decoct(time()));\n\t$checksum = 8*32; // space for checksum itself\n\tfor ($i=0; $i < strlen($return); $i++) {\n\t\t$checksum += ord($return[$i]);\n\t}\n\t$return .= sprintf(\"%06o\", $checksum) . \"\\0 \";\n\techo $return;\n\techo str_repeat(\"\\0\", 512 - strlen($return));\n\t$tmp_file->send();\n\techo str_repeat(\"\\0\", 511 - ($tmp_file->size + 511) % 512);\n}\n\n/** Get INI bytes value\n* @param string\n* @return int\n*/\nfunction ini_bytes($ini) {\n\t$val = ini_get($ini);\n\tswitch (strtolower(substr($val, -1))) {\n\t\tcase 'g': $val *= 1024; // no break\n\t\tcase 'm': $val *= 1024; // no break\n\t\tcase 'k': $val *= 1024;\n\t}\n\treturn $val;\n}\n\n/** Create link to database documentation\n* @param array $jush => $path\n* @param string HTML code\n* @return string HTML code\n*/\nfunction doc_link($paths, $text = \"<sup>?</sup>\") {\n\tglobal $jush, $connection;\n\t$server_info = $connection->server_info;\n\t$version = preg_replace('~^(\\d\\.?\\d).*~s', '\\1', $server_info); // two most significant digits\n\t$urls = array(\n\t\t'sql' => \"https://dev.mysql.com/doc/refman/$version/en/\",\n\t\t'sqlite' => \"https://www.sqlite.org/\",\n\t\t'pgsql' => \"https://www.postgresql.org/docs/$version/\",\n\t\t'mssql' => \"https://msdn.microsoft.com/library/\",\n\t\t'oracle' => \"https://www.oracle.com/pls/topic/lookup?ctx=db\" . preg_replace('~^.* (\\d+)\\.(\\d+)\\.\\d+\\.\\d+\\.\\d+.*~s', '\\1\\2', $server_info) . \"&id=\",\n\t);\n\tif (preg_match('~MariaDB~', $server_info)) {\n\t\t$urls['sql'] = \"https://mariadb.com/kb/en/library/\";\n\t\t$paths['sql'] = (isset($paths['mariadb']) ? $paths['mariadb'] : str_replace(\".html\", \"/\", $paths['sql']));\n\t}\n\treturn ($paths[$jush] ? \"<a href='\" . h($urls[$jush] . $paths[$jush]) . \"'\" . target_blank() . \">$text</a>\" : \"\");\n}\n\n/** Wrap gzencode() for usage in ob_start()\n* @param string\n* @return string\n*/\nfunction ob_gzencode($string) {\n\t// ob_start() callback recieves an optional parameter $phase but gzencode() accepts optional parameter $level\n\treturn gzencode($string);\n}\n\n/** Compute size of database\n* @param string\n* @return string formatted\n*/\nfunction db_size($db) {\n\tglobal $connection;\n\tif (!$connection->select_db($db)) {\n\t\treturn \"?\";\n\t}\n\t$return = 0;\n\tforeach (table_status() as $table_status) {\n\t\t$return += $table_status[\"Data_length\"] + $table_status[\"Index_length\"];\n\t}\n\treturn format_number($return);\n}\n\n/** Print SET NAMES if utf8mb4 might be needed\n* @param string\n* @return null\n*/\nfunction set_utf8mb4($create) {\n\tglobal $connection;\n\tstatic $set = false;\n\tif (!$set && preg_match('~\\butf8mb4~i', $create)) { // possible false positive\n\t\t$set = true;\n\t\techo \"SET NAMES \" . charset($connection) . \";\\n\\n\";\n\t}\n}\n", "Adminer 4.8.1-dev:\nInternet Explorer or PDO in Adminer 4.7.8-4.8.0: Fix XSS in doc_link (bug #797)\nFix more PHP 8 warnings (bug #781)\nAvoid PHP warnings with PDO drivers (bug #786, regression from 4.7.8)\nMySQL: Allow moving views to other DB and renaming DB with views (bug #783)\nMariaDB: Do not treat sequences as views (PR #416)\nPostgreSQL: Support UPDATE OF triggers (bug #789)\nPostgreSQL: Support triggers with more events (OR)\nPostgreSQL: Fix parsing of foreign keys with non-ASCII column names\nPostgreSQL < 10 PDO: Avoid displaying GENERATED ALWAYS BY IDENTITY everywhere (bug #785, regression from 4.7.9)\nSQLite: Fix displayed types (bug #784, regression from 4.8.0)\n\nAdminer 4.8.0 (released 2021-02-10):\nSupport function default values in insert (bug #713)\nAllow SQL pseudo-function in insert\nSkip date columns for non-date values in search anywhere\nAdd DB version to comment in export\nSupport PHP 8 in create table (regression from 4.7.9)\nMySQL 8: Fix EXPLAIN in SQL command\nPostgreSQL: Create PRIMARY KEY for auto increment columns\nPostgreSQL: Avoid exporting empty sequence last value (bug #768)\nPostgreSQL: Do not show triggers from other schemas (PR #412)\nPostgreSQL: Fix multi-parameter functions in default values (bug #736)\nPostgreSQL: Fix displaying NULL bytea fields\nPostgreSQL PDO: Do not select NULL function for false values in edit\nOracle: Alter indexes\nOracle: Count tables\nOracle: Import from CSV\nOracle: Fix column size with string type\nMongoDB: Handle errors\nSimpleDB, Firebird, ClickHouse: Move to plugin\n\nAdminer 4.7.9 (released 2021-02-07):\nFix XSS in browsers which don't encode URL parameters (bug #775, regression from 4.7.0)\nElasticsearch, ClickHouse: Do not print response if HTTP code is not 200\nDon't syntax highlight during IME composition (bug #747)\nQuote values with leading and trailing zeroes in CSV export (bug #777)\nLink URLs in SQL command (PR #411)\nFix displayed foreign key columns from other DB (bug #766)\nRe-enable PHP warnings (regression from 4.7.8)\nMySQL: Do not export names in quotes with sql_mode='ANSI_QUOTES' (bug #749)\nMySQL: Avoid error in PHP 8 when connecting to socket (PR #409)\nMySQL: Don't quote default value of text fields (bug #779)\nPostgreSQL: Export all FKs after all CREATE TABLE (PR #351)\nPostgreSQL: Fix dollar-quoted syntax highlighting (bug #738)\nPostgreSQL: Do not show view definition from other schema (PR #392)\nPostgreSQL: Use bigserial for bigint auto increment (bug #765, regression from 3.0.0)\nPostgreSQL PDO: Support PgBouncer, unsupport PostgreSQL < 9.1 (bug #771)\nPostgreSQL 10: Support GENERATED ALWAYS BY IDENTITY (PR #386)\nPostgreSQL 10: Support partitioned tables (PR #396)\nPostgreSQL 11: Create PRIMARY KEY for auto increment columns\nSQLite: Set busy_timeout to 500\nMS SQL: Don't truncate comments to 30 chars (PR #376)\nElasticsearch 6: Fix displaying type mapping (PR #402)\nMongoDB: Fix password-less check in the mongo extension (PR #405)\nEditor: Cast to string when searching (bug #325)\nEditor: Avoid trailing dot in export filename\n\nAdminer 4.7.8 (released 2020-12-06):\nSupport PHP 8\nDisallow connecting to privileged ports (bug #769)\n\nAdminer 4.7.7 (released 2020-05-11):\nFix open redirect if Adminer is accessible at //adminer.php%2F@\n\nAdminer 4.7.6 (released 2020-01-31):\nSpeed up alter table form (regression from 4.4.0)\nFix clicking on non-input fields in alter table (regression from 4.6.2)\nDisplay time of procedure execution\nDisallow connecting to ports > 65535 (bug #730)\nMySQL: Always set foreign_key_checks in export\nPostgreSQL: Support exporting views\nEditor: Fix focusing foreign key search in select\n\nAdminer 4.7.5 (released 2019-11-13):\nAdd id=\"\" to cells with failed inline edit (bug #708)\nPostgreSQL: Fix getting default value in PostgreSQL 12 (bug #719)\nPostgreSQL, Oracle: Set schema for EXPLAIN queries in SQL command (bug #706)\nClickHouse: SQL command\nSwedish translation\n\nAdminer 4.7.4 (released 2019-10-22):\nFix XSS if Adminer is accessible at URL /data:\n\nAdminer 4.7.3 (released 2019-08-27):\nAllow editing foreign keys pointing to tables in other database/schema (bug #694)\nFix blocking of concurrent instances in PHP >7.2 (bug #703)\nMySQL: Speed up displaying tables in large databases (bug #700, regression from 4.7.2)\nMySQL: Allow editing rows identified by negative floats (bug #695)\nMySQL: Skip editing generated columns\nSQLite: Quote strings stored in integer columns in export (bug #696)\nSQLite: Handle error in altering table (bug #697)\nSQLite: Allow setting auto increment for empty tables\nSQLite: Preserve auto increment when recreating table\nMS SQL: Support foreign keys to other DB\nMongoDB: Allow setting authSource from environment variable \n\nAdminer 4.7.2 (released 2019-07-18):\nDo not attempt logging in without password (bug #676)\nStretch footer over the whole table width (bug #624)\nAllow overwriting tables when copying them\nFix displaying SQL command after Save and continue edit\nCache busting for adminer.css\nMySQL: Fix displaying multi-columns foreign keys (bug #675, regression from 4.7.0)\nMySQL: Fix creating users and changing password in MySQL 8 (bug #663)\nMySQL: Pass SRID to GeomFromText\nPostgreSQL: Fix setting column comments on new table\nPostgreSQL: Display definitions of materialized views (bug #682)\nPostgreSQL: Fix table status in PostgreSQL 12 (bug #683)\nMS SQL: Support comments\nElasticsearch: Fix setting number of rows\n\nAdminer 4.7.1 (released 2019-01-24):\nDisplay the tables scrollbar (bug #647)\nRemember visible columns in Create Table form (bug #493)\nAdd autocomplete attributes to login form\nPHP <5.4 compatibility even with ClickHouse enabled (regression from 4.7.0)\nSQLite: Hide server field in login form\nEditor: Allow disabling boolean fields in PostgreSQL (bug #640)\n\nAdminer 4.7.0 (released 2018-11-24):\nSimplify storing executed SQL queries to bookmarks\nWarn when using password with leading or trailing spaces\nHide import from server if importServerPath() returns an empty string\nFix inline editing of empty cells (regression from 4.6.3)\nAllow adding more than two indexes and forign key columns at a time (regression from 4.4.0)\nAvoid overwriting existing tables when copying tables (bug #642)\nFix function change with set data type\nIncrease username maxlength to 80 (bug #623)\nMake maxlength in all fields a soft limit\nMake tables horizontally scrollable\nMySQL: Support foreign keys created with ANSI quotes (bug #620)\nMySQL: Recognize ON UPDATE current_timestamp() (bug #632, bug #638)\nMySQL: Descending indexes in MySQL 8 (bug #643)\nPostgreSQL: Quote array values in export (bug #621)\nPostgreSQL: Export DESC indexes (bug #639)\nPostgreSQL: Support GENERATED BY DEFAULT AS IDENTITY in PostgreSQL 10\nMS SQL: Pass database when connecting\nClickHouse: Connect, databases list, tables list, select, SQL command\nGeorgian translation\n\nAdminer 4.6.3 (released 2018-06-28):\nDisallow using password-less databases\nCopy triggers when copying table\nStop session before connecting\nSimplify running slow queries\nDecrease timeout for running slow queries from 5 seconds to 2 seconds\nFix displaying info about non-alphabetical objects (bug #599)\nUse secure cookies on HTTP if session.cookie_secure is set\nPDO: Support binary fields download\nMySQL: Disallow LOAD DATA LOCAL INFILE\nMySQL: Use CONVERT() only when searching for non-ASCII (bug #603)\nMySQL: Order database names in MySQL 8 (bug #613)\nPostgreSQL: Fix editing data in views (bug #605, regression from 4.6.0)\nPostgreSQL: Do not cast date/time/number/uuid searches to text (bug #608)\nPostgreSQL: Export false as 0 in PDO (bug #619)\nMS SQL: Support port with sqlsrv\nEditor: Do not check boolean checkboxes with false in PostgreSQL (bug #607)\n\nAdminer 4.6.2 (released 2018-02-20):\nSemi-transparent border on table actions\nShorten JSON values in select (bug #594)\nSpeed up alter table form (regression from 4.4.0)\nStore current version without authentication and in Editor\nPostgreSQL: Fix exporting string default values\nPostgreSQL: Fix exporting sequences in PostgreSQL 10\nPostgreSQL: Add IF EXISTS to DROP SEQUENCE in export (bug #595)\nEditor: Fix displaying of true boolean values (regression from 4.5.0)\n\nAdminer 4.6.1 (released 2018-02-09):\nSticky position of table actions\nSpeed up rendering of long tables (regression from 4.4.0)\nDisplay notification about performing action after relogin\nAdd system tables help links\nMySQL: Support non-utf8 charset in search in column\nMySQL: Support geometry in MySQL 8 (bug #574)\nMariaDB: Links to documentation\nSQLite: Allow deleting PRIMARY KEY from tables with auto increment\nPostgreSQL: Support binary files in bytea fields\nPostgreSQL: Don't treat interval type as number (bug #474)\nPostgreSQL: Cast to string when searching using LIKE (bug #325)\nPostgreSQL: Fix condition for selecting no rows\nPostgreSQL: Support TRUNCATE+INSERT export\nCustomization: Support connecting to MySQL via SSL\nCustomization: Allow specifying server name displayed in breadcrumbs\n\nAdminer 4.6.0 (released 2018-02-05):\nFix counting selected rows after going back to select page\nPHP <5.3 compatibility even with Elasticsearch enabled\nFully support functions in default values\nStop redirecting links via adminer.org\nSupport X-Forwarded-Prefix\nDisplay options for timestamp columns when creating a new table\nDisable autocompleting password on create user page\nUse primary key to edit rows even if not selected\nMySQL, PostgreSQL: Display warnings\nMySQL: Add floor and ceil select functions\nMySQL: Add FIND_IN_SET search operator\nMariaDB: Support JSON since MariaDB 10.2\nSQLite, PostgreSQL: Limit rows in data manipulation without unique key\nPostgreSQL: Support routines\nPostgreSQL: Allow editing views with uppercase letters (bug #467)\nPostgreSQL: Allow now() as default value (bug #525)\nSimpleDB: Document that allow_url_fopen is required\nMalay translation\n\nAdminer 4.5.0 (released 2018-01-24):\nDisplay name of the object in confirmation when dropping it\nDisplay newlines in column comments (bug #573)\nSupport current_timestamp() as default of time fields (bug #572)\nHide window.opener from pages opened in a new window (bug #561)\nDisplay error when getting row to edit\nStore current Adminer version server-side to avoid excessive requests\nAdminer: Fix Search data in tables (regression from 4.4.0)\nCSP: Allow any styles, images, media and fonts, disallow base-uri\nMySQL: Support geometry in MySQL 8 (bug #574)\nMySQL: Support routines with comments in parameters (bug #460)\nMariaDB: Support fulltext and spatial indexes in InnoDB (bug #583)\nSQLite: Enable foreign key checks\nPostgreSQL: Respect NULL default value\nPostgreSQL: Display foreign tables (bug #576)\nPostgreSQL: Do not export triggers if not requested\nPostgreSQL: Export DROP SEQUENCE if dropping table\nPostgreSQL: Display boolean values as code (bug #562)\nMS SQL: Support freetds\nnon-MySQL: Avoid CONVERT() (bug #509)\nElasticsearch: Insert, update, delete\nMongoDB: Support mongodb PHP extension\nEditor: Fix displaying of false values in PostgreSQL (bug #568)\n\nAdminer 4.4.0 (released 2018-01-17):\nAdd Content Security Policy\nDisallow scripts without nonce\nRate limit password-less login attempts from the same IP address\nDisallow connecting to privileged ports\nAdd nosniff header\nPHP 7.1: Prevent warning when using empty limit\nPHP 7.2: Prevent warning when searching in select\nMySQL: Remove dedicated view for replication status (added in 4.3.0)\nPostgreSQL: Sort table names (regression from 4.3.1)\nEditor: Don't set time zone from PHP, fixes DST\nEditor: Display field comment's text inside [] only in edit form\nEditor: Fix doubleclick on database page\nEditor: Fix Search data in tables\nCustomization: Always send security headers\nHebrew translation\n\nAdminer 4.3.1 (released 2017-04-14):\nFix permanent login after logout (bug #539)\nFix SQL command autofocus (regression from 4.0.0)\nPostgreSQL: Support JSON and JSONB data types\nPostgreSQL: Fix index size computation in PostgreSQL < 9.0 (regression from 4.3.0)\nPostgreSQL: Fix nullable fields in export\n\nAdminer 4.3.0 (released 2017-03-15):\nMake maxlength in edit fields a soft limit\nAdd accessibility labels\nAdd Cache-Control: immutable to static files\nMySQL: Support MySQL 8\nMySQL: Support JSON data type\nMySQL: Add dedicated view for replication status\nMySQL: Support spatial indexes\nPostgreSQL: Export\nPostgreSQL: Don't treat partial indexes as unique\nMS SQL: Support pdo_dblib\nElasticsearch: Support HTTPS by inputting https://server\n\nAdminer 4.2.5 (released 2016-06-01):\nFix remote execution in SQLite query\nSQLite: Require credentials to use\nPostgreSQL: Support KILL\n\nAdminer 4.2.4 (released 2016-02-06):\nFix remote execution in SQLite query\nMySQL: Support PHP 7\nBosnian translation\nFinnish translation\n\nAdminer 4.2.3 (released 2015-11-15):\nFix XSS in indexes (non-MySQL only)\nSupport PHP 7\nGreek translation\nGalician translation\nBulgarian translation\n\nAdminer 4.2.2 (released 2015-08-05):\nFix XSS in alter table (found by HP Fortify)\n\nAdminer 4.2.1 (released 2015-03-10):\nSend referrer header to the same domain\nMySQL: Fix usage of utf8mb4 if the client library doesn't support it\nMySQL: Use utf8mb4 in export only if required\nSQLite: Use EXPLAIN QUERY PLAN in SQL query\n\nAdminer 4.2.0 (released 2015-02-07):\nFix XSS in login form (bug #436)\nAllow limiting number of displayed rows in SQL command\nFix reading routine column collations\nUnlock session in alter database\nMake master key unreadable to others (bug #410)\nFix edit by long non-utf8 string\nSpecify encoding for PHP 5.6 with invalid default_charset\nFix saving NULL value, bug since Adminer 4.0.3\nSend 403 for auth error\nReport offline and other AJAX errors (bug #419)\nDon't alter table comment if not changed\nAdd links to documentation on table status page\nFix handling of 64 bit numbers in auto_increment\nAdd referrer: never meta tag\nMySQL: Use utf8mb4 if available\nMySQL: Support foreign keys in NDB storage\nPostgreSQL: Materialized views\nSQLite: Support CURRENT_* default values (bug #417)\nElasticsearch: Use where in select\nFirebird: Alpha version\nDanish translation\n\nAdminer 4.1.0 (released 2014-04-18):\nProvide size of all databases in the overview\nPrevent against brute force login attempts from the same IP address\nCompute number of tables in the overview explicitly\nDisplay edit form after error in clone or multi-edit\nTrim trailing non-breaking spaces in SQL textarea\nDisplay time of the select command\nPrint elapsed time in HTML instead of SQL command comment\nImprove gzip export ratio (bug #387)\nUse rel=\"noreferrer\" for external links, skip adminer.org redirect in WebKit\nMySQL: Fix enum types in routines (bug #391)\nMySQL: Fix editing rows by binary values, bug since Adminer 3.7.1\nMySQL: Respect daylight saving time in dump, bug since Adminer 3.6.4\nMySQL 5.6.5+: Support ON UPDATE on datatime column\nSQLite: Support UPDATE OF triggers\nSQLite: Display auto-created unique indexes, bug since Adminer 3.5.0\nEditor: Fix login() method, bug since Adminer 4.0.0\nTranslate numbers in ar, bn, fa\nVietnamese translation\n\nAdminer 4.0.3 (released 2014-02-01)\nMongoDB: insert, truncate, indexes\nSimpleDB, MongoDB: insert more fields at once\nSQLite: Fix creating table and altering primary key, bug since Adminer 4.0.0\nDon't store invalid credentials to session, bug since Adminer 4.0.0\nNorweigan translation\n\nAdminer 4.0.2 (released 2014-01-11):\nFix handling of long text in SQL textarea\nSupport paste to SQL textarea in Opera\n\nAdminer 4.0.1 (released 2014-01-11):\nDon't use type=number if a SQL function is used\nDisable highlighting in textareas with long texts\nDon't autofocus SQL textarea in Firefox\nDon't link NULL foreign key values\nFix displaying images in Editor, bug since Adminer 3.6.0\nFix uploading files, bug since Adminer 4.0.0\nMongoDB: Count tables, display ObjectIds, sort, limit, offset, count rows\nElasticsearch: Fix compiled version, create and drop DB, drop table\n\nAdminer 4.0.0 (released 2014-01-08):\nDriver for SimpleDB, MongoDB and Elasticsearch\nHighlight SQL in textareas\nSave and continue edit by AJAX\nSplit SQL command and import\nAdd a new column in alter table on key press\nMark length as required for strings\nAdd label to database selection, move logout button\nAdd button for dropping an index\nDisplay number of selected rows\nAdd links to documentation\nDisable underlining links\nDifferentiate views in navigation\nImprove speed of CSV import\nKeep form values after refresh in Firefox\nMark auto_increment fields in edit\nDon't append newlines to uploaded files, bug since Adminer 3.7.0\nDon't display SQL edit form on Ctrl+click on the select query, introduced in Adminer 3.6.4\nUse MD5 for editing long keys only in supported drivers, bug since Adminer 3.6.4\nDon't reset column when searching for an empty value with Enter, bug since Adminer 3.6.4\nEncrypt passwords stored in session by a key stored in cookie\nDon't execute external JavaScript when verifying version\nInclude JUSH in the compiled version\nProtect CSRF token against BREACH\nNon-MySQL: View triggers\nSQLite: Allow editing primary key\nSQLite: Allow editing foreign keys\nPostgreSQL: Fix handling of nextval() default values\nPostgreSQL: Support creating array columns\nCustomization: Provide schemas()\nPortugal Portuguese translation\nThai translation\n\nAdminer 3.7.1 (released 2013-06-29):\nIncrease click target for checkboxes\nUse shadow for highlighting default button\nDon't use LIMIT 1 if inline updating unique row\nDon't check previous checkbox on added column in create table (bug #326)\nOrder table list by name\nVerify UTF-8 encoding of CSV import\nNotify user about expired master password for permanent login\nHighlight table being altered in navigation\nSend 404 for invalid database and schema\nFix title and links on invalid table pages\nDisplay error on invalid alter table and view pages\nMySQL: Speed up updating rows without numeric or UTF-8 primary key\nNon-MySQL: Descending indexes\nPostgreSQL: Fix detecting oid column in PDO\nPostgreSQL: Handle timestamp types (bug #324)\nAdd Korean translation\n\nAdminer 3.7.0 (released 2013-05-19):\nAllow more SQL files to be uploaded at the same time\nPrint run time next to executed queries\nDon't drop original view and routine before creating the new one\nHighlight default submit button\nAdd server placeholder to login form\nDisable SQL export when applying functions in select\nAllow using lang() in plugins (customization)\nRemove bzip2 compression support\nConstraint memory used in TAR export\nAllow exporting views dependent on each other (bug #214)\nFix resetting search (bug #318)\nDon't use LIMIT 1 if updating unique row (bug #320)\nRestrict editing rows without unique identifier to search results\nDisplay navigation bellow main content on mobile browsers\nGet number of rows on export page asynchronously\nRespect 'whole result' even if some rows are checked (bug #339 since Adminer 3.7.0)\nMySQL: Optimize create table page and Editor navigation\nMySQL: Display bit type as binary number\nMySQL: Improve export of binary data types\nMySQL: Fix handling of POINT data type (bug #282)\nMySQL: Don't export binary and geometry columns twice in select\nMySQL: Fix EXPLAIN in MySQL < 5.1, bug since Adminer 3.6.4\nSQLite: Export views\nPostgreSQL: Fix swapped NULL and NOT NULL columns in PDO\n\nAdminer 3.6.4 (released 2013-04-26):\nDisplay pagination on a fixed position\nIncrease default select limit to 50\nDisplay SQL edit form on Ctrl+click on the select query\nDisplay SQL history from newest\nRecover original view, trigger, routine if creating fails\nDo not store plain text password to history in creating user\nSelectable ON UPDATE CURRENT_TIMESTAMP field in create table\nOpen database to a new window after selecting it with Ctrl\nClear column name after resetting search (bug #296)\nExplain partitions in SQL query (bug #294)\nAllow loading more data with inline edit (bug #299)\nStay on the same page after deleting rows (bug #301)\nRespect checked tables in export filename (bug #133)\nRespect PHP configuration max_input_vars\nFix unsetting permanent login after logout\nDisable autocapitalize in identifiers on mobile browsers\nMySQL: Compatibility with MySQL 5.6\nMySQL: Move ALTER export to plugin\nMySQL: Use numeric time zone in export\nMySQL: Link processlist documentation\nSQLite: Export indexes\n\nAdminer 3.6.3 (released 2013-01-23):\nDisplay error code in SQL query\nAllow specifying external links\nTreat Meta key same as Ctrl\nFix XSS in displaying non-UTF-8 strings\nDon't use type=\"number\" for decimal numbers\n\nAdminer 3.6.2 (released 2012-12-21):\nEdit values by Ctrl+click instead of double click\nDon't select row on double click\nSupport NULL in routine calls\nShorten printed values in varchar fields\nDisplay table default values on wide screens\nDisplay date in SQL history\nHTML5 input fields\nDisplay warning for missing UPDATE privilege\nFix switching language on first load\nSupport enabled mbstring.func_overload\nMySQL: Prolong comment length since MySQL 5.5\nPostgreSQL: Fix process list in version 9.2\nMS SQL: Support databases starting with number\n\nAdminer 3.6.1 (released 2012-09-17):\nFix compiled version on PHP with multibyte support\n\nAdminer 3.6.0 (released 2012-09-16):\nLoad more data in select\nEdit strings with \\n in textarea\nTime out long running database list and select count\nUse VALUES() in INSERT+UPDATE export\nStyle logout button as link\nStore selected database to permanent login\nCtrl+click and Shift+click on button opens form to a blank window\nSwitch language by POST\nCompress translations\nMySQL: Support geometry data types\nselectQueryBuild() method (customization)\nSerbian translation\n\nAdminer 3.5.1 (released 2012-08-10):\nSupport same name fields in CSV export\nSupport Shift+click in export\n\nAdminer 3.5.0 (released 2012-08-05):\nLinks for column search in select\nAutohide column context menu in select\nAutodisplay long table names in tables list\nDisplay assigned auto_increment after clone\nSQLite: Full alter table\nSQLite: Better editing in tables without primary key\nSQLite: Display number of rows in database overview\n\nAdminer 3.4.0 (released 2012-06-30):\nLink to descending order\nShift+click on checkbox to select consecutive rows\nPrint current time next to executed SQL queries\nWarn about selecting data without index\nAllow specifying database in login form\nLink to original table in EXPLAIN of SELECT * FROM table t\nFormat numbers in translations\nMySQL: inform about disabled event_scheduler\nSQLite: support binary data\nPostgreSQL: approximate row count in table overview\nPostgreSQL: improve PDO support in SQL command\nOracle: schema, processlist, table overview numbers\nSimplify work with NULL values (customization)\nUse namespace in login form (customization)\nCustomizable export filename (customization)\nReplace JSMin by better JavaScript minifier\nDon't use AJAX links and forms\nIndonesian translation\nUkrainian translation\nBengali translation\n\nAdminer 3.3.4 (released 2012-03-07):\nForeign keys default actions (bug #188)\nSET DEFAULT foreign key action\nFix minor parser bug in SQL command with webserver file\nCtrl+click on button opens form to a blank window\nTrim table and column names (bug #195)\nError message with no response from server in AJAX\nEsc to cancel AJAX request\nMove AJAX loading indicator to the right\nDon't quote bit type in export\nDon't check row while selecting text\nFix invalid references line position on Database schema\nDisable selecting text on Database schema\nAbility to disable export (customization)\nExtensible list of databases (customization)\nMySQL: set autocommit after connect\nSQLite, PostgreSQL: vacuum\nSQLite, PostgreSQL: don't use LIKE for numbers (bug #202)\nPostgreSQL: fix alter foreign key\nPostgreSQL over PDO: connect if the eponymous database does not exist (bug #185)\nBoolean search (Editor)\nPersian translation\n\nAdminer 3.3.3 (released 2011-08-12):\nHighlight checked rows\nTitles of links in database overview and navigation\nFix trigger export (SQLite)\nDefault trigger statement (SQLite, PostgreSQL)\nRemove search by expression (PostgreSQL, MS SQL)\n\nAdminer 3.3.2 (released 2011-08-08):\nDisplay error with non-existent row in edit\nFix minor parser bug in SQL command with webserver file\nFix SQL command Stop on error\nDon't scroll with AJAX select order and alter move column\nFast number of rows with big tables (PostgreSQL)\nSort databases and schemas (PostgreSQL)\n\nAdminer 3.3.1 (released 2011-07-27):\nFix XSS introduced in Adminer 3.2.0\nFix altering default values (PostgreSQL)\nProcess list (PostgreSQL)\n\nAdminer 3.3.0 (released 2011-07-19):\nUse Esc to disable in-place edit\nShortcut for database privileges\nEditable index names\nAppend new index with auto index selection (bug #138)\nPreserve original timestamp value in multiple update (bug #158)\nBit type default value\nDisplay foreign key name in tooltip\nDisplay default column value in table overview\nDisplay column collation in tooltip\nKeyboard shortcuts: Alt+Shift+1 for homepage, Ctrl+Shift+Enter for Save and continue edit\nShow only errors with Webserver file SQL command\nRemember select export and import options\nLink tables and indexes from SQL command EXPLAIN (MySQL)\nDisplay error with all wrong SQL commands (MySQL)\nDisplay foreign keys from other schemas (PostgreSQL)\nPagination support (Oracle)\nAutocomplete for big foreign keys (Editor)\nDisplay name of the referenced record in PostgreSQL (Editor)\nPrefer NULL to empty string (Editor, bug #162)\nDisplay searched columns (Editor)\nCustomizable favicon (customization)\nMethod name can return a link (customization)\nEasier sending of default headers (customization)\nLithuanian and Romanian translation\n\nAdminer 3.2.2 (released 2011-03-28):\nFix AJAX history after reload\n\nAdminer 3.2.1 (released 2011-03-23):\nAbility to save expression in edit\nRespect default database collation (bug #119)\nDon't export triggers without table (bug #123)\nEsc to focus next field in Tab textarea\nSend forms by Ctrl+Enter on <select>\nEnum editor and textarea Ctrl+Enter working in IE\nAJAX forms in Google Chrome\nParse UTF-16 and UTF-8 BOM in all text uploads\nDisplay ; in history\nUse DELIMITER in history\nShow databases even with skip_show_database in MySQL 5\nDisable maxlength with functions in edit\nBetter placement of AJAX icon\nTable header in CSV export (Editor)\nTime format hint (Editor)\nRespect order after search (Editor)\nSet MySQL time zone by PHP setting (Editor)\nAllow own code in <head> (customization)\nPolish translation\n\nAdminer 3.2.0 (released 2011-02-24):\nGet long texts and slow information by AJAX\nMost links and forms by AJAX in browsers with support for history.pushState\nCopy tables\nAbility to search by expression in select\nExport SQL command result (bug #99)\nFocus first field with insert (bug #106)\nPermanent link in schema\nDisplay total time in show only errors mode in SQL command\nHistory: edit all\nMS SQL: auto primary and foreign key\nSQLite: display 0\nCreate table default data type: int\nFocus upper/lower fields by Ctrl+Up/Ctrl+Down\nHide credentials for SQLite\nUtilize oids in PostgreSQL\nHomepage customization\nUse IN for search in numeric fields (Editor)\nUse password input for _md5 and _sha1 fields (Editor)\nWork without session.use_cookies (bug #107)\nFix saving schema to cookie in Opera\nPortuguese, Slovenian and Turkish translation\n\nAdminer 3.1.0 (released 2010-11-16):\nTSV export and import\nCustomizable export\nOption to show only errors in SQL command\nLink to bookmark SQL command\nRecognize $$ strings in SQL command (PostgreSQL)\nHighlight and edit SQL command in processlist\nAlways display all drivers\nTimestamp at the end of export\nLink to refresh database cache (bug #96)\nSupport for virtual foreign keys\nDisable XSS \"protection\" of IE8\nImmunity against zend.ze1_compatibility_mode (bug #86)\nFix last page with empty result set\nArabic translation and RTL support\nDual licensing: Apache or GPL\n\nAdminer 3.0.1 (released 2010-10-18):\nSend the form by Ctrl+Enter in all textareas\nDisable creating SQLite databases with extension other than db, sdb, sqlite\nAbility to use Adminer in a frame through customization\nCatalan translation\nMS SQL 2005 compatibility\nPostgreSQL: connect if the eponymous database does not exist\n\nAdminer 3.0.0 (released 2010-10-15):\nDrivers for MS SQL, SQLite, PostgreSQL, Oracle\nAllow concurrent logins on the same server\nAllow permanent login without customization\nIn-place editation in select\nForeign key options in Table creation\nTreat binary type as hex\nShow number of tables in server overview\nOperator LIKE %%\nRemember export parameters in cookie\nAllow semicolon as CSV separator\nSchemas, sequences and types support (PostgreSQL)\nAutofocus username in login form\nAllow to insert Tab in SQL textareas and send the form by Ctrl+Enter\nDisable spellchecking in SQL textareas\nDisplay auto_increment value of inserted item\nAllow disabling auto_increment value export\nPrefill auto_increment column name\nAbility to jump to any page in select by JavaScript\nDisplay comment in table overview\nLink last page above data in select\nLink table names in SQL queries\nHungarian, Japanese and Tamil translation\nDefer table information in database overview to JavaScript (performance)\nBig tables optimizations (performance)\n\nAdminer 2.3.2 (released 2010-04-21):\nFix COUNT(*) link\nFix Save and continue edit\n\nAdminer 2.3.1 (released 2010-04-06):\nAdd Drop button to Alter pages (regression from 2.0.0)\nLink COUNT(*) result to listing\nNewlines in select query edit\nReturn to referrer after edit\nRespect session.auto_start (bug #42)\n\nAdminer 2.3.0 (released 2010-02-26):\nSupport for permanent login (customization required)\nSearch in all tables\nShow status variables\nPrint sums in tables overview\nAdd Delete button to Edit page (regression from 2.0.0)\nPrint error summary in SQL command\nSimplify SQL syntax error message\nShow SQL query info if available\nDelete length when changing type in alter table\nAbility to check table prefix in export\n\nAdminer 2.2.1 (released 2009-11-26):\nHighlight current links\nImprove concurrency\nMove number of tables to DB info (performance)\nSearch by foreign keys (Editor)\nLink new item in backward keys (Editor)\n\nAdminer 2.2.0 (released 2009-10-20):\nDatabase list - bulk drop, number of tables\nEnlarge field for enum and set definition\nDisplay table links above table structure\nLink URLs in select\nDisplay number of manipulated rows in JS confirm\nSet required memory in SQL command\nFix removed default in ALTER\nDisplay whitespace in texts (bug #11)\nClickJacking protection in modern browsers\nE-mail attachments (Editor)\nOptional year in date (Editor)\nSearch operators (Editor)\nAlign numbers to right in select (Editor)\nMove <h1> to $adminer->navigation (customization)\nRename get_dbh to connection (customization)\n\nAdminer 2.1.0 (released 2009-09-12):\nEdit default values directly in table creation\nExecute SQL file stored on server disk\nDisplay EXPLAIN in SQL query\nCompress export and import\nDisplay column comments in table overview\nUse ON DUPLICATE KEY UPDATE for CSV import\nPrint ALTER export instead of executing it\nClick on row selects it\nFix Editor date format\nFix long SQL query crash (bug #3)\nSpeed up simple alter table\nTraditional Chinese translation\n\nAdminer 2.0.0 (released 2009-08-06):\nEditor: User friendly data editor\nCustomization: Adminer class\nCreate single column foreign key in table structure\nTable relations (Editor)\nSend e-mails (Editor)\nDisplay images in blob (Editor)\nLocalize date (Editor)\nTreat tinyint(1) as bool (Editor)\nDivide types to groups in table creation\nLink e-mails in select\nShow type in field name title\nPreselect now() for timestamp columns\nClear history\nPrefill insert by foreign key searches\nPrint number of rows in SQL command\nRemove Delete button from Edit page - use mass operation for it\nFaster multiple update, clone and delete\nFaster table list in navigation\nDownload version checker and syntax highlighting from HTTPS\nUse HTML Strict instead of XHTML\nRemove function minification in favor of performance and customization\nFix grant ALL PRIVILEGES with GRANT OPTION\nFix CSV import\nFix work with default values\n\nAdminer 1.11.1 (released 2009-07-03):\nFix problem with enabled Filter extension\n\nAdminer 1.11.0 (released 2009-07-02):\nConnection through socket by server :/path/to/socket\nSimplify export\nDisplay execution time in SQL query\nRelative date and time functions\nVersion checker\nSave queries to history and display it on SQL page\nDisplay MySQL variables\nAbility to select all rows on current page of select\nSeparate JavaScript functions\nAlways use the default style before the external one\nAlways try to use the syntax highlighter\nAll privileges in user rights\nFix FOUND_ROWS() in SQL command\nExport only selected columns in select\nBulk database creation\nInclude views in drop and move on database overview\nHide fieldsets in select\nAutomatically add new fields in table creation\nUse \\n in SQL commands\n\nphpMinAdmin 1.10.1 (released 2009-05-07):\nHighlight odd and hover rows\nPartition editing comfort (bug #12)\nAllow full length in limited int\n\nphpMinAdmin 1.10.0 (released 2009-04-28):\nPartitioning (MySQL 5.1)\nCSV import\nPlus and minus functions\nOption to stop on error in SQL command\nCross links to select and table (bug #2236232), link new item\nSuhosin compatibility\nRemove max_allowed_packet from export\nRead style from phpMinAdmin.css if exists\nSize reduction by minification of variables and functions\nRussian translation\n\nphpMinAdmin 1.9.1 (released 2008-10-27):\nUpdate translations\n\nphpMinAdmin 1.9.0 (released 2008-10-16):\nList of tables and views with maintenance commands\nClone rows\nBulk edit and clone\nFunction results in edit\nNOT operators in select\nSearch without column restriction\nUse type=password for unhashed password\nOnly one button for each action in select\nChoose language through option-list\nXHTML syntax errors\nDon't set global variable in export\nSHOW DATABASES can be revoked\nOrder by function result working also in older MySQL versions\nTested on IIS\n\nphpMinAdmin 1.8.0 (released 2008-09-12):\nEvents (MySQL 5.1)\nAccess without login - accept ?username=\nPrint SQL query in select, messages and warnings\nDisplay number of found rows\nDon't wrap lines in select table\nItalian and Estonian translation\nOrder by COUNT(*)\n\nphpMinAdmin 1.7.0 (released 2008-08-26):\nCustomizable export (select objects to export, SQL or CSV)\nAbility to alter existing tables and drop old tables in export\nChoose columns in select, aggregation\nOrder rows by clicking on table heading\nTruncate only search results\nAutomatically select name for trigger\nChinese and French translation\nPreserve default values when altering table\nMaintain auto_increment when moving columns\nSmaller multilingual file\nCache static files\nFaster checking of number of results\n\nphpMinAdmin 1.6.1 (released 2008-05-22):\nSet session parameters only if not session.auto_start\n\nphpMinAdmin 1.6.0 (released 2008-05-16):\nOrder of columns in table\nSet max_allowed_packet in dump and use extended insert\nSpanish and German translations\nUse images for editing buttons\nProtection against big POST data\nLogout by POST\nInformation about logged user\nSeparate stylesheet\nLast-Modified header for files\nSeveral bug fixes\n\nphpMinAdmin 1.5.0 (released 2008-01-09):\nMass delete\nVertical privileges\nSpecify connection port by colon in server\nIgnore length in date and time types\nBoolean fulltext search for all columns in MyISAM\nShrink compiled output\nRemove maxlength from server and username\nUncheck NULL by change\nMark shortened fields in select\n\nphpMinAdmin 1.4.0 (released 2007-08-15):\nPrivileges\nNew design\nDutch translation\nUse NULL for auto_increment (bug #1)\nFix dropping procedure parameters\n\nphpMinAdmin 1.3.2 (released 2007-08-06):\nNext field by JavaScript in foreign keys\nSet time zone in dump\nRefresh lang cookie\nRemember drop result in case of faulty create\nMove vertical lines in schema properly\nFix maximum page in select\n\nphpMinAdmin 1.3.1 (released 2007-07-31):\nMove references lines in schema\nFix dump\nFix update links\n\nphpMinAdmin 1.3.0 (released 2007-07-27):\nBreadcrumb navigation\nOperator IN\nTimestamp default values\nDraggable tables in schema\nNumber of rows in navigation\nDisplay MySQL version and used PHP extension\nMore friendly user interface\nSlovak translation\n\nphpMinAdmin 1.2.0 (released 2007-07-25):\nManipulate triggers\nPDO Abstraction\nAuto_increment value\nJavaScript for adding rows\n\nphpMinAdmin 1.1.0 (released 2007-07-19):\nRoutines manipulation\nViews manipulation\nForeign keys manipulation\nDatabase schema with references\nProcesslist\nIndex length\nDump individual tables\nJavaScript for next rows in table edit\nCache databases list\n\nphpMinAdmin 1.0.0 (released 2007-07-11):\nFirst official release\n"], "buggy_code_start_loc": [545, 1], "buggy_code_end_loc": [546, 1], "fixing_code_start_loc": [545, 2], "fixing_code_end_loc": [546, 3], "type": "CWE-79", "message": "Adminer is open-source database management software. A cross-site scripting vulnerability in Adminer versions 4.6.1 to 4.8.0 affects users of MySQL, MariaDB, PgSQL and SQLite. XSS is in most cases prevented by strict CSP in all modern browsers. The only exception is when Adminer is using a `pdo_` extension to communicate with the database (it is used if the native extensions are not enabled). In browsers without CSP, Adminer versions 4.6.1 to 4.8.0 are affected. The vulnerability is patched in version 4.8.1. As workarounds, one can use a browser supporting strict CSP or enable the native PHP extensions (e.g. `mysqli`) or disable displaying PHP errors (`display_errors`).", "other": {"cve": {"id": "CVE-2021-29625", "sourceIdentifier": "security-advisories@github.com", "published": "2021-05-19T22:15:07.903", "lastModified": "2021-05-25T20:26:15.900", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Adminer is open-source database management software. A cross-site scripting vulnerability in Adminer versions 4.6.1 to 4.8.0 affects users of MySQL, MariaDB, PgSQL and SQLite. XSS is in most cases prevented by strict CSP in all modern browsers. The only exception is when Adminer is using a `pdo_` extension to communicate with the database (it is used if the native extensions are not enabled). In browsers without CSP, Adminer versions 4.6.1 to 4.8.0 are affected. The vulnerability is patched in version 4.8.1. As workarounds, one can use a browser supporting strict CSP or enable the native PHP extensions (e.g. `mysqli`) or disable displaying PHP errors (`display_errors`)."}, {"lang": "es", "value": "Adminer es un software de administraci\u00f3n de bases de datos de c\u00f3digo abierto.&#xa0;Una vulnerabilidad de tipo cross-site scripting en Adminer versiones 4.6.1 hasta 4.8.0, afecta a los usuarios de MySQL, MariaDB, PgSQL y SQLite.&#xa0;Un ataque de tipo XSS en la mayor\u00eda de los casos es impedido por un CSP estricto en todos los navegadores modernos.&#xa0;La \u00fanica excepci\u00f3n es cuando Adminer est\u00e1 usando una extensi\u00f3n \"pdo_\" para comunicarse con la base de datos (se usa si las extensiones nativas no est\u00e1n habilitadas).&#xa0;En los navegadores sin CSP, las versiones de Adminer 4.6.1 hasta 4.8.0 est\u00e1n afectadas.&#xa0;La vulnerabilidad est\u00e1 parcheada en la versi\u00f3n 4.8.1.&#xa0;Como soluciones alternativas, se puede usar un navegador que admita CSP estricto o habilitar las extensiones nativas de PHP (por ejemplo, \"mysqli\") o deshabilitar la visualizaci\u00f3n de errores de PHP (\"display_errors\")"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:H", "attackVector": "NETWORK", "attackComplexity": "HIGH", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "HIGH", "integrityImpact": "HIGH", "availabilityImpact": "HIGH", "baseScore": 7.5, "baseSeverity": "HIGH"}, "exploitabilityScore": 1.6, "impactScore": 5.9}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "security-advisories@github.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:adminer:adminer:*:*:*:*:*:*:*:*", "versionStartIncluding": "4.6.1", "versionEndExcluding": "4.8.1", "matchCriteriaId": "141DCC97-784C-4851-B1DC-01F41E749177"}]}]}], "references": [{"url": "https://github.com/vrana/adminer/commit/4043092ec2c0de2258d60a99d0c5958637d051a7", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/vrana/adminer/security/advisories/GHSA-2v82-5746-vwqc", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://sourceforge.net/p/adminer/bugs-and-features/797/", "source": "security-advisories@github.com", "tags": ["Exploit", "Product", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/vrana/adminer/commit/4043092ec2c0de2258d60a99d0c5958637d051a7"}}