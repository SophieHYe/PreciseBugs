{"buggy_code": ["<!-- see section \"Template-API\" of module manual for a list of available placeholders -->\r\n\r\n<!-- available placeholders: action, search_term -->\r\n<search_form>\r\n    <form name=\"searchResultForm\" method=\"post\" action=\"%%action%%\" accept-charset=\"UTF-8\">\r\n        <div><label for=\"resultSearchterm\">[lang,searchterm_label,search]:</label><input type=\"text\" name=\"searchterm\" id=\"resultSearchterm\" value=\"%%search_term%%\" class=\"inputText\" onkeyup=\"KAJONA.portal.search.queryBackend();\" /></div><br />\r\n        <div><label for=\"Submit\">&nbsp;</label><input type=\"submit\" name=\"Submit\" value=\"[lang,submit_label,search]\" class=\"button\" /></div><br />\r\n    </form>\r\n\r\n    <div id=\"resultSetHeader\" style=\"display: none;\">[lang,hitlist_text1,search] <span id=\"spanSearchterm\"></span> [lang,hitlist_text2,search] <span id=\"spanSearchamount\"></span> [lang,hitlist_text3,search]:</div>\r\n    <div id=\"searchResult\"></div>\r\n\r\n    <script type=\"text/javascript\">\r\n    KAJONA.portal.search =  {\r\n        strLastQuery : \"\",\r\n\r\n        queryBackend : function() {\r\n            var strCurrentQuery = $(\"#resultSearchterm\").val().trim();\r\n            var searchRunning = false;\r\n            var post_target = KAJONA_WEBPATH+\"/xml.php?module=search&action=doSearch\";\r\n            var post_data = {\r\n                searchterm : strCurrentQuery\r\n            };\r\n\r\n            $('#searchResult').html(\"<ul></ul>\");\r\n            $('#resultSetHeader').css(\"display\", \"none\");\r\n            $('#plainList').css(\"display\", \"none\");\r\n\r\n            if(strCurrentQuery.length >= 3 && strCurrentQuery != KAJONA.portal.search.strLastQuery) {\r\n                if(searchRunning)\r\n                    return;\r\n\r\n                searchRunning = true;\r\n                KAJONA.portal.search.strLastQuery = strCurrentQuery;\r\n                $('#searchResult').html(\"<div style='height: 50px; background-image: url(_webpath_/templates/default/pics/default/loading.gif); background-repeat: no-repeat; background-position: center;'></div>\");\r\n\r\n                $.post(post_target, post_data, function(data, textStatus) {\r\n                    $('#searchResult').html(\"<ul></ul>\");\r\n                    $(\"#spanSearchterm\").html($(data).find(\"searchterm\").text());\r\n                    $(\"#spanSearchamount\").html($(data).find(\"nrofresults\").text());\r\n                    $('#resultSetHeader').css(\"display\", \"block\");\r\n\r\n                    $(data).find(\"item\").each(function() {\r\n                        var objNode = $(\"<li></li>\");\r\n                        objNode.append(\"<a href='\"+$(this).find(\"pagelink\").find(\"a\").attr(\"href\")+\"'>\"+$(this).find(\"pagelink\").find(\"a\").text()+\"</a>\" );\r\n                        objNode.append(\"<br />\"+$(this).find(\"description\").text());\r\n                        $(\"#searchResult ul\").append(objNode);\r\n                        searchRunning = false;\r\n                    });\r\n                }, \"xml\");\r\n            }\r\n        }\r\n    };\r\n    </script>\r\n</search_form>\r\n\r\n\r\n    <!-- available placeholders: hitlist, search_term, search_nrresults, link_back, link_overview, link_forward -->\r\n<search_hitlist>\r\n<div id=\"plainList\" class=\"searchHitList\">\r\n    <ul>%%hitlist%%</ul>\r\n    <div align=\"center\">%%link_back%%&nbsp;&nbsp;%%link_overview%%&nbsp;&nbsp;%%link_forward%%</div>\r\n</div>\r\n</search_hitlist>\r\n\r\n    <!-- available placeholders: page_link, page_description -->\r\n<search_hitlist_hit>\r\n<li>%%page_link%%<br />%%page_description%%</li>\r\n</search_hitlist_hit>\r\n", "<!-- see section \"Template-API\" of module manual for a list of available placeholders -->\r\n\r\n<!-- available placeholders: action, search_term -->\r\n<search_form>\r\n    <form name=\"searchResultFormSmall\" method=\"post\" action=\"%%action%%\" accept-charset=\"UTF-8\">\r\n        <input type=\"text\" name=\"searchterm\" id=\"resultSearchtermSmall\" value=\"%%search_term%%\"\r\n               onkeyup=\"KAJONA.portal.searchSmall.queryBackend();\"\r\n               onblur=\"window.setTimeout( function() { $('#searchResultSmall').css('display', 'none');}, 200)\" autocomplete=\"off\" />\r\n    </form>\r\n\r\n    <div id=\"searchResultSmall\" ></div>\r\n    <div id=\"resultSetHeaderSmall\" style=\"display: none;\">[lang,hitlist_text1,search] <span id=\"spanSearchtermSmall\"></span> [lang,hitlist_text2,search] <span id=\"spanSearchamountSmall\"></span> [lang,hitlist_text3,search]:</div>\r\n\r\n\r\n    <script type=\"text/javascript\">\r\n    KAJONA.portal.searchSmall =  {\r\n        strLastQuery : \"\",\r\n\r\n        queryBackend : function() {\r\n            var strCurrentQuery = $(\"#resultSearchtermSmall\").val().trim();\r\n            var searchRunning = false;\r\n            var post_target = KAJONA_WEBPATH+\"/xml.php?module=search&action=doSearch\";\r\n            var post_data = {\r\n                searchterm : strCurrentQuery\r\n            };\r\n\r\n            $('#searchResultSmall').html(\"<ul></ul>\");\r\n            $('#plainListSmall').css(\"display\", \"none\");\r\n            $('#searchResultSmall').css(\"display\", \"block\");\r\n\r\n            if(strCurrentQuery.length >= 2 && strCurrentQuery != KAJONA.portal.searchSmall.strLastQuery) {\r\n                if(searchRunning)\r\n                    return;\r\n\r\n                searchRunning = true;\r\n                KAJONA.portal.searchSmall.strLastQuery = strCurrentQuery;\r\n                $('#searchResultSmall').html(\"<div style='height: 50px; width: 50px; background-image: url(_webpath_/templates/default/pics/default/loading.gif); background-repeat: no-repeat; background-position: center;'></div>\");\r\n\r\n                $.post(post_target, post_data, function(data, textStatus) {\r\n\r\n\r\n                    $(\"#spanSearchtermSmall\").html($(data).find(\"searchterm\").text());\r\n                    $(\"#spanSearchamountSmall\").html($(data).find(\"nrofresults\").text());\r\n\r\n                    $('#searchResultSmall').html($(\"#resultSetHeaderSmall\").html());\r\n                    $('#searchResultSmall').append($(\"<ul></ul>\"));\r\n\r\n                    $(data).find(\"item\").each(function() {\r\n                        var objNode = $(\"<li></li>\");\r\n                        objNode.append(\"<a href='\"+$(this).find(\"pagelink\").find(\"a\").attr(\"href\")+\"'>\"+$(this).find(\"pagelink\").find(\"a\").text()+\"</a>\" );\r\n                        objNode.append(\"<br />\"+$(this).find(\"description\").text());\r\n                        $(\"#searchResultSmall ul\").append(objNode);\r\n                        searchRunning = false;\r\n                    });\r\n                }, \"xml\");\r\n            }\r\n        }\r\n    };\r\n    </script>\r\n</search_form>\r\n\r\n\r\n    <!-- available placeholders: hitlist, search_term, search_nrresults, link_back, link_overview, link_forward -->\r\n<search_hitlist>\r\n<div id=\"plainListSmall\" class=\"searchHitList\" style=\"display: none;\">\r\n    <ul>%%hitlist%%</ul>\r\n    <div align=\"center\">%%link_back%%&nbsp;&nbsp;%%link_overview%%&nbsp;&nbsp;%%link_forward%%</div>\r\n</div>\r\n</search_hitlist>\r\n\r\n<!-- available placeholders: page_link, page_description -->\r\n<search_hitlist_hit>\r\n<li>%%page_link%%<br />%%page_description%%</li>\r\n</search_hitlist_hit>\r\n"], "fixing_code": ["<!-- see section \"Template-API\" of module manual for a list of available placeholders -->\r\n\r\n<!-- available placeholders: action, search_term -->\r\n<search_form>\r\n    <form name=\"searchResultForm\" method=\"post\" action=\"%%action%%\" accept-charset=\"UTF-8\">\r\n        <div><label for=\"resultSearchterm\">[lang,searchterm_label,search]:</label><input type=\"text\" name=\"searchterm\" id=\"resultSearchterm\" value=\"%%search_term%%\" class=\"inputText\" onkeyup=\"KAJONA.portal.search.queryBackend();\" /></div><br />\r\n        <div><label for=\"Submit\">&nbsp;</label><input type=\"submit\" name=\"Submit\" value=\"[lang,submit_label,search]\" class=\"button\" /></div><br />\r\n    </form>\r\n\r\n    <div id=\"resultSetHeader\" style=\"display: none;\">[lang,hitlist_text1,search] <span id=\"spanSearchterm\"></span> [lang,hitlist_text2,search] <span id=\"spanSearchamount\"></span> [lang,hitlist_text3,search]:</div>\r\n    <div id=\"searchResult\"></div>\r\n\r\n    <script type=\"text/javascript\">\r\n    KAJONA.portal.search =  {\r\n        strLastQuery : \"\",\r\n\r\n        queryBackend : function() {\r\n            var strCurrentQuery = $(\"#resultSearchterm\").val().trim();\r\n            var searchRunning = false;\r\n            var post_target = KAJONA_WEBPATH+\"/xml.php?module=search&action=doSearch\";\r\n            var post_data = {\r\n                searchterm : strCurrentQuery\r\n            };\r\n\r\n            $('#searchResult').html(\"<ul></ul>\");\r\n            $('#resultSetHeader').css(\"display\", \"none\");\r\n            $('#plainList').css(\"display\", \"none\");\r\n\r\n            if(strCurrentQuery.length >= 3 && strCurrentQuery != KAJONA.portal.search.strLastQuery) {\r\n                if(searchRunning)\r\n                    return;\r\n\r\n                searchRunning = true;\r\n                KAJONA.portal.search.strLastQuery = strCurrentQuery;\r\n                $('#searchResult').html(\"<div style='height: 50px; background-image: url(_webpath_/templates/default/pics/default/loading.gif); background-repeat: no-repeat; background-position: center;'></div>\");\r\n\r\n                $.post(post_target, post_data, function(data, textStatus) {\r\n                    $('#searchResult').html(\"<ul></ul>\");\r\n                    $(\"#spanSearchterm\").html($(data).find(\"searchterm\").html());\r\n                    $(\"#spanSearchamount\").html($(data).find(\"nrofresults\").html());\r\n                    $('#resultSetHeader').css(\"display\", \"block\");\r\n\r\n                    $(data).find(\"item\").each(function() {\r\n                        var objNode = $(\"<li></li>\");\r\n                        objNode.append(\"<a href='\"+$(this).find(\"pagelink\").find(\"a\").attr(\"href\")+\"'>\"+$(this).find(\"pagelink\").find(\"a\").text()+\"</a>\" );\r\n                        objNode.append(\"<br />\"+$(this).find(\"description\").text());\r\n                        $(\"#searchResult ul\").append(objNode);\r\n                        searchRunning = false;\r\n                    });\r\n                }, \"xml\");\r\n            }\r\n        }\r\n    };\r\n    </script>\r\n</search_form>\r\n\r\n\r\n    <!-- available placeholders: hitlist, search_term, search_nrresults, link_back, link_overview, link_forward -->\r\n<search_hitlist>\r\n<div id=\"plainList\" class=\"searchHitList\">\r\n    <ul>%%hitlist%%</ul>\r\n    <div align=\"center\">%%link_back%%&nbsp;&nbsp;%%link_overview%%&nbsp;&nbsp;%%link_forward%%</div>\r\n</div>\r\n</search_hitlist>\r\n\r\n    <!-- available placeholders: page_link, page_description -->\r\n<search_hitlist_hit>\r\n<li>%%page_link%%<br />%%page_description%%</li>\r\n</search_hitlist_hit>\r\n", "<!-- see section \"Template-API\" of module manual for a list of available placeholders -->\r\n\r\n<!-- available placeholders: action, search_term -->\r\n<search_form>\r\n    <form name=\"searchResultFormSmall\" method=\"post\" action=\"%%action%%\" accept-charset=\"UTF-8\">\r\n        <input type=\"text\" name=\"searchterm\" id=\"resultSearchtermSmall\" value=\"%%search_term%%\"\r\n               onkeyup=\"KAJONA.portal.searchSmall.queryBackend();\"\r\n               onblur=\"window.setTimeout( function() { $('#searchResultSmall').css('display', 'none');}, 200)\" autocomplete=\"off\" />\r\n    </form>\r\n\r\n    <div id=\"searchResultSmall\" ></div>\r\n    <div id=\"resultSetHeaderSmall\" style=\"display: none;\">[lang,hitlist_text1,search] <span id=\"spanSearchtermSmall\"></span> [lang,hitlist_text2,search] <span id=\"spanSearchamountSmall\"></span> [lang,hitlist_text3,search]:</div>\r\n\r\n\r\n    <script type=\"text/javascript\">\r\n    KAJONA.portal.searchSmall =  {\r\n        strLastQuery : \"\",\r\n\r\n        queryBackend : function() {\r\n            var strCurrentQuery = $(\"#resultSearchtermSmall\").val().trim();\r\n            var searchRunning = false;\r\n            var post_target = KAJONA_WEBPATH+\"/xml.php?module=search&action=doSearch\";\r\n            var post_data = {\r\n                searchterm : strCurrentQuery\r\n            };\r\n\r\n            $('#searchResultSmall').html(\"<ul></ul>\");\r\n            $('#plainListSmall').css(\"display\", \"none\");\r\n            $('#searchResultSmall').css(\"display\", \"block\");\r\n\r\n            if(strCurrentQuery.length >= 2 && strCurrentQuery != KAJONA.portal.searchSmall.strLastQuery) {\r\n                if(searchRunning)\r\n                    return;\r\n\r\n                searchRunning = true;\r\n                KAJONA.portal.searchSmall.strLastQuery = strCurrentQuery;\r\n                $('#searchResultSmall').html(\"<div style='height: 50px; width: 50px; background-image: url(_webpath_/templates/default/pics/default/loading.gif); background-repeat: no-repeat; background-position: center;'></div>\");\r\n\r\n                $.post(post_target, post_data, function(data, textStatus) {\r\n\r\n\r\n                    $(\"#spanSearchtermSmall\").html($(data).find(\"searchterm\").html());\r\n                    $(\"#spanSearchamountSmall\").html($(data).find(\"nrofresults\").html());\r\n\r\n                    $('#searchResultSmall').html($(\"#resultSetHeaderSmall\").html());\r\n                    $('#searchResultSmall').append($(\"<ul></ul>\"));\r\n\r\n                    $(data).find(\"item\").each(function() {\r\n                        var objNode = $(\"<li></li>\");\r\n                        objNode.append(\"<a href='\"+$(this).find(\"pagelink\").find(\"a\").attr(\"href\")+\"'>\"+$(this).find(\"pagelink\").find(\"a\").text()+\"</a>\" );\r\n                        objNode.append(\"<br />\"+$(this).find(\"description\").text());\r\n                        $(\"#searchResultSmall ul\").append(objNode);\r\n                        searchRunning = false;\r\n                    });\r\n                }, \"xml\");\r\n            }\r\n        }\r\n    };\r\n    </script>\r\n</search_form>\r\n\r\n\r\n    <!-- available placeholders: hitlist, search_term, search_nrresults, link_back, link_overview, link_forward -->\r\n<search_hitlist>\r\n<div id=\"plainListSmall\" class=\"searchHitList\" style=\"display: none;\">\r\n    <ul>%%hitlist%%</ul>\r\n    <div align=\"center\">%%link_back%%&nbsp;&nbsp;%%link_overview%%&nbsp;&nbsp;%%link_forward%%</div>\r\n</div>\r\n</search_hitlist>\r\n\r\n<!-- available placeholders: page_link, page_description -->\r\n<search_hitlist_hit>\r\n<li>%%page_link%%<br />%%page_description%%</li>\r\n</search_hitlist_hit>\r\n"], "buggy_code_start_loc": [39, 42], "buggy_code_end_loc": [41, 44], "fixing_code_start_loc": [39, 42], "fixing_code_end_loc": [41, 44], "type": "CWE-79", "message": "Multiple cross-site scripting (XSS) vulnerabilities in (1) search_ajax.tpl and (2) search_ajax_small.tpl in templates/default/tpl/module_search/ in the Search module (module_search) in Kajona before 4.5 allow remote attackers to inject arbitrary web script or HTML via the search parameter.", "other": {"cve": {"id": "CVE-2014-4743", "sourceIdentifier": "cve@mitre.org", "published": "2014-07-09T14:55:04.297", "lastModified": "2015-10-06T02:43:15.293", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Multiple cross-site scripting (XSS) vulnerabilities in (1) search_ajax.tpl and (2) search_ajax_small.tpl in templates/default/tpl/module_search/ in the Search module (module_search) in Kajona before 4.5 allow remote attackers to inject arbitrary web script or HTML via the search parameter."}, {"lang": "es", "value": "M\u00faltiples vulnerabilidades de XSS en (1) search_ajax.tpl y (2) search_ajax_small.tpl en templates/default/tpl/module_search/ en el m\u00f3dulo Search (module_search) en Kajona anterior a 4.5 permiten a atacantes remotos inyectar secuencias de comandos web o HTML arbitrarios a trav\u00e9s del par\u00e1metro search."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:kajona:kajona:*:*:*:*:*:*:*:*", "versionEndIncluding": "4.4", "matchCriteriaId": "2DBDF7EA-55CC-4541-9A82-FCC8C75ECB85"}, {"vulnerable": true, "criteria": "cpe:2.3:a:kajona:kajona:3.1.0:*:*:*:*:*:*:*", "matchCriteriaId": "AE6388BC-F077-4D3F-839D-33611EC25461"}, {"vulnerable": true, "criteria": "cpe:2.3:a:kajona:kajona:3.1.1:*:*:*:*:*:*:*", "matchCriteriaId": "747EBA09-8276-4BFA-B832-04FD9AEE4F58"}, {"vulnerable": true, "criteria": "cpe:2.3:a:kajona:kajona:3.2.0:*:*:*:*:*:*:*", "matchCriteriaId": "EE2C0E7E-3D1E-4206-84E2-D48ED54EDCC1"}, {"vulnerable": true, "criteria": "cpe:2.3:a:kajona:kajona:3.2.1:*:*:*:*:*:*:*", "matchCriteriaId": "A7BF706D-9ECB-4EE1-AF96-227CBE7FB906"}, {"vulnerable": true, "criteria": "cpe:2.3:a:kajona:kajona:3.3.0:*:*:*:*:*:*:*", "matchCriteriaId": "2B0F01B3-E14F-4D3D-9222-20F85CCF2905"}, {"vulnerable": true, "criteria": "cpe:2.3:a:kajona:kajona:3.3.1:*:*:*:*:*:*:*", "matchCriteriaId": "48EBF205-450C-412C-8285-2A74C26EE74D"}, {"vulnerable": true, "criteria": "cpe:2.3:a:kajona:kajona:3.4.0:*:*:*:*:*:*:*", "matchCriteriaId": "4C308CB9-A481-49F3-AED2-19F01BEE4688"}, {"vulnerable": true, "criteria": "cpe:2.3:a:kajona:kajona:3.4.1:*:*:*:*:*:*:*", "matchCriteriaId": "CCACF272-533E-4781-ACB1-0248563913ED"}, {"vulnerable": true, "criteria": "cpe:2.3:a:kajona:kajona:3.4.2:*:*:*:*:*:*:*", "matchCriteriaId": "7BDD4651-6A67-4BD0-B937-C0E34C1D5014"}, {"vulnerable": true, "criteria": "cpe:2.3:a:kajona:kajona:4.0:*:*:*:*:*:*:*", "matchCriteriaId": "540FB6A6-3B7E-4181-96E7-CBFE630845B9"}, {"vulnerable": true, "criteria": "cpe:2.3:a:kajona:kajona:4.1:*:*:*:*:*:*:*", "matchCriteriaId": "1722EE1B-4A56-428A-A222-6B600D3F2ADB"}, {"vulnerable": true, "criteria": "cpe:2.3:a:kajona:kajona:4.2:*:*:*:*:*:*:*", "matchCriteriaId": "8444FA4D-2138-402F-835E-DFF562F0062C"}, {"vulnerable": true, "criteria": "cpe:2.3:a:kajona:kajona:4.3:*:*:*:*:*:*:*", "matchCriteriaId": "8B4CE679-AF09-4258-88BA-8095C7DB4A87"}]}]}], "references": [{"url": "http://www.kajona.de/en/Development/Changelog/Changelog-V4-5/changelog_45.html", "source": "cve@mitre.org"}, {"url": "http://www.securityfocus.com/bid/68498", "source": "cve@mitre.org"}, {"url": "https://github.com/kajona/kajonacms/commit/4a07f949c171da6aa9a6e6c19421b0df16297180", "source": "cve@mitre.org", "tags": ["Exploit", "Patch"]}]}, "github_commit_url": "https://github.com/kajona/kajonacms/commit/4a07f949c171da6aa9a6e6c19421b0df16297180"}}