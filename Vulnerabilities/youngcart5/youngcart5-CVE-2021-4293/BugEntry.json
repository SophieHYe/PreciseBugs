{"buggy_code": ["<?php\n$sub_menu = \"100290\";\ninclude_once('./_common.php');\n\ncheck_demo();\n\nif ($is_admin != 'super')\n    alert('\ucd5c\uace0\uad00\ub9ac\uc790\ub9cc \uc811\uadfc \uac00\ub2a5\ud569\ub2c8\ub2e4.');\n\ncheck_admin_token();\n\n// \uc774\uc804 \uba54\ub274\uc815\ubcf4 \uc0ad\uc81c\n$sql = \" delete from {$g5['menu_table']} \";\nsql_query($sql);\n\n$group_code = null;\n$primary_code = null;\n$count = count($_POST['code']);\n\nfor ($i=0; $i<$count; $i++)\n{\n    $_POST = array_map_deep('trim', $_POST);\n    \n    $_POST['me_link'][$i] = is_array($_POST['me_link']) ? clean_xss_tags(clean_xss_attributes($_POST['me_link'][$i], 1)) : '';\n\n    $code    = is_array($_POST['code']) ? strip_tags($_POST['code'][$i]) : '';\n    $me_name = is_array($_POST['me_name']) ? strip_tags($_POST['me_name'][$i]) : '';\n    $me_link = (preg_match('/^javascript/i', $_POST['me_link'][$i]) || preg_match('/script:/i', $_POST['me_link'][$i])) ? G5_URL : strip_tags(clean_xss_attributes($_POST['me_link'][$i]));\n    \n    if(!$code || !$me_name || !$me_link)\n        continue;\n\n    $sub_code = '';\n    if($group_code == $code) {\n        $sql = \" select MAX(SUBSTRING(me_code,3,2)) as max_me_code\n                    from {$g5['menu_table']}\n                    where SUBSTRING(me_code,1,2) = '$primary_code' \";\n        $row = sql_fetch($sql);\n\n        $sub_code = base_convert($row['max_me_code'], 36, 10);\n        $sub_code += 36;\n        $sub_code = base_convert($sub_code, 10, 36);\n\n        $me_code = $primary_code.$sub_code;\n    } else {\n        $sql = \" select MAX(SUBSTRING(me_code,1,2)) as max_me_code\n                    from {$g5['menu_table']}\n                    where LENGTH(me_code) = '2' \";\n        $row = sql_fetch($sql);\n\n        $me_code = base_convert($row['max_me_code'], 36, 10);\n        $me_code += 36;\n        $me_code = base_convert($me_code, 10, 36);\n\n        $group_code = $code;\n        $primary_code = $me_code;\n    }\n\n    // \uba54\ub274 \ub4f1\ub85d\n    $sql = \" insert into {$g5['menu_table']}\n                set me_code         = '\".$me_code.\"',\n                    me_name         = '\".$me_name.\"',\n                    me_link         = '\".$me_link.\"',\n                    me_target       = '\".sql_real_escape_string(strip_tags($_POST['me_target'][$i])).\"',\n                    me_order        = '\".sql_real_escape_string(strip_tags($_POST['me_order'][$i])).\"',\n                    me_use          = '\".sql_real_escape_string(strip_tags($_POST['me_use'][$i])).\"',\n                    me_mobile_use   = '\".sql_real_escape_string(strip_tags($_POST['me_mobile_use'][$i])).\"' \";\n    sql_query($sql);\n}\n\nrun_event('admin_menu_list_update');\n\ngoto_url('./menu_list.php');"], "fixing_code": ["<?php\n$sub_menu = \"100290\";\ninclude_once('./_common.php');\n\ncheck_demo();\n\nif ($is_admin != 'super')\n    alert('\ucd5c\uace0\uad00\ub9ac\uc790\ub9cc \uc811\uadfc \uac00\ub2a5\ud569\ub2c8\ub2e4.');\n\ncheck_admin_token();\n\n// \uc774\uc804 \uba54\ub274\uc815\ubcf4 \uc0ad\uc81c\n$sql = \" delete from {$g5['menu_table']} \";\nsql_query($sql);\n\n$group_code = null;\n$primary_code = null;\n$count = count($_POST['code']);\n\nfor ($i=0; $i<$count; $i++)\n{\n    $_POST = array_map_deep('trim', $_POST);\n    \n    if(preg_match('/^javascript/i', preg_replace('/[ ]{1,}|[\\t]/', '', $_POST['me_link'][$i]))){\n        $_POST['me_link'][$i] = G5_URL;\n    }\n\n    $_POST['me_link'][$i] = is_array($_POST['me_link']) ? clean_xss_tags(clean_xss_attributes(preg_replace('/[ ]{2,}|[\\t]/', '', $_POST['me_link'][$i]), 1)) : '';\n\n    $code    = is_array($_POST['code']) ? strip_tags($_POST['code'][$i]) : '';\n    $me_name = is_array($_POST['me_name']) ? strip_tags($_POST['me_name'][$i]) : '';\n    $me_link = (preg_match('/^javascript/i', $_POST['me_link'][$i]) || preg_match('/script:/i', $_POST['me_link'][$i])) ? G5_URL : strip_tags(clean_xss_attributes($_POST['me_link'][$i]));\n    \n    if(!$code || !$me_name || !$me_link)\n        continue;\n\n    $sub_code = '';\n    if($group_code == $code) {\n        $sql = \" select MAX(SUBSTRING(me_code,3,2)) as max_me_code\n                    from {$g5['menu_table']}\n                    where SUBSTRING(me_code,1,2) = '$primary_code' \";\n        $row = sql_fetch($sql);\n\n        $sub_code = base_convert($row['max_me_code'], 36, 10);\n        $sub_code += 36;\n        $sub_code = base_convert($sub_code, 10, 36);\n\n        $me_code = $primary_code.$sub_code;\n    } else {\n        $sql = \" select MAX(SUBSTRING(me_code,1,2)) as max_me_code\n                    from {$g5['menu_table']}\n                    where LENGTH(me_code) = '2' \";\n        $row = sql_fetch($sql);\n\n        $me_code = base_convert($row['max_me_code'], 36, 10);\n        $me_code += 36;\n        $me_code = base_convert($me_code, 10, 36);\n\n        $group_code = $code;\n        $primary_code = $me_code;\n    }\n\n    // \uba54\ub274 \ub4f1\ub85d\n    $sql = \" insert into {$g5['menu_table']}\n                set me_code         = '\".$me_code.\"',\n                    me_name         = '\".$me_name.\"',\n                    me_link         = '\".$me_link.\"',\n                    me_target       = '\".sql_real_escape_string(strip_tags($_POST['me_target'][$i])).\"',\n                    me_order        = '\".sql_real_escape_string(strip_tags($_POST['me_order'][$i])).\"',\n                    me_use          = '\".sql_real_escape_string(strip_tags($_POST['me_use'][$i])).\"',\n                    me_mobile_use   = '\".sql_real_escape_string(strip_tags($_POST['me_mobile_use'][$i])).\"' \";\n    sql_query($sql);\n}\n\nrun_event('admin_menu_list_update');\n\ngoto_url('./menu_list.php');"], "buggy_code_start_loc": [24], "buggy_code_end_loc": [25], "fixing_code_start_loc": [24], "fixing_code_end_loc": [29], "type": "CWE-79", "message": "** UNSUPPPORTED WHEN ASSIGNED **** UNSUPPORTED WHEN ASSIGNED ** A vulnerability classified as problematic has been found in gnuboard youngcart5 up to 5.4.5.1. Affected is an unknown function of the file adm/menu_list_update.php. The manipulation of the argument me_link leads to cross site scripting. It is possible to launch the attack remotely. Upgrading to version 5.4.5.2 is able to address this issue. The name of the patch is 70daa537adfa47b87af12d85f1e698fff01785ff. It is recommended to upgrade the affected component. VDB-216954 is the identifier assigned to this vulnerability. NOTE: This vulnerability only affects products that are no longer supported by the maintainer.", "other": {"cve": {"id": "CVE-2021-4293", "sourceIdentifier": "cna@vuldb.com", "published": "2022-12-28T09:15:08.070", "lastModified": "2023-01-06T20:01:44.437", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "** UNSUPPPORTED WHEN ASSIGNED **** UNSUPPORTED WHEN ASSIGNED ** A vulnerability classified as problematic has been found in gnuboard youngcart5 up to 5.4.5.1. Affected is an unknown function of the file adm/menu_list_update.php. The manipulation of the argument me_link leads to cross site scripting. It is possible to launch the attack remotely. Upgrading to version 5.4.5.2 is able to address this issue. The name of the patch is 70daa537adfa47b87af12d85f1e698fff01785ff. It is recommended to upgrade the affected component. VDB-216954 is the identifier assigned to this vulnerability. NOTE: This vulnerability only affects products that are no longer supported by the maintainer."}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 6.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 2.7}], "cvssMetricV30": [{"source": "cna@vuldb.com", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 3.5, "baseSeverity": "LOW"}, "exploitabilityScore": 2.1, "impactScore": 1.4}]}, "weaknesses": [{"source": "cna@vuldb.com", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:sir:youngcart5:*:*:*:*:*:*:*:*", "versionEndExcluding": "5.4.5.2", "matchCriteriaId": "D82A54E5-0D6B-4B8D-BDCE-50EB53749390"}]}]}], "references": [{"url": "https://github.com/gnuboard/youngcart5/commit/70daa537adfa47b87af12d85f1e698fff01785ff", "source": "cna@vuldb.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/gnuboard/youngcart5/releases/tag/5.4.5.2", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}, {"url": "https://vuldb.com/?ctiid.216954", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}, {"url": "https://vuldb.com/?id.216954", "source": "cna@vuldb.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/gnuboard/youngcart5/commit/70daa537adfa47b87af12d85f1e698fff01785ff"}}