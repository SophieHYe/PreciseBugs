{"buggy_code": ["<?php\n/**\n * phpwcms content management system\n *\n * @author Oliver Georgi <og@phpwcms.org>\n * @copyright Copyright (c) 2002-2017, Oliver Georgi\n * @license http://opensource.org/licenses/GPL-2.0 GNU GPL-2\n * @link http://www.phpwcms.org\n *\n **/\n\ndefine('PHPWCMS_VERSION', '1.8.9');\ndefine('PHPWCMS_RELEASE_DATE', '2017/09/14');\ndefine('PHPWCMS_REVISION', '547');\n", "<?php\n/**\n * phpwcms content management system\n *\n * @author Oliver Georgi <og@phpwcms.org>\n * @copyright Copyright (c) 2002-2017, Oliver Georgi\n * @license http://opensource.org/licenses/GPL-2.0 GNU GPL-2\n * @link http://www.phpwcms.org\n *\n **/\n\n// ----------------------------------------------------------------\n// obligate check for phpwcms constants\nif (!defined('PHPWCMS_ROOT')) {\n\tdie(\"You Cannot Access This Script Directly, Have a Nice Day.\");\n}\n// ----------------------------------------------------------------\n\nif(isset($_GET[\"u\"]) && intval($_GET[\"u\"])) {\n\n\tif(empty($_POST[\"form_aktion\"]) || $_POST[\"form_aktion\"] != \"edit_account\") {\n\t\t$new_user_id = intval($_GET[\"u\"]);\n\t\t$sql = \"SELECT * FROM \".DB_PREPEND.\"phpwcms_user WHERE usr_id=\".$new_user_id.\" AND usr_aktiv<>9;\";\n\t\tif($result = mysql_query($sql, $db) or die(\"error\")) {\n\t\t\tif($row = mysql_fetch_array($result)) {\n\t\t\t\t$new_login = $row[\"usr_login\"];\n\t\t\t\t$new_email = $row[\"usr_email\"];\n\t\t\t\t$new_name = $row[\"usr_name\"];\n\t\t\t\t$set_user_aktiv = $row[\"usr_aktiv\"];\n\t\t\t\t$set_user_admin = $row[\"usr_admin\"];\n\t\t\t\t$set_user_fe\t= $row[\"usr_fe\"];\n\t\t\t\t$set_user_var\t= @unserialize($row[\"usr_vars\"]);\n\t\t\t\t$send_verification = 0;\n\t\t\t\t$new_password = '';\n\t\t\t}\n\t\t}\n\t}\n\n\t$set_allowed_cp = isset($set_user_var['allowed_cp']) && is_array($set_user_var['allowed_cp']) ? $set_user_var['allowed_cp'] : array();\n\n\tif(isset($_POST[\"form_aktion\"]) && $_POST[\"form_aktion\"] == \"edit_account\") {\n\n\t\t// Handle account data\n\n\t\t$new_user_id = intval($_POST[\"form_uid\"]);\n\t\t$new_login = slweg($_POST[\"form_newloginname\"]);\n\t\t$new_password = slweg($_POST[\"form_newpassword\"]);\n\t\t$new_email = clean_slweg($_POST[\"form_newemail\"]);\n\t\t$new_name = clean_slweg($_POST[\"form_newrealname\"]);\n\t\t$set_user_aktiv = isset($_POST[\"form_active\"]) ? 1 : 0;\n\t\t$set_user_admin = isset($_POST[\"form_admin\"]) ? 1 : 0;\n\t\t$set_user_fe = isset($_POST[\"form_feuser\"]) ? intval($_POST[\"form_feuser\"]) : 0;\n\t\t$set_allowed_cp = isset($_POST[\"allowed_cp\"]) && is_array($_POST[\"allowed_cp\"]) && count($_POST[\"allowed_cp\"]) ? $_POST[\"allowed_cp\"] : array();\n\t\t$set_allowed_cp_total = count($set_allowed_cp);\n\t\t$cp_total = empty($_POST[\"cp_total\"]) ? 0 : intval($_POST[\"cp_total\"]);\n\t\tif(!$set_allowed_cp_total || $cp_total == $set_allowed_cp_total) {\n\t\t\t$set_allowed_cp = array();\n\t\t}\n\t\tif($set_user_admin) {\n\t\t\t$set_user_fe = 2;\n\t\t}\n\t\t$send_verification = isset($_POST[\"verification_email\"]) ? 1 : 0;\n\t\t$user_err = '';\n\t\tif(empty($new_login)) {\n\t\t\t$user_err = $BL['be_admin_usr_err2'].\"\\n\";\n\t\t} else {\n\t\t\t$sql = \"SELECT usr_id, usr_vars, COUNT(*) AS anzahl FROM \".DB_PREPEND.\"phpwcms_user WHERE usr_login='\".aporeplace($new_login).\"' GROUP BY usr_id\";\n\t\t\tif($result = mysql_query($sql, $db)) {\n\t\t\t\tif($check_anzahl = mysql_fetch_array($result)) {\n\t\t\t\t\tif($check_anzahl[\"usr_id\"] != $new_user_id && $check_anzahl[\"anzahl\"]) {\n\t\t\t\t\t\t$user_err .= $BL['be_admin_usr_err1'].\"\\n\";\n\t\t\t\t\t}\n\n\t\t\t\t\tif(empty($user_err)) {\n\t\t\t\t\t\t$set_user_var = @unserialize($check_anzahl[\"usr_vars\"]);\n\t\t\t\t\t\tif(!is_array($set_user_var)) {\n\t\t\t\t\t\t\t$set_user_var = array();\n\t\t\t\t\t\t}\n\t\t\t\t\t\t$set_user_var['allowed_cp'] = $set_allowed_cp;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif(!is_valid_email($new_email)) {\n\t\t\t$user_err .= $BL['be_admin_usr_err4'].\"\\n\";\n\t\t}\n\t\tif(empty($user_err)) { //Insert new User\n\n\t\t\t$sql =\t\"UPDATE \".DB_PREPEND.\"phpwcms_user SET usr_login='\".aporeplace($new_login).\"', \";\n\t\t\tif($new_password) {\n\t\t\t\t$sql .= \"usr_pass='\".aporeplace(md5(makeCharsetConversion($new_password, PHPWCMS_CHARSET, 'utf-8'))).\"', \";\n\t\t\t}\n\t\t\t$sql .= \"usr_email='\".aporeplace($new_email).\"', \".\n\t\t\t\t\t\"usr_admin='\".$set_user_admin.\"', \".\n\t\t\t\t\t\"usr_aktiv='\".$set_user_aktiv.\"', \".\n\t\t\t\t\t\"usr_name='\".aporeplace($new_name).\"', \";\n\t\t\tif(isset($set_user_var['allowed_cp'])) {\n\t\t\t\t$sql .= \"usr_vars=\"._dbEscape(serialize($set_user_var)).\", \";\n\t\t\t}\n\t\t\t$sql .= \"usr_fe='\".$set_user_fe.\"' WHERE usr_id=\".$new_user_id;\n\n\t\t\tif($result = mysql_query($sql, $db) or die(\"error\")) {\n\t\t\t\t$user_ok = 1;\n\t\t\t\t$new_user_id = NULL;\n\t\t\t\tif($send_verification) {\n\t\t\t\t\t$emailbody = str_replace('{LOGIN}',\t\t\t$new_login, $BL['be_admin_usr_emailbody']);\n\t\t\t\t\t$emailbody = str_replace('{PASSWORD}',\t\t(($new_password) ? $new_password : $BL['be_admin_usr_passnochange']), $emailbody);\n\t\t\t\t\t$emailbody = str_replace('{SITE}',\t\t\tPHPWCMS_URL, $emailbody);\n\t\t\t\t\t$emailbody = str_replace('{LOGIN_PAGE}',\tPHPWCMS_URL.get_login_file(), $emailbody);\n\n\t\t\t\t\tsendEmail(\tarray(\n\t\t\t\t\t\t'recipient'\t=> $new_email,\n\t\t\t\t\t\t'toName'\t=> $new_name,\n\t\t\t\t\t\t'subject'\t=> $BL['be_admin_usr_mailsubject'],\n\t\t\t\t\t\t'isHTML'\t=> 0,\n\t\t\t\t\t\t'text'\t\t=> $emailbody,\n\t\t\t\t\t\t'from'\t\t=> $phpwcms[\"admin_email\"],\n\t\t\t\t\t\t'sender'\t=> $phpwcms[\"admin_email\"]\n\t\t\t\t        ));\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tif(empty($user_ok)) {\n\n?><form action=\"phpwcms.php?do=admin&amp;s=2&amp;u=<?php echo $new_user_id ?>\" method=\"post\" name=\"edituser\"><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" summary=\"\">\n\n          <tr><td colspan=\"2\" class=\"title\"><?php echo $BL['be_admin_usr_etitle'] ?></td></tr>\n          <tr>\n            <td><img src=\"img/leer.gif\" alt=\"\" width=\"105\" height=\"1\"></td>\n            <td><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"7\"></td>\n          </tr>\n\t\t  <?php\n\t\t  if(!empty($user_err)) {\n\t\t  ?>\n          <tr valign=\"top\">\n            <td align=\"right\"><strong style=\"color:#FF3300\"><?php echo $BL['be_admin_usr_err'] ?>:</strong>&nbsp;</td>\n            <td><strong style=\"color:#FF3300\"><?php echo nl2br(chop($user_err)) ?></strong></td>\n          </tr>\n          <tr valign=\"top\"><td colspan=\"2\" align=\"right\" class=\"chatlist\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"7\"></td></tr>\n\t\t  <?php\n\t\t  } //Ende Fehler New User\n\t\t  ?>\n          <tr>\n            <td align=\"right\" class=\"chatlist\"><?php echo $BL[\"login_username\"]  ?>:&nbsp;</td>\n            <td><input name=\"form_newloginname\" type=\"text\" id=\"form_newloginname\" class=\"width250 f11b\" value=\"<?php echo $new_login ?>\" size=\"30\" maxlength=\"30\" autocomplete=\"off\"></td>\n          </tr>\n          <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"1\"></td></tr>\n          <tr>\n            <td align=\"right\" class=\"chatlist\"><?php echo $BL[\"login_userpass\"] ?>:&nbsp;</td>\n            <td><input name=\"form_newpassword\" type=\"text\" id=\"form_newpassword\" class=\"width250 f11b\" value=\"<?php echo $new_password ?>\" size=\"30\" maxlength=\"50\" autocomplete=\"off\"></td>\n          </tr>\n          <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"1\"></td></tr>\n          <tr>\n            <td align=\"right\" class=\"chatlist\"><?php echo $BL['be_profile_label_email'] ?>:&nbsp;</td>\n            <td><input name=\"form_newemail\" type=\"text\" id=\"form_newemail\" class=\"width250 f11b\" value=\"<?php echo $new_email ?>\" size=\"30\" maxlength=\"150\"></td>\n          </tr>\n          <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"1\"></td></tr>\n          <tr>\n            <td align=\"right\" class=\"chatlist\"><?php echo $BL['be_admin_usr_realname'] ?>:&nbsp;</td>\n            <td><input name=\"form_newrealname\" type=\"text\" id=\"form_newrealname\" class=\"width250 f11b\" value=\"<?php echo $new_name ?>\" size=\"30\" maxlength=\"80\"></td>\n          </tr>\n\n\t\t  <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"6\"></td></tr>\n          <tr>\n            <td align=\"right\" class=\"chatlist\"><?php echo $BL['be_admin_usr_issection']  ?>:&nbsp;</td>\n            <td><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" bgcolor=\"#E7E8EB\" summary=\"\">\n                <tr>\n                  <td><input name=\"form_feuser\" type=\"radio\" id=\"form_feuser0\" value=\"0\"<?php is_checked($set_user_fe, 0); ?>></td>\n                  <td><label for=\"form_feuser0\"><?php echo $BL['be_admin_usr_ifsection0'] ?></label>&nbsp;&nbsp;</td>\n\t\t\t\t  <td><input name=\"form_feuser\" type=\"radio\" id=\"form_feuser1\" value=\"1\"<?php is_checked($set_user_fe, 1); ?>></td>\n                  <td><label for=\"form_feuser1\"><?php echo $BL['be_admin_usr_ifsection1'] ?></label>&nbsp;&nbsp;</td>\n\t\t\t\t  <td><input name=\"form_feuser\" type=\"radio\" id=\"form_feuser2\" value=\"2\"<?php is_checked($set_user_fe, 2); ?>></td>\n                  <td><label for=\"form_feuser2\"><?php echo $BL['be_admin_usr_ifsection2'] ?></label></td>\n\t\t\t\t  <td><img src=\"img/leer.gif\" alt=\"\" width=\"4\" height=\"21\"></td>\n                </tr>\n              </table></td>\n          </tr>\n\n          <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"6\"></td></tr>\n          <tr>\n            <td align=\"right\" class=\"chatlist\"><?php echo $BL['be_admin_usr_setactive'] ?>:&nbsp;</td>\n            <td><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" summary=\"\">\n                <tr>\n                  <td><input name=\"form_active\" type=\"checkbox\" id=\"form_active\" value=\"1\"<?php is_checked($set_user_aktiv, 1); ?>></td>\n                  <td><label for=\"form_active\"><?php echo $BL['be_admin_usr_iflogin'] ?></label></td>\n                </tr>\n              </table></td>\n          </tr>\n\n          <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"1\"></td></tr>\n          <tr>\n            <td align=\"right\" class=\"chatlist\" style=\"color:#FF0000\"><?php echo $BL['be_admin_usr_isadmin'] ?>:&nbsp;</td>\n            <td><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" summary=\"\">\n                <tr>\n                  <td><input name=\"form_admin\" type=\"checkbox\" id=\"form_admin\" value=\"1\"<?php is_checked(1, $set_user_admin); ?>></td>\n                  <td><label for=\"form_admin\"><?php echo $BL['be_admin_usr_ifadmin'] ?> <strong style=\"color:#FF0000\">!!!</strong></label></td>\n                </tr>\n              </table></td>\n          </tr>\n          <tr>\n            <td align=\"right\" class=\"chatlist\"><?php echo $BL['be_admin_usr_verify'] ?>:&nbsp;</td>\n            <td><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" summary=\"\">\n                <tr><td colspan=\"3\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"6\"></td></tr>\n                <tr bgcolor=\"#E7E8EB\">\n                  <td><input name=\"verification_email\" type=\"checkbox\" id=\"verification_email\" value=\"1\"<?php is_checked(1, $send_verification); ?>></td>\n\t\t\t\t  <td><label for=\"verification_email\"><?php echo $BL['be_admin_usr_sendemail'] ?></label></td>\n                  <td><img src=\"img/leer.gif\" alt=\"\" width=\"4\" height=\"21\"></td>\n                </tr>\n                <tr><td colspan=\"3\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"6\"></td></tr>\n              </table></td>\n          </tr>\n\n          \t<tr>\n          \t\t<td align=\"right\" class=\"chatlist tdtop6 nowrap\"><?php echo $BL['be_structform_select_cp'] ?>:&nbsp;</td>\n          \t\t<td class=\"checkbox-list v11\">\n          <?php\n          \t\t$has_allowed_cp = isset($set_allowed_cp) ? count($set_allowed_cp) : 0;\n\n\t\t\t\tforeach($wcs_content_type as $key => $value):\n\n\t\t\t\t\t// count used CPs so it is easier to decide if needed or not\n\t\t\t\t\t$used_count = _dbCount('SELECT COUNT(*) FROM '.DB_PREPEND.'phpwcms_articlecontent WHERE acontent_trash=0 AND acontent_type='._dbEscape($key));\n          ?>\n\n          \t\t\t<label>\n          \t\t\t\t<input type=\"checkbox\" name=\"allowed_cp[<?php echo $key ?>]\" value=\"<?php echo $key ?>\"<?php if(!$has_allowed_cp || isset($set_allowed_cp[$key])): ?> checked=\"checked\"<?php endif; ?> />\n          \t\t\t\t<?php echo html($value).' ('.$used_count.')' ?>\n          \t\t\t</label>\n\n          <?php\tendforeach;\t?>\n          \t\t\t<input type=\"hidden\" name=\"cp_total\" value=\"<?php echo count($wcs_content_type) ?>\" />\n          \t\t</td>\n          \t</tr>\n\n\n          <tr>\n            <td>&nbsp;</td>\n            <td class=\"tdbottom10 tdtop6\">\n            \t<input name=\"Submit\" type=\"submit\" class=\"button\" value=\"<?php echo $BL['be_admin_usr_ebutton'] ?>\">\n            \t<input name=\"form_aktion\" type=\"hidden\" value=\"edit_account\" />\n            \t<input name=\"form_uid\" type=\"hidden\" value=\"<?php echo $new_user_id ?>\" />\n            </td>\n          </tr>\n      </table>\n\n\n      </form>\n\n      <img src=\"img/lines/l538_70.gif\" alt=\"\" width=\"538\" height=\"1\"><br />\n      <img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"5\">\n\n      <?php\n\n\n \t} else {\n\n\t\techo \"<script type=\\\"text/JavaScript\\\"> timer=setTimeout(\\\"self.location.href='phpwcms.php'+'?\".CSRF_GET_TOKEN.\"&do=admin'\\\", 0); </script>\";\n\n\t}\n}\n\n?>", "<?php\n/**\n * phpwcms content management system\n *\n * @author Oliver Georgi <og@phpwcms.org>\n * @copyright Copyright (c) 2002-2017, Oliver Georgi\n * @license http://opensource.org/licenses/GPL-2.0 GNU GPL-2\n * @link http://www.phpwcms.org\n *\n **/\n\n// ----------------------------------------------------------------\n// obligate check for phpwcms constants\nif (!defined('PHPWCMS_ROOT')) {\n\tdie(\"You Cannot Access This Script Directly, Have a Nice Day.\");\n}\n// ----------------------------------------------------------------\n\n\t//user group\n\t$GLOBALS['BE']['HEADER']['optionselect.js']\t= getJavaScriptSourceLink('include/inc_js/optionselect.js');\n\n?>\n\n<table width=\"538\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" summary=\"\">\n<tr><td colspan=\"3\" class=\"title\"><?php echo $BL['be_subnav_admin_groups'] ;?></td></tr>\n<tr><td colspan=\"3\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"6\"></td></tr>\n<tr><td colspan=\"3\" bgcolor=\"#92A1AF\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"1\"></td></tr>\n<tr><td colspan=\"3\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"6\"></td></tr>\n\n<?php\n\n\t$bg_color1 = \"#FFFFFF\";\n\t$bg_color2 = \"#F3F5F8\";\n\t$zaehler = 0;\n\tif(empty($new_group_id)) {\n\t\t$new_group_id = 0;\n\t}\n\t//Liste aller Gruppen erzeugen\n\t$result = _dbGet('phpwcms_usergroup', '*', 'group_active != 9', '', 'group_name');\n\n\tif(isset($result[0])) {\n\n\t\tforeach($result as $grouplist) {\n\n\t\t\t$bg_color = ($zaehler % 2) ? $bg_color2 : $bg_color1;\n\n\t\t\tif($grouplist[\"group_id\"] == $new_group_id) {\n\t\t\t\t$bg_color = \"#FFCC00\";\n\t\t\t}\n\n\t\t\t$goto = \"phpwcms.php?do=admin&amp;p=1&amp;s=2&amp;u=\".$grouplist[\"group_id\"];\n\n?>\n        <tr><td colspan=\"3\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"1\"></td></tr>\n        <tr bgcolor=\"<?php echo  $bg_color ?>\" onmouseover=\"bgColor='#DBFF48'\" onmouseout=\"bgColor='<?php echo $bg_color ?>'\">\n          <td width=\"19\" align=\"center\"><img src=\"img/usricon/group_<?php echo $grouplist[\"group_active\"] == 1 ? 'norm' : 'inaktiv'; ?>.gif\" alt=\"\" width=\"19\" height=\"16\" border=\"0\" /></td>\n          <td width=\"458\" class=\"<?php echo $grouplist[\"group_active\"] ? 'dir' : 'inaktiv'; ?>\"><a href=\"<?php echo $goto ?>\"><?php\n\n\t\t \t$grouparray = convertStringToArray($grouplist[\"group_member\"]);\n\t\t  \t$total_member = empty($grouparray[0]) ? 0 : count($grouparray);\n\n\t\t\techo $grouplist[\"group_name\"] ? html($grouplist[\"group_name\"]).' <span style=\"color:#999999;\">('.$total_member.' '.$BL['be_cnt_rssfeed_item'].')</span>' : 'n.a.';\n\n\n\t\t  ?></a></td>\n          <td width=\"61\" align=\"right\"><a href=\"<?php echo $phpwcms['modules']['usergroup']['dir']; ?>include/inc_act/act_usergroup.php?aktiv=<?php\n\n          \techo $grouplist[\"group_id\"].':'.($grouplist[\"group_active\"] ? \"0\" : \"1\");\n\n\t\t\t?>\"><img src=\"img/button/<?php\n\t\t\t\tif(empty($grouplist[\"group_active\"])) echo \"in\";\n\t\t\t?>aktiv_mini.gif\" alt=\"\" width=\"14\" height=\"15\" border=\"0\" /></a><a href=\"<?php echo $goto ?>\"><img src=\"img/button/edit.gif\" alt=\"\" width=\"24\" height=\"15\" border=\"0\" title=\"<?php\n\t\t\t\techo $BL['modules']['usergroup']['be_admin_group_edit'].\": \".html($grouplist[\"group_name\"])\n\t\t\t?>\"></a><a href=\"<?php echo $phpwcms['modules']['usergroup']['dir']; ?>include/inc_act/act_usergroup.php?del=<?php\n\t\t\t\techo urlencode($grouplist[\"group_id\"].\":\".$grouplist[\"group_name\"]);\n\t\t\t?>\" onclick=\"return confirm('Delete group <?php echo js_singlequote($grouplist[\"group_name\"]) ?>');\"><img src=\"img/button/del_message_final.gif\" alt=\"\" width=\"22\" height=\"15\" border=\"0\" title=\"<?php\n\t\t\t\techo $BL['modules']['usergroup']['be_admin_group_ldel'].\" \".html($grouplist[\"group_login\"])\n\t\t\t?>\"></a></td>\n        </tr>\n        <?php\n\n\n\t\t}\n\n\t} else {\n\t\t\techo '<tr><td colspan=\"3\">'.$BL['be_admin_group_nogroup'].': <a href=\"phpwcms.php?do=admin&amp;p=1&amp;create_group=1\">'.$BL['be_admin_group_add'].'</a></td></tr>';\n\n\t}\n\n\t\t?>\n\t\t\t<tr><td colspan=\"3\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"6\"></td></tr>\n\t\t\t<tr><td colspan=\"3\" bgcolor=\"#92A1AF\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"1\"></td></tr>\n\t\t\t<tr><td colspan=\"3\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"8\"></td></tr>\n\t\t\t<tr><td colspan=\"3\"><form action=\"phpwcms.php?do=admin&amp;p=1&amp;create_group=1\" method=\"post\"><input type=\"submit\" value=\"<?php echo $BL['be_admin_group_add'] ?>\" class=\"button\" title=\"<?php echo $BL['be_admin_group_add'] ?>\"></form></td></tr>\n\t\t</table>\n\n<!-- CREATE GROUP -->\n\n\n\t\t  <?php\n\t\t\t//enym was groupid\n\t\t  if(isset($_GET[\"create_group\"]) || isset($_GET[\"u\"])) {\n\t\t  ?>\n\t\t\t<br /><table width=\"538\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" summary=\"\">\n          <tr><td colspan=\"2\" class=\"title\"><?php echo isset($_GET[\"create_group\"]) ? $BL['be_admin_group_add'] : $BL['be_subnav_admin_groups'] .\" \". $BL['be_cnt_guestbook_edit']; ?></td></tr>\n\n\t\t  <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"4\" /></td></tr>\n  \t \t  <tr><td colspan=\"2\"><img src=\"img/lines/l538_70.gif\" alt=\"\" width=\"538\" height=\"1\" /></td>\n    </tr>\n          <tr bgcolor=\"#F0F2F4\"><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"10\" /></td>\n    </tr>\n\t\t  <?php\n\n\t\t  \t$group[\"id\"] \t\t= empty($_GET[\"u\"]) ? 0 : intval($_GET[\"u\"]);\n\t\t  \t$group[\"name\"]\t\t= '';\n\t\t  \t$group[\"member\"]\t= array();\n\t\t  \t$group[\"value\"]\t\t= '';\n\t\t  \t$group[\"trash\"]\t\t= 0;\n\t\t  \t$group[\"active\"]\t= 1;\n\n\t\t\tif($group[\"id\"]) {\n\n\t\t\t\t$sql = \"SELECT * FROM \".DB_PREPEND.\"phpwcms_usergroup WHERE group_id=\".$group[\"id\"].\" LIMIT 1\";\n\n\t\t       \tif($result = mysql_query($sql, $db) or die(\"error while getting group infos\")) {\n\n\t\t\t\t\tif($row = mysql_fetch_array($result)) {\n\t\t\t\t\t\t$group[\"name\"]\t\t= $row[\"group_name\"];\n\t\t\t\t\t\t$group[\"member\"]\t= empty($row[\"group_member\"]) ? array() : explode(',', $row[\"group_member\"]);\n\t\t\t\t\t\t$group[\"value\"]\t\t= $row[\"group_value\"];\n\t\t\t\t\t\t$group[\"trash\"]\t\t= $row[\"group_trash\"];\n            \t\t\t$group[\"active\"]\t= $row[\"group_active\"];\n\t\t\t\t\t}\n\t\t\t\t\tmysql_free_result($result);\n\t\t\t\t}\n\n\t\t\t\t$sendbutton = $BL['be_admin_fcat_button1']; //UPDATE GROUP\n\n\t\t\t} else {\n\n\t\t\t\t$sendbutton = $BL['be_admin_fcat_button2'];   //create group\n\t\t\t}\n\n\t\t\tif(!empty($_POST[\"group_aktion\"])) {\n\n\t\t\t\t$group[\"id\"]\t\t= intval($_POST[\"group_id\"]);\n       \t\t\t$group[\"name\"]\t\t= clean_slweg($_POST[\"group_name\"], 250);\n\t\t\t\t$group[\"member\"]\t= isset($_POST[\"acat_access\"]) && is_array($_POST[\"acat_access\"]) ? implode(',', $_POST[\"acat_access\"]) : '';\n        \t\t$group[\"value\"]\t\t= clean_slweg($_POST[\"group_value\"]);\n\t\t\t\t$group[\"trash\"]\t\t= empty($_POST[\"group_trash\"]) ? 0 : intval($_POST[\"group_trash\"]);\n\t\t\t\t$group[\"active\"]\t= empty($_POST[\"group_active\"]) ? 0 : 1;\n\n\t\t\t\tif(empty($group[\"name\"])) {\n\n\t\t\t\t\t$group[\"error\"] = 1;\n\n\t\t\t\t} else {\n\n\t\t\t\t\t$data = array(\n\n\t\t\t\t\t\t'group_name'\t=> $group[\"name\"],\n\t\t\t\t\t\t'group_member'\t=> $group[\"member\"],\n\t\t\t\t\t\t'group_value'\t=> $group[\"value\"],\n\t\t\t\t\t\t'group_trash'\t=> $group[\"trash\"],\n\t\t\t\t\t\t'group_active'\t=> $group[\"active\"]\n\t\t\t\t\t);\n\n\t\t\t\t\t$result = $group[\"id\"] ? _dbUpdate('phpwcms_usergroup', $data, 'group_id='.$group[\"id\"]) : _dbInsert('phpwcms_usergroup', $data);\n\n\t\t\t\t\tif(isset($result['AFFECTED_ROWS']) || isset($result['INSERT_ID'])) {\n\t\t\t\t\t\theaderRedirect(PHPWCMS_URL.'phpwcms.php?'.get_token_get_string('csrftoken').'&do=admin&p=1');\n\t\t\t\t\t} else {\n\t\t\t\t\t\techo mysql_error();\n\t\t\t\t\t}\n\n\t\t\t\t}\n\n\t\t\t\t$group[\"member\"] = convertStringToArray($group[\"member\"]);\n\n\t\t\t}\n\t\t  ?>\n\n\n\n\t\t  <form action=\"phpwcms.php?do=admin&amp;p=1&amp;create_group=1\" method=\"post\" name=\"editsitestructure\" id=\"editsitestructure\" onsubmit=\"selectAllOptions(this.acat_access);selectAllOptions(this.acat_cp);var x = wordcount(this.acat_name.value);if(x&lt;1) {alert('Fill in a category title! \\n\\n('+x+' words total)');this.acat_name.focus();return false;}\">\n\t\t  <tr align=\"center\" bgcolor=\"#F0F2F4\"><td colspan=\"2\"><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" summary=\"\">\n\t\t  \t<?php if(!empty($group[\"error\"])) { ?>\n\t\t    <tr>\n\t\t      <td align=\"right\" class=\"chatlist\"><font color=\"#FF3300\"><?php echo $BL['be_admin_usr_err'] ?>:</font>&nbsp;</td>\n\t\t      <td class=\"error\"><strong><?php echo $BL['be_fpriv_name'] ?></strong></td>\n\t\t    </tr>\n\t\t\t<tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"3\" /></td>\n\t\t\t</tr>\n\t\t\t<?php } ?>\n\t\t    <tr>\n\t\t      <td align=\"right\" class=\"chatlist\"><?php echo $BL['be_fpriv_name'] ?>:&nbsp;</td>\n\t\t      <td><input name=\"group_name\" type=\"text\" id=\"group_name\" class=\"width400\" value=\"<?php echo  empty($group[\"name\"]) ? '' : html($group[\"name\"]) ?>\" size=\"40\" maxlength=\"250\" /></td>\n\t\t    </tr>\n\n\n\t\t    <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"6\" /></td></tr>\n\n\n\n        <tr>\n\t\t      <td align=\"right\" class=\"chatlist\"><?php echo $BL['be_cnt_description'] ?>:&nbsp;</td>\n\t\t      <td><textarea name=\"group_value\" id=\"group_value\" class=\"width400\" rows=\"3\"><?php echo html($group[\"value\"]) ?></textarea></td>\n\t\t    </tr>\n\n        <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"6\" /></td></tr>\n\n\t\t  <!-- USER RIGHTS enym.com   -->\n\n\t\t<tr>\n    <td align=\"right\" class=\"chatlist\"><?php echo $BL['be_selection'] ?>:&nbsp;</td>\n\n    <td valign=\"top\">\n<?php\n\n// list all available frontend users and put into temp array\n$sql = \"SELECT * FROM \".DB_PREPEND.\"phpwcms_user WHERE usr_aktiv != 9 ORDER BY usr_fe, usr_name, usr_login\";\nif($result = mysql_query($sql, $db) or die(\"error while listing frontend users\")) {\n\t$_temp_usr = array();\n\twhile($row = mysql_fetch_assoc($result)) {\n\t\t$_temp_usr[$row['usr_id']]['name']   = html($row['usr_name']);\n\t\t$_temp_usr[$row['usr_id']]['login']  = html($row['usr_login']);\n\t\t$_temp_usr[$row['usr_id']]['fe']     = $row['usr_fe'];\n\t\t$_temp_usr[$row['usr_id']]['active'] = $row['usr_aktiv'];\n\t\t$_temp_usr[$row['usr_id']]['admin'] = $row['usr_admin'];\n\t}\n\tmysql_free_result($result);\n}\n\n?>\n\t\t\t<table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\n              <tr>\n                <td><select name=\"acat_access[]\" id=\"acat_access\" size=\"12\" multiple=\"multiple\" class=\"width185\" onDblClick=\"moveSelectedOptions(document.editsitestructure.acat_access,document.editsitestructure.acat_feusers,true);\">\n<?php\n\n// list all fe_users\nforeach($_temp_usr as $key => $value) {\n\tif (isset($group[\"member\"]) && empty($group[\"error\"])) {\n    if(in_array($key, $group[\"member\"])) {\n  \t\techo '<option value=\"'.$key.'\"';\n  \t\tif(!$_temp_usr[$key]['active']) {\n  \t\t\techo ' style=\"color:#999999;\"';\n  \t\t} else if($_temp_usr[$key]['admin']) {\n  \t\t\techo ' style=\"color:#3F61BF;\"';\n  \t\t}\n  \t\techo '>'.trim($_temp_usr[$key]['name']. ' ('.$_temp_usr[$key]['login'].')').\"</option>\\n\";\n  \t\tunset($_temp_usr[$key]);\n  \t}\n  }\n}\n\n?>\n\t\t</select></td>\n                <td valign=\"top\" style=\"padding-left:5px;padding-right:5px;\"><img src=\"img/button/put_left.gif\" width=\"15\" height=\"15\" title=\"<?php echo $BL['be_admin_struct_adduser_all']?>\" onClick=\"moveAllOptions(document.editsitestructure.acat_feusers,document.editsitestructure.acat_access);selectAllOptions(document.editsitestructure.acat_access);\"><br><img src=\"img/leer.gif\" width=\"1\" height=\"3\"><br><img src=\"img/button/put_left_a.gif\" width=\"15\" height=\"15\" title=\"<?php echo $BL['be_admin_struct_adduser_this']?>\" onClick=\"moveSelectedOptions(document.editsitestructure.acat_feusers,document.editsitestructure.acat_access,true);selectAllOptions(document.editsitestructure.acat_access);\"><br><img src=\"img/leer.gif\" width=\"1\" height=\"6\"><br><img src=\"img/button/put_right_a.gif\" width=\"15\" height=\"15\" title=\"<?php echo $BL['be_admin_struct_remove_this']?>\" onClick=\"moveSelectedOptions(document.editsitestructure.acat_access,document.editsitestructure.acat_feusers,true);\"><br><img src=\"img/leer.gif\" width=\"1\" height=\"3\"><br><img src=\"img/button/put_right.gif\" width=\"15\" height=\"15\" title=\"<?php echo $BL['be_admin_struct_remove_all']?>\" onClick=\"moveAllOptions(document.editsitestructure.acat_access,document.editsitestructure.acat_feusers);\"></td>\n                <td><select name=\"acat_feusers\" size=\"12\" multiple=\"multiple\" id=\"acat_feusers\" class=\"width185\" onDblClick=\"moveSelectedOptions(document.editsitestructure.acat_feusers,document.editsitestructure.acat_access,true);selectAllOptions(document.editsitestructure.acat_access);\">\n<?php\n\n// list all available fe_users\nif(isset($_temp_usr) && is_array($_temp_usr)) {\n\tforeach($_temp_usr as $key => $value) {\n\t\techo '<option value=\"'.$key.'\"';\n\t\tif(!$_temp_usr[$key]['active']) {\n\t\t\techo ' style=\"color:#999999\"';\n\t\t} else if($_temp_usr[$key]['admin']) {\n\t\t\techo ' style=\"color:#3F61BF\"';\n\t\t}\n\t\techo '>'.trim($_temp_usr[$key]['name']. ' ('.$_temp_usr[$key]['login'].')').\"</option>\\n\";\n\t}\n}\n\n?>\n\t\t</select></td>\n              </tr>\n            </table></td>\n          </tr>\n\n\n\n     <!-- USER RIGHTS -->\n\n\n\n\n\n\n\t\t\t<tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"6\" /></td></tr>\n\t\t    <tr>\n\t\t      <td align=\"right\" class=\"chatlist\"><?php echo $BL['be_ftptakeover_status'] ?>:&nbsp;</td>\n\t\t      <td><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" bgcolor=\"#D9DEE3\" summary=\"\">\n               <tr>\n                  <td><input name=\"group_active\" type=\"checkbox\" id=\"group_active\" value=\"1\"<?php is_checked(1, empty($group[\"active\"]) ? 0 : $group[\"active\"]); ?> /></td>\n                  <td><label for=\"group_active\"><?php echo $BL['be_ftptakeover_active'] ?></label>&nbsp;&nbsp;</td>\n                </tr>\n              </table></td>\n\t\t      </tr>\n\t\t    <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"10\" /></td>\n\t\t    </tr>\n\t\t    <tr>\n\t\t      <td>\n\t\t\t  &nbsp;\n\t\t\t  <input name=\"group_id\" type=\"hidden\" id=\"group_id\" value=\"<?php echo $group[\"id\"] ?>\" />\n\t\t\t  <input name=\"group_aktion\" type=\"hidden\" id=\"group_aktion\" value=\"1\" />\n\t\t\t  </td>\n\t\t      <td>\n\t\t\t  <input name=\"Submit\" type=\"submit\" class=\"button\" value=\"<?php echo $sendbutton ?>\" />\n\t\t      &nbsp;&nbsp;\n\t\t      <input name=\"donotsubmit\" type=\"button\" class=\"button\" value=\"<?php echo $BL['be_admin_fcat_exit'] ?>\" onclick=\"location.href='phpwcms.php?do=admin&amp;p=1';\" /></td>\n\t\t      </tr>\n\t\t    </table></td>\n\t\t  </tr>\n\t\t  <tr bgcolor=\"#F0F2F4\"><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"15\" /></td>\n\t\t  </tr>\n\t\t  </form>\n      </table>\n<?php\n\t\t  }\n?>", "<?php\n/**\n * phpwcms content management system\n *\n * @author Oliver Georgi <og@phpwcms.org>\n * @copyright Copyright (c) 2002-2017, Oliver Georgi\n * @license http://opensource.org/licenses/GPL-2.0 GNU GPL-2\n * @link http://www.phpwcms.org\n *\n **/\n\n// ----------------------------------------------------------------\n// obligate check for phpwcms constants\nif (!defined('PHPWCMS_ROOT')) {\n\tdie(\"You Cannot Access This Script Directly, Have a Nice Day.\");\n}\n// ----------------------------------------------------------------\n\n\n$new_login \t\t\t= genlogname();\n$new_password \t\t= generic_string(8);\n$new_email\t\t\t= '';\n$new_name\t\t\t= '';\n$set_user_aktiv \t= 0;\n$set_user_admin \t= 0;\n$set_user_fe\t\t= 0;\n$send_verification\t= 1;\n$user_err\t\t\t= '';\n\nif(isset($_POST[\"form_aktion\"]) && $_POST[\"form_aktion\"] == \"create_account\") {\n\t//Create Account Daten verarbeiten\n\t$new_login \t\t\t= slweg($_POST[\"form_newloginname\"]);\n\t$new_password \t\t= slweg($_POST[\"form_newpassword\"]);\n\t$new_email \t\t\t= clean_slweg($_POST[\"form_newemail\"]);\n\t$new_name \t\t\t= clean_slweg($_POST[\"form_newrealname\"]);\n\t$set_user_aktiv \t= isset($_POST[\"form_active\"]) ? 1 : 0;\n\t$set_user_admin \t= isset($_POST[\"form_admin\"]) ? 1 : 0;\n\t$set_user_fe \t\t= isset($_POST[\"form_feuser\"]) ? intval($_POST[\"form_feuser\"]) : 0;\n\tif($set_user_admin) {\n\t\t$set_user_fe \t= 2;\n\t}\n\t$send_verification \t= isset($_POST[\"verification_email\"]) ? 1 : 0;\n\tif(str_empty($new_login)) {\n\t\t$user_err = $BL['be_admin_usr_err2'].\"\\n\";\n\t} else {\n\t\t$sql = \"SELECT COUNT(*) AS anzahl FROM \".DB_PREPEND.\"phpwcms_user WHERE usr_login='\".aporeplace($new_login).\"'\";\n\t\tif($result = mysql_query($sql, $db)) {\n\t\t\tif($check_anzahl = mysql_fetch_array($result)) {\n\t\t\t\tif($check_anzahl[\"anzahl\"]) $user_err .= $BL['be_admin_usr_err1'].\"\\n\";\n\t\t\t}\n\t\t\tmysql_free_result($result);\n\t\t}\n\t}\n\tif(str_empty($new_password)) $user_err .= $BL['be_admin_usr_err3'].\"\\n\";\n\tif(!is_valid_email($new_email) && $send_verification) $user_err .= $BL['be_admin_usr_err4'].\"\\n\";\n\tif(empty($user_err)) { //Insert new User\n\t\t$sql =\t\"INSERT INTO \".DB_PREPEND.\"phpwcms_user (usr_login, usr_pass, usr_email, \".\n\t\t\t\t\"usr_admin, usr_aktiv, usr_name, usr_wysiwyg, usr_fe ) VALUES ('\".\n\t\t\t\taporeplace($new_login).\"', '\".\n\t\t\t\taporeplace(md5(makeCharsetConversion($new_password, PHPWCMS_CHARSET, 'utf-8'))).\"', '\".\n\t\t\t\taporeplace($new_email).\"', '\".\n\t\t\t\t$set_user_admin.\"', '\".\n\t\t\t\t$set_user_aktiv.\"', '\".\n\t\t\t\taporeplace($new_name).\"', 1, '\".\n\t\t\t\t$set_user_fe.\"')\";\n\t\tif(mysql_query($sql, $db) or die('error while creating new user')) {\n\t\t\t$new_user_id = mysql_insert_id($db);\n\t\t\t$user_ok = 1;\n\t\t\tif($send_verification) {\n\t\t\t\t$emailbody = str_replace('{LOGIN}', $new_login, $BL['be_admin_usr_mailbody']);\n\t\t\t\t$emailbody = str_replace('{PASSWORD}', $new_password, $emailbody);\n\t\t\t\t$emailbody = str_replace('{SITE}', PHPWCMS_URL, $emailbody);\n\t\t\t\t$emailbody = str_replace('{LOGIN_PAGE}', PHPWCMS_URL.get_login_file(), $emailbody);\n\n\t\t\t\tsendEmail(\tarray(\n\t\t\t\t\t'recipient'\t=> $new_email,\n\t\t\t\t\t'toName'\t=> $new_name,\n\t\t\t\t\t'subject'\t=> $BL['be_admin_usr_mailsubject'],\n\t\t\t\t\t'isHTML'\t=> 0,\n\t\t\t\t\t'text'\t\t=> $emailbody,\n\t\t\t\t\t'from'\t\t=> $phpwcms[\"admin_email\"],\n\t\t\t\t\t'sender'\t=> $phpwcms[\"admin_email\"]\n\t\t\t\t));\n\t\t\t}\n\t\t}\n\t}\n}\n\nif(empty($user_ok)) {\n\n?><form action=\"phpwcms.php?do=admin&amp;s=1\" method=\"post\" name=\"edituser\"><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" summary=\"\">\n          <tr>\n            <td colspan=\"2\"><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" summary=\"\">\n                <tr>\n                  <td><img src=\"img/usricon/usr_add.gif\" alt=\"\" width=\"19\" height=\"16\"></td>\n                  <td class=\"title\">&nbsp;<?php echo $BL['be_admin_usr_title'] ?></td>\n                </tr>\n              </table></td>\n          </tr>\n          <tr>\n            <td><img src=\"img/leer.gif\" alt=\"\" width=\"105\" height=\"1\"></td>\n            <td><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"5\"></td>\n          </tr>\n\t\t  <?php\n\t\t  if(!empty($user_err)) {\n\t\t  ?>\n          <tr valign=\"top\">\n            <td align=\"right\"><strong style=\"color:#FF3300\"><?php echo $BL['be_admin_usr_err'] ?>:</strong>&nbsp;</td>\n            <td><strong style=\"color:#FF3300\"><?php echo nl2br(chop($user_err)) ?></strong></td>\n          </tr>\n          <tr valign=\"top\"><td colspan=\"2\" align=\"right\" class=\"chatlist\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"7\"></td></tr>\n\t\t  <?php\n\t\t  } //Ende Fehler New User\n\t\t  ?>\n          <tr>\n            <td align=\"right\" class=\"chatlist\"><?php echo $BL[\"login_username\"]  ?>:&nbsp;</td>\n            <td><input name=\"form_newloginname\" type=\"text\" id=\"form_newloginname\" style=\"font-family: Verdana, Arial, Helvetica, sans-serif; width:250px; font-size: 11px; font-weight: bold;\" value=\"<?php echo $new_login ?>\" size=\"30\" maxlength=\"30\" autocomplete=\"off\"></td>\n          </tr>\n          <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"1\"></td></tr>\n          <tr>\n            <td align=\"right\" class=\"chatlist\"><?php echo $BL[\"login_userpass\"] ?>:&nbsp;</td>\n            <td><input name=\"form_newpassword\" type=\"text\" id=\"form_newpassword\" style=\"font-family: Verdana, Arial, Helvetica, sans-serif; width:250px; font-size: 11px; font-weight: bold;\" value=\"<?php echo $new_password ?>\" size=\"30\" maxlength=\"50\" autocomplete=\"off\"></td>\n          </tr>\n          <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"1\"></td></tr>\n          <tr>\n            <td align=\"right\" class=\"chatlist\"><?php echo $BL['be_profile_label_email'] ?>:&nbsp;</td>\n            <td><input name=\"form_newemail\" type=\"text\" id=\"form_newemail\" style=\"font-family: Verdana, Arial, Helvetica, sans-serif; width:250px; font-size: 11px; font-weight: bold;\" value=\"<?php echo $new_email ?>\" size=\"30\" maxlength=\"150\"></td>\n          </tr>\n          <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"1\"></td></tr>\n          <tr>\n            <td align=\"right\" class=\"chatlist\"><?php echo $BL['be_admin_usr_realname'] ?>:&nbsp;</td>\n            <td><input name=\"form_newrealname\" type=\"text\" id=\"form_newrealname\" style=\"font-family: Verdana, Arial, Helvetica, sans-serif; width:250px; font-size: 11px; font-weight: bold;\" value=\"<?php echo $new_name ?>\" size=\"30\" maxlength=\"80\"></td>\n          </tr>\n\n\t\t  <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"6\"></td></tr>\n          <tr>\n            <td align=\"right\" class=\"chatlist\"><?php echo $BL['be_admin_usr_issection']  ?>:&nbsp;</td>\n            <td><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" bgcolor=\"#E7E8EB\" summary=\"\">\n                <tr>\n                  <td><input name=\"form_feuser\" type=\"radio\" id=\"form_feuser0\" value=\"0\"<?php is_checked($set_user_fe, 0); ?>></td>\n                  <td><label for=\"form_feuser0\"><?php echo $BL['be_admin_usr_ifsection0'] ?></label>&nbsp;&nbsp;</td>\n\t\t\t\t  <td><input name=\"form_feuser\" type=\"radio\" id=\"form_feuser1\" value=\"1\"<?php is_checked($set_user_fe, 1); ?>></td>\n                  <td><label for=\"form_feuser1\"><?php echo $BL['be_admin_usr_ifsection1'] ?></label>&nbsp;&nbsp;</td>\n\t\t\t\t  <td><input name=\"form_feuser\" type=\"radio\" id=\"form_feuser2\" value=\"2\"<?php is_checked($set_user_fe, 2); ?>></td>\n                  <td><label for=\"form_feuser2\"><?php echo $BL['be_admin_usr_ifsection2'] ?></label></td>\n\t\t\t\t  <td><img src=\"img/leer.gif\" alt=\"\" width=\"4\" height=\"21\"></td>\n                </tr>\n              </table></td>\n          </tr>\n\n          <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"6\"></td></tr>\n          <tr>\n            <td align=\"right\" class=\"chatlist\"><?php echo $BL['be_admin_usr_setactive'] ?>:&nbsp;</td>\n            <td><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" summary=\"\">\n                <tr>\n                  <td><input name=\"form_active\" type=\"checkbox\" id=\"form_active\" value=\"1\"<?php is_checked($set_user_aktiv, 1); ?>></td>\n                  <td><label for=\"form_active\"><?php echo  $BL['be_admin_usr_iflogin'] ?></label></td>\n                </tr>\n              </table></td>\n          </tr>\n\n          <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"1\"></td></tr>\n          <tr>\n            <td align=\"right\" class=\"chatlist\" style=\"color:#FF0000\"><?php echo $BL['be_admin_usr_isadmin']  ?>:&nbsp;</td>\n            <td><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" summary=\"\">\n                <tr>\n                  <td><input name=\"form_admin\" type=\"checkbox\" id=\"form_admin\" value=\"1\"<?php is_checked($set_user_admin, 1); ?>></td>\n                  <td><label for=\"form_admin\"><?php echo  $BL['be_admin_usr_ifadmin'] ?> <strong style=\"color:#FF0000\">!!!</strong></label></td>\n                </tr>\n              </table></td>\n          </tr>\n          <tr>\n            <td align=\"right\" class=\"chatlist\"><?php echo $BL['be_admin_usr_verify'] ?>:&nbsp;</td>\n            <td><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" summary=\"\">\n                <tr><td colspan=\"3\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"6\"></td></tr>\n                <tr bgcolor=\"#E7E8EB\">\n                  <td><input name=\"verification_email\" type=\"checkbox\" id=\"verification_email\" value=\"1\"<?php is_checked($send_verification, 1); ?>></td>\n                  <td><label for=\"verification_email\"><?php echo $BL['be_admin_usr_sendemail'] ?></label></td>\n                  <td><img src=\"img/leer.gif\" alt=\"\" width=\"4\" height=\"21\"></td>\n                </tr>\n                <tr><td colspan=\"3\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"6\"></td></tr>\n              </table></td>\n          </tr>\n          <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"6\"><input name=\"form_aktion\" type=\"hidden\" value=\"create_account\"></td></tr>\n          <tr>\n            <td>&nbsp;</td>\n            <td><input name=\"Submit\" type=\"submit\" class=\"button\" value=\"<?php echo $BL['be_admin_usr_button'] ?>\"></td>\n          </tr>\n          <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"15\"></td></tr>\n      </table></form><img src=\"img/lines/l538_70.gif\" alt=\"\" width=\"538\" height=\"1\"><br /><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"5\"><?php\n\n\n} else {\n\techo \"<script type=\\\"text/javascript\\\"> timer=setTimeout(\\\"self.location.href='phpwcms.php'+'?\".CSRF_GET_TOKEN.\"&do=admin'\\\", 0); </script>\";\n}\n\n?>"], "fixing_code": ["<?php\n/**\n * phpwcms content management system\n *\n * @author Oliver Georgi <og@phpwcms.org>\n * @copyright Copyright (c) 2002-2017, Oliver Georgi\n * @license http://opensource.org/licenses/GPL-2.0 GNU GPL-2\n * @link http://www.phpwcms.org\n *\n **/\n\ndefine('PHPWCMS_VERSION', '1.8.9');\ndefine('PHPWCMS_RELEASE_DATE', '2017/10/23');\ndefine('PHPWCMS_REVISION', '547');\n", "<?php\n/**\n * phpwcms content management system\n *\n * @author Oliver Georgi <og@phpwcms.org>\n * @copyright Copyright (c) 2002-2017, Oliver Georgi\n * @license http://opensource.org/licenses/GPL-2.0 GNU GPL-2\n * @link http://www.phpwcms.org\n *\n **/\n\n// ----------------------------------------------------------------\n// obligate check for phpwcms constants\nif (!defined('PHPWCMS_ROOT')) {\n    die(\"You Cannot Access This Script Directly, Have a Nice Day.\");\n}\n// ----------------------------------------------------------------\n\nif(isset($_GET[\"u\"]) && intval($_GET[\"u\"])) {\n\n    if(empty($_POST[\"form_aktion\"]) || $_POST[\"form_aktion\"] != \"edit_account\") {\n        $new_user_id = intval($_GET[\"u\"]);\n        $sql = \"SELECT * FROM \".DB_PREPEND.\"phpwcms_user WHERE usr_id=\".$new_user_id.\" AND usr_aktiv<>9\";\n        $result = _dbQuery($sql);\n        if(isset($result[0]['usr_id'])) {\n            $new_login = $result[0][\"usr_login\"];\n            $new_email = $result[0][\"usr_email\"];\n            $new_name = $result[0][\"usr_name\"];\n            $set_user_aktiv = $result[0][\"usr_aktiv\"];\n            $set_user_admin = $result[0][\"usr_admin\"];\n            $set_user_fe    = $result[0][\"usr_fe\"];\n            $set_user_var   = @unserialize($result[0][\"usr_vars\"]);\n            $send_verification = 0;\n            $new_password = '';\n        }\n    }\n\n    $set_allowed_cp = isset($set_user_var['allowed_cp']) && is_array($set_user_var['allowed_cp']) ? $set_user_var['allowed_cp'] : array();\n\n    if(isset($_POST[\"form_aktion\"]) && $_POST[\"form_aktion\"] == \"edit_account\") {\n\n        // Handle account data\n\n        $new_user_id = intval($_POST[\"form_uid\"]);\n        $new_login = slweg($_POST[\"form_newloginname\"]);\n        $new_password = slweg($_POST[\"form_newpassword\"]);\n        $new_email = clean_slweg($_POST[\"form_newemail\"]);\n        $new_name = clean_slweg($_POST[\"form_newrealname\"]);\n        $set_user_aktiv = isset($_POST[\"form_active\"]) ? 1 : 0;\n        $set_user_admin = isset($_POST[\"form_admin\"]) ? 1 : 0;\n        $set_user_fe = isset($_POST[\"form_feuser\"]) ? intval($_POST[\"form_feuser\"]) : 0;\n        $set_allowed_cp = isset($_POST[\"allowed_cp\"]) && is_array($_POST[\"allowed_cp\"]) && count($_POST[\"allowed_cp\"]) ? $_POST[\"allowed_cp\"] : array();\n        $set_allowed_cp_total = count($set_allowed_cp);\n        $cp_total = empty($_POST[\"cp_total\"]) ? 0 : intval($_POST[\"cp_total\"]);\n        if(!$set_allowed_cp_total || $cp_total == $set_allowed_cp_total) {\n            $set_allowed_cp = array();\n        }\n        if($set_user_admin) {\n            $set_user_fe = 2;\n        }\n        $send_verification = isset($_POST[\"verification_email\"]) ? 1 : 0;\n        $user_err = '';\n        if(empty($new_login)) {\n            $user_err = $BL['be_admin_usr_err2'].\"\\n\";\n        } else {\n            $sql = \"SELECT usr_id, usr_vars, COUNT(*) AS anzahl FROM \".DB_PREPEND.\"phpwcms_user WHERE usr_login='\".aporeplace($new_login).\"' GROUP BY usr_id\";\n            $result = _dbQuery($sql);\n            if(isset($result[0]['anzahl'])) {\n\n                if($result[0][\"usr_id\"] != $new_user_id && $result[0][\"anzahl\"]) {\n                    $user_err .= $BL['be_admin_usr_err1'].\"\\n\";\n                }\n\n                if(empty($user_err)) {\n                    $set_user_var = @unserialize($result[0][\"usr_vars\"]);\n                    if(!is_array($set_user_var)) {\n                        $set_user_var = array();\n                    }\n                    $set_user_var['allowed_cp'] = $set_allowed_cp;\n                }\n\n            }\n        }\n\n        if(!is_valid_email($new_email)) {\n            $user_err .= $BL['be_admin_usr_err4'].\"\\n\";\n        }\n        if(empty($user_err)) { //Insert new User\n\n            $sql =  \"UPDATE \".DB_PREPEND.\"phpwcms_user SET usr_login='\".aporeplace($new_login).\"', \";\n            if($new_password) {\n                $sql .= \"usr_pass='\".aporeplace(md5(makeCharsetConversion($new_password, PHPWCMS_CHARSET, 'utf-8'))).\"', \";\n            }\n            $sql .= \"usr_email='\".aporeplace($new_email).\"', \".\n                    \"usr_admin='\".$set_user_admin.\"', \".\n                    \"usr_aktiv='\".$set_user_aktiv.\"', \".\n                    \"usr_name='\".aporeplace($new_name).\"', \";\n            if(isset($set_user_var['allowed_cp'])) {\n                $sql .= \"usr_vars=\"._dbEscape(serialize($set_user_var)).\", \";\n            }\n            $sql .= \"usr_fe='\".$set_user_fe.\"' WHERE usr_id=\".$new_user_id;\n            $result = _dbQuery($sql, 'UPDATE');\n            if(isset($result['AFFECTED_ROWS'])) {\n                $user_ok = 1;\n                $new_user_id = NULL;\n                if($send_verification) {\n                    $emailbody = str_replace('{LOGIN}',         $new_login, $BL['be_admin_usr_emailbody']);\n                    $emailbody = str_replace('{PASSWORD}',      (($new_password) ? $new_password : $BL['be_admin_usr_passnochange']), $emailbody);\n                    $emailbody = str_replace('{SITE}',          PHPWCMS_URL, $emailbody);\n                    $emailbody = str_replace('{LOGIN_PAGE}',    PHPWCMS_URL.get_login_file(), $emailbody);\n\n                    sendEmail(array(\n                        'recipient' => $new_email,\n                        'toName'    => $new_name,\n                        'subject'   => $BL['be_admin_usr_mailsubject'],\n                        'isHTML'    => 0,\n                        'text'      => $emailbody,\n                        'from'      => $phpwcms[\"admin_email\"],\n                        'sender'    => $phpwcms[\"admin_email\"]\n                    ));\n                }\n            }\n        }\n    }\n\n    if(empty($user_ok)) {\n\n?><form action=\"phpwcms.php?do=admin&amp;s=2&amp;u=<?php echo $new_user_id ?>\" method=\"post\" name=\"edituser\"><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" summary=\"\">\n\n          <tr><td colspan=\"2\" class=\"title\"><?php echo $BL['be_admin_usr_etitle'] ?></td></tr>\n          <tr>\n            <td><img src=\"img/leer.gif\" alt=\"\" width=\"105\" height=\"1\"></td>\n            <td><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"7\"></td>\n          </tr>\n          <?php\n          if(!empty($user_err)) {\n          ?>\n          <tr valign=\"top\">\n            <td align=\"right\" class=\"error\"><strong><?php echo $BL['be_admin_usr_err'] ?>:</strong>&nbsp;</td>\n            <td class=\"error\"><strong><?php echo nl2br(chop($user_err)) ?></strong></td>\n          </tr>\n          <tr valign=\"top\"><td colspan=\"2\" align=\"right\" class=\"chatlist\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"7\"></td></tr>\n          <?php\n          } //Ende Fehler New User\n          ?>\n          <tr>\n            <td align=\"right\" class=\"chatlist\"><?php echo $BL[\"login_username\"]  ?>:&nbsp;</td>\n            <td><input name=\"form_newloginname\" type=\"text\" id=\"form_newloginname\" class=\"width250\" value=\"<?php echo html($new_login); ?>\" size=\"30\" maxlength=\"200\" autocomplete=\"off\" /></td>\n          </tr>\n          <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"1\"></td></tr>\n          <tr>\n            <td align=\"right\" class=\"chatlist\"><?php echo $BL[\"login_userpass\"] ?>:&nbsp;</td>\n            <td><input name=\"form_newpassword\" type=\"text\" id=\"form_newpassword\" class=\"width250\" value=\"<?php echo html($new_password); ?>\" size=\"30\" maxlength=\"200\" autocomplete=\"off\" /></td>\n          </tr>\n          <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"1\"></td></tr>\n          <tr>\n            <td align=\"right\" class=\"chatlist\"><?php echo $BL['be_profile_label_email'] ?>:&nbsp;</td>\n            <td><input name=\"form_newemail\" type=\"text\" id=\"form_newemail\" class=\"width250\" value=\"<?php echo html($new_email); ?>\" size=\"30\" maxlength=\"250\" autocomplete=\"off\" /></td>\n          </tr>\n          <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"1\"></td></tr>\n          <tr>\n            <td align=\"right\" class=\"chatlist\"><?php echo $BL['be_admin_usr_realname'] ?>:&nbsp;</td>\n            <td><input name=\"form_newrealname\" type=\"text\" id=\"form_newrealname\" class=\"width250\" value=\"<?php echo html($new_name); ?>\" size=\"30\" maxlength=\"200\" autocomplete=\"off\" /></td>\n          </tr>\n\n          <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"6\"></td></tr>\n          <tr>\n            <td align=\"right\" class=\"chatlist\"><?php echo $BL['be_admin_usr_issection']  ?>:&nbsp;</td>\n            <td><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" bgcolor=\"#E7E8EB\" summary=\"\">\n                <tr>\n                  <td><input name=\"form_feuser\" type=\"radio\" id=\"form_feuser0\" value=\"0\"<?php is_checked($set_user_fe, 0); ?> /></td>\n                  <td><label for=\"form_feuser0\"><?php echo $BL['be_admin_usr_ifsection0'] ?></label>&nbsp;&nbsp;</td>\n                  <td><input name=\"form_feuser\" type=\"radio\" id=\"form_feuser1\" value=\"1\"<?php is_checked($set_user_fe, 1); ?> /></td>\n                  <td><label for=\"form_feuser1\"><?php echo $BL['be_admin_usr_ifsection1'] ?></label>&nbsp;&nbsp;</td>\n                  <td><input name=\"form_feuser\" type=\"radio\" id=\"form_feuser2\" value=\"2\"<?php is_checked($set_user_fe, 2); ?> /></td>\n                  <td><label for=\"form_feuser2\"><?php echo $BL['be_admin_usr_ifsection2'] ?></label></td>\n                  <td><img src=\"img/leer.gif\" alt=\"\" width=\"4\" height=\"21\"></td>\n                </tr>\n              </table></td>\n          </tr>\n\n          <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"6\"></td></tr>\n          <tr>\n            <td align=\"right\" class=\"chatlist\"><?php echo $BL['be_admin_usr_setactive'] ?>:&nbsp;</td>\n            <td><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" summary=\"\">\n                <tr>\n                  <td><input name=\"form_active\" type=\"checkbox\" id=\"form_active\" value=\"1\"<?php is_checked($set_user_aktiv, 1); ?> /></td>\n                  <td><label for=\"form_active\"><?php echo $BL['be_admin_usr_iflogin'] ?></label></td>\n                </tr>\n              </table></td>\n          </tr>\n\n          <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"1\"></td></tr>\n          <tr>\n            <td align=\"right\" class=\"chatlist\" style=\"color:#FF0000\"><?php echo $BL['be_admin_usr_isadmin'] ?>:&nbsp;</td>\n            <td><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" summary=\"\">\n                <tr>\n                  <td><input name=\"form_admin\" type=\"checkbox\" id=\"form_admin\" value=\"1\"<?php is_checked(1, $set_user_admin); ?> /></td>\n                  <td><label for=\"form_admin\"><?php echo $BL['be_admin_usr_ifadmin'] ?> <strong class=\"error\">!!!</strong></label></td>\n                </tr>\n              </table></td>\n          </tr>\n          <tr>\n            <td align=\"right\" class=\"chatlist\"><?php echo $BL['be_admin_usr_verify'] ?>:&nbsp;</td>\n            <td><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" summary=\"\">\n                <tr><td colspan=\"3\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"6\"></td></tr>\n                <tr bgcolor=\"#E7E8EB\">\n                  <td><input name=\"verification_email\" type=\"checkbox\" id=\"verification_email\" value=\"1\"<?php is_checked(1, $send_verification); ?> /></td>\n                  <td><label for=\"verification_email\"><?php echo $BL['be_admin_usr_sendemail'] ?></label></td>\n                  <td><img src=\"img/leer.gif\" alt=\"\" width=\"4\" height=\"21\"></td>\n                </tr>\n                <tr><td colspan=\"3\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"6\"></td></tr>\n              </table></td>\n          </tr>\n\n            <tr>\n                <td align=\"right\" class=\"chatlist tdtop6 nowrap\"><?php echo $BL['be_structform_select_cp'] ?>:&nbsp;</td>\n                <td class=\"checkbox-list v11\">\n          <?php\n                $has_allowed_cp = isset($set_allowed_cp) ? count($set_allowed_cp) : 0;\n\n                foreach($wcs_content_type as $key => $value):\n\n                    // count used CPs so it is easier to decide if needed or not\n                    $used_count = _dbCount('SELECT COUNT(*) FROM '.DB_PREPEND.'phpwcms_articlecontent WHERE acontent_trash=0 AND acontent_type='._dbEscape($key));\n          ?>\n\n                    <label>\n                        <input type=\"checkbox\" name=\"allowed_cp[<?php echo $key ?>]\" value=\"<?php echo $key ?>\"<?php if(!$has_allowed_cp || isset($set_allowed_cp[$key])): ?> checked=\"checked\"<?php endif; ?> />\n                        <?php echo html($value).' ('.$used_count.')' ?>\n                    </label>\n\n          <?php endforeach; ?>\n                    <input type=\"hidden\" name=\"cp_total\" value=\"<?php echo count($wcs_content_type) ?>\" />\n                </td>\n            </tr>\n\n\n          <tr>\n            <td>&nbsp;</td>\n            <td class=\"tdbottom10 tdtop6\">\n                <input name=\"Submit\" type=\"submit\" class=\"button\" value=\"<?php echo $BL['be_admin_usr_ebutton'] ?>\" />\n                <input name=\"form_aktion\" type=\"hidden\" value=\"edit_account\" />\n                <input name=\"form_uid\" type=\"hidden\" value=\"<?php echo html($new_user_id) ?>\" />\n            </td>\n          </tr>\n      </table>\n\n\n      </form>\n\n      <img src=\"img/lines/l538_70.gif\" alt=\"\" width=\"538\" height=\"1\"><br />\n      <img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"5\">\n\n      <?php\n\n\n    } else {\n\n        echo \"<script type=\\\"text/JavaScript\\\"> timer=setTimeout(\\\"self.location.href='phpwcms.php'+'?\".CSRF_GET_TOKEN.\"&do=admin'\\\", 0); </script>\";\n\n    }\n}\n", "<?php\n/**\n * phpwcms content management system\n *\n * @author Oliver Georgi <og@phpwcms.org>\n * @copyright Copyright (c) 2002-2017, Oliver Georgi\n * @license http://opensource.org/licenses/GPL-2.0 GNU GPL-2\n * @link http://www.phpwcms.org\n *\n **/\n\n// ----------------------------------------------------------------\n// obligate check for phpwcms constants\nif (!defined('PHPWCMS_ROOT')) {\n    die(\"You Cannot Access This Script Directly, Have a Nice Day.\");\n}\n// ----------------------------------------------------------------\n\n//user group\n$GLOBALS['BE']['HEADER']['optionselect.js'] = getJavaScriptSourceLink('include/inc_js/optionselect.js');\n\n?>\n\n<table width=\"538\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" summary=\"\">\n<tr><td colspan=\"3\" class=\"title\"><?php echo $BL['be_subnav_admin_groups'] ;?></td></tr>\n<tr><td colspan=\"3\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"6\"></td></tr>\n<tr><td colspan=\"3\" bgcolor=\"#92A1AF\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"1\"></td></tr>\n<tr><td colspan=\"3\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"6\"></td></tr>\n\n<?php\n\n    $bg_color1 = \"#FFFFFF\";\n    $bg_color2 = \"#F3F5F8\";\n    $zaehler = 0;\n    if(empty($new_group_id)) {\n        $new_group_id = 0;\n    }\n    //Liste aller Gruppen erzeugen\n    $result = _dbGet('phpwcms_usergroup', '*', 'group_active != 9', '', 'group_name');\n\n    if(isset($result[0]['group_id'])) {\n\n        foreach($result as $grouplist) {\n\n            $bg_color = ($zaehler % 2) ? $bg_color2 : $bg_color1;\n\n            if($grouplist[\"group_id\"] == $new_group_id) {\n                $bg_color = \"#FFCC00\";\n            }\n\n            $goto = \"phpwcms.php?do=admin&amp;p=1&amp;s=2&amp;u=\".$grouplist[\"group_id\"];\n\n?>\n        <tr><td colspan=\"3\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"1\"></td></tr>\n        <tr bgcolor=\"<?php echo  $bg_color ?>\" onmouseover=\"bgColor='#DBFF48'\" onmouseout=\"bgColor='<?php echo $bg_color ?>'\">\n          <td width=\"19\" align=\"center\"><img src=\"img/usricon/group_<?php echo $grouplist[\"group_active\"] == 1 ? 'norm' : 'inaktiv'; ?>.gif\" alt=\"\" width=\"19\" height=\"16\" border=\"0\" /></td>\n          <td width=\"458\" class=\"<?php echo $grouplist[\"group_active\"] ? 'dir' : 'inaktiv'; ?>\"><a href=\"<?php echo $goto ?>\"><?php\n\n            $grouparray = convertStringToArray($grouplist[\"group_member\"]);\n            $total_member = empty($grouparray[0]) ? 0 : count($grouparray);\n\n            echo $grouplist[\"group_name\"] ? html($grouplist[\"group_name\"]).' <span style=\"color:#999999;\">('.$total_member.' '.$BL['be_cnt_rssfeed_item'].')</span>' : 'n.a.';\n\n\n          ?></a></td>\n          <td width=\"61\" align=\"right\"><a href=\"<?php echo $phpwcms['modules']['usergroup']['dir']; ?>include/inc_act/act_usergroup.php?aktiv=<?php\n\n            echo $grouplist[\"group_id\"].':'.($grouplist[\"group_active\"] ? \"0\" : \"1\");\n\n            ?>\"><img src=\"img/button/<?php\n                if(empty($grouplist[\"group_active\"])) echo \"in\";\n            ?>aktiv_mini.gif\" alt=\"\" width=\"14\" height=\"15\" border=\"0\" /></a><a href=\"<?php echo $goto ?>\"><img src=\"img/button/edit.gif\" alt=\"\" width=\"24\" height=\"15\" border=\"0\" title=\"<?php\n                echo $BL['modules']['usergroup']['be_admin_group_edit'].\": \".html($grouplist[\"group_name\"])\n            ?>\"></a><a href=\"<?php echo $phpwcms['modules']['usergroup']['dir']; ?>include/inc_act/act_usergroup.php?del=<?php\n                echo urlencode($grouplist[\"group_id\"].\":\".$grouplist[\"group_name\"]);\n            ?>\" onclick=\"return confirm('Delete group <?php echo js_singlequote($grouplist[\"group_name\"]) ?>');\"><img src=\"img/button/del_message_final.gif\" alt=\"\" width=\"22\" height=\"15\" border=\"0\" title=\"<?php\n                echo $BL['modules']['usergroup']['be_admin_group_ldel'].\" \".html($grouplist[\"group_login\"])\n            ?>\"></a></td>\n        </tr>\n        <?php\n\n        }\n\n    } else {\n            echo '<tr><td colspan=\"3\">'.$BL['be_admin_group_nogroup'].': <a href=\"phpwcms.php?do=admin&amp;p=1&amp;create_group=1\">'.$BL['be_admin_group_add'].'</a></td></tr>';\n\n    }\n\n        ?>\n            <tr><td colspan=\"3\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"6\"></td></tr>\n            <tr><td colspan=\"3\" bgcolor=\"#92A1AF\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"1\"></td></tr>\n            <tr><td colspan=\"3\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"8\"></td></tr>\n            <tr><td colspan=\"3\"><form action=\"phpwcms.php?do=admin&amp;p=1&amp;create_group=1\" method=\"post\"><input type=\"submit\" value=\"<?php echo $BL['be_admin_group_add'] ?>\" class=\"button\" title=\"<?php echo $BL['be_admin_group_add'] ?>\"></form></td></tr>\n        </table>\n\n<!-- CREATE GROUP -->\n\n\n          <?php\n            //enym was groupid\n          if(isset($_GET[\"create_group\"]) || isset($_GET[\"u\"])) {\n          ?>\n            <br /><table width=\"538\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" summary=\"\">\n          <tr><td colspan=\"2\" class=\"title\"><?php echo isset($_GET[\"create_group\"]) ? $BL['be_admin_group_add'] : $BL['be_subnav_admin_groups'] .\" \". $BL['be_cnt_guestbook_edit']; ?></td></tr>\n\n          <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"4\" /></td></tr>\n          <tr><td colspan=\"2\"><img src=\"img/lines/l538_70.gif\" alt=\"\" width=\"538\" height=\"1\" /></td>\n    </tr>\n          <tr bgcolor=\"#F0F2F4\"><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"10\" /></td>\n    </tr>\n          <?php\n\n            $group[\"id\"]        = empty($_GET[\"u\"]) ? 0 : intval($_GET[\"u\"]);\n            $group[\"name\"]      = '';\n            $group[\"member\"]    = array();\n            $group[\"value\"]     = '';\n            $group[\"trash\"]     = 0;\n            $group[\"active\"]    = 1;\n\n            if($group[\"id\"]) {\n\n                $sql = \"SELECT * FROM \".DB_PREPEND.\"phpwcms_usergroup WHERE group_id=\".$group[\"id\"].\" LIMIT 1\";\n                $result = _dbQuery($sql);\n                if(isset($result[0]['group_id'])) {\n                    $group[\"name\"]      = $result[0][\"group_name\"];\n                    $group[\"member\"]    = empty($result[0][\"group_member\"]) ? array() : explode(',', $result[0][\"group_member\"]);\n                    $group[\"value\"]     = $result[0][\"group_value\"];\n                    $group[\"trash\"]     = $result[0][\"group_trash\"];\n                    $group[\"active\"]    = $result[0][\"group_active\"];\n                }\n\n                $sendbutton = $BL['be_admin_fcat_button1']; //UPDATE GROUP\n\n            } else {\n\n                $sendbutton = $BL['be_admin_fcat_button2'];   //create group\n            }\n\n            if(!empty($_POST[\"group_aktion\"])) {\n\n                $group[\"id\"]        = intval($_POST[\"group_id\"]);\n                $group[\"name\"]      = clean_slweg($_POST[\"group_name\"], 250);\n                $group[\"member\"]    = isset($_POST[\"acat_access\"]) && is_array($_POST[\"acat_access\"]) ? implode(',', $_POST[\"acat_access\"]) : '';\n                $group[\"value\"]     = clean_slweg($_POST[\"group_value\"]);\n                $group[\"trash\"]     = empty($_POST[\"group_trash\"]) ? 0 : intval($_POST[\"group_trash\"]);\n                $group[\"active\"]    = empty($_POST[\"group_active\"]) ? 0 : 1;\n\n                if(empty($group[\"name\"])) {\n\n                    $group[\"error\"] = 1;\n\n                } else {\n\n                    $data = array(\n\n                        'group_name'    => $group[\"name\"],\n                        'group_member'  => $group[\"member\"],\n                        'group_value'   => $group[\"value\"],\n                        'group_trash'   => $group[\"trash\"],\n                        'group_active'  => $group[\"active\"]\n                    );\n\n                    $result = $group[\"id\"] ? _dbUpdate('phpwcms_usergroup', $data, 'group_id='.$group[\"id\"]) : _dbInsert('phpwcms_usergroup', $data);\n\n                    if(isset($result['AFFECTED_ROWS']) || isset($result['INSERT_ID'])) {\n                        headerRedirect(PHPWCMS_URL.'phpwcms.php?'.get_token_get_string('csrftoken').'&do=admin&p=1');\n                    } else {\n                        echo _dbError();\n                    }\n\n                }\n\n                $group[\"member\"] = convertStringToArray($group[\"member\"]);\n\n            }\n          ?>\n\n          <form action=\"phpwcms.php?do=admin&amp;p=1&amp;create_group=1\" method=\"post\" name=\"editsitestructure\" id=\"editsitestructure\" onsubmit=\"selectAllOptions(this.acat_access);selectAllOptions(this.acat_cp);var x = wordcount(this.acat_name.value);if(x&lt;1) {alert('Fill in a category title! \\n\\n('+x+' words total)');this.acat_name.focus();return false;}\">\n          <tr align=\"center\" bgcolor=\"#F0F2F4\"><td colspan=\"2\"><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" summary=\"\">\n            <?php if(!empty($group[\"error\"])) { ?>\n            <tr>\n              <td align=\"right\" class=\"chatlist\" style=\"color:#FF3300;\"><?php echo $BL['be_admin_usr_err'] ?>:&nbsp;</td>\n              <td class=\"error\"><strong><?php echo $BL['be_fpriv_name'] ?></strong></td>\n            </tr>\n            <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"3\" /></td>\n            </tr>\n            <?php } ?>\n            <tr>\n              <td align=\"right\" class=\"chatlist\"><?php echo $BL['be_fpriv_name'] ?>:&nbsp;</td>\n              <td><input name=\"group_name\" type=\"text\" id=\"group_name\" class=\"width400\" value=\"<?php echo empty($group[\"name\"]) ? '' : html($group[\"name\"]) ?>\" size=\"40\" maxlength=\"250\" /></td>\n            </tr>\n\n            <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"6\" /></td></tr>\n\n        <tr>\n              <td align=\"right\" class=\"chatlist\"><?php echo $BL['be_cnt_description'] ?>:&nbsp;</td>\n              <td><textarea name=\"group_value\" id=\"group_value\" class=\"width400\" rows=\"3\"><?php echo html($group[\"value\"]) ?></textarea></td>\n            </tr>\n\n        <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"6\" /></td></tr>\n\n          <!-- USER RIGHTS enym.com   -->\n\n        <tr>\n    <td align=\"right\" class=\"chatlist\"><?php echo $BL['be_selection'] ?>:&nbsp;</td>\n\n    <td valign=\"top\">\n<?php\n\n// list all available frontend users and put into temp array\n$sql = \"SELECT * FROM \".DB_PREPEND.\"phpwcms_user WHERE usr_aktiv != 9 ORDER BY usr_fe, usr_name, usr_login\";\n$result = _dbQuery($sql);\n$_temp_usr = array();\nif(isset($result[0]['usr_id'])) {\n    foreach($result as $row) {\n        $_temp_usr[$row['usr_id']]['name']   = html($row['usr_name']);\n        $_temp_usr[$row['usr_id']]['login']  = html($row['usr_login']);\n        $_temp_usr[$row['usr_id']]['fe']     = $row['usr_fe'];\n        $_temp_usr[$row['usr_id']]['active'] = $row['usr_aktiv'];\n        $_temp_usr[$row['usr_id']]['admin'] = $row['usr_admin'];\n    }\n}\n\n?>\n            <table border=\"0\" cellspacing=\"0\" cellpadding=\"0\">\n              <tr>\n                <td><select name=\"acat_access[]\" id=\"acat_access\" size=\"12\" multiple=\"multiple\" class=\"width185\" onDblClick=\"moveSelectedOptions(document.editsitestructure.acat_access,document.editsitestructure.acat_feusers,true);\">\n<?php\n    if(count($_temp_usr)) {\n        // list all fe_users\n        foreach($_temp_usr as $key => $value) {\n            if(isset($group[\"member\"]) && empty($group[\"error\"])) {\n                if(in_array($key, $group[\"member\"])) {\n                    echo '<option value=\"'.$key.'\"';\n                    if(!$_temp_usr[$key]['active']) {\n                        echo ' style=\"color:#999999;\"';\n                    } else if($_temp_usr[$key]['admin']) {\n                        echo ' style=\"color:#3F61BF;\"';\n                    }\n                    echo '>'.trim($_temp_usr[$key]['name']. ' ('.$_temp_usr[$key]['login'].')').\"</option>\\n\";\n                    unset($_temp_usr[$key]);\n                }\n            }\n        }\n    }\n\n?>\n        </select></td>\n                <td valign=\"top\" style=\"padding-left:5px;padding-right:5px;\"><img src=\"img/button/put_left.gif\" width=\"15\" height=\"15\" title=\"<?php echo $BL['be_admin_struct_adduser_all']?>\" onClick=\"moveAllOptions(document.editsitestructure.acat_feusers,document.editsitestructure.acat_access);selectAllOptions(document.editsitestructure.acat_access);\"><br><img src=\"img/leer.gif\" width=\"1\" height=\"3\"><br><img src=\"img/button/put_left_a.gif\" width=\"15\" height=\"15\" title=\"<?php echo $BL['be_admin_struct_adduser_this']?>\" onClick=\"moveSelectedOptions(document.editsitestructure.acat_feusers,document.editsitestructure.acat_access,true);selectAllOptions(document.editsitestructure.acat_access);\"><br><img src=\"img/leer.gif\" width=\"1\" height=\"6\"><br><img src=\"img/button/put_right_a.gif\" width=\"15\" height=\"15\" title=\"<?php echo $BL['be_admin_struct_remove_this']?>\" onClick=\"moveSelectedOptions(document.editsitestructure.acat_access,document.editsitestructure.acat_feusers,true);\"><br><img src=\"img/leer.gif\" width=\"1\" height=\"3\"><br><img src=\"img/button/put_right.gif\" width=\"15\" height=\"15\" title=\"<?php echo $BL['be_admin_struct_remove_all']?>\" onClick=\"moveAllOptions(document.editsitestructure.acat_access,document.editsitestructure.acat_feusers);\"></td>\n                <td><select name=\"acat_feusers\" size=\"12\" multiple=\"multiple\" id=\"acat_feusers\" class=\"width185\" onDblClick=\"moveSelectedOptions(document.editsitestructure.acat_feusers,document.editsitestructure.acat_access,true);selectAllOptions(document.editsitestructure.acat_access);\">\n<?php\n\n    // list all available fe_users\n    if(count($_temp_usr)) {\n        foreach($_temp_usr as $key => $value) {\n            echo '<option value=\"'.$key.'\"';\n            if(!$_temp_usr[$key]['active']) {\n                echo ' style=\"color:#999999\"';\n            } else if($_temp_usr[$key]['admin']) {\n                echo ' style=\"color:#3F61BF\"';\n            }\n            echo '>'.trim($_temp_usr[$key]['name']. ' ('.$_temp_usr[$key]['login'].')').\"</option>\\n\";\n        }\n    }\n\n?>\n        </select></td>\n              </tr>\n            </table></td>\n          </tr>\n\n     <!-- USER RIGHTS -->\n\n            <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"6\" /></td></tr>\n            <tr>\n              <td align=\"right\" class=\"chatlist\"><?php echo $BL['be_ftptakeover_status'] ?>:&nbsp;</td>\n              <td><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" bgcolor=\"#D9DEE3\" summary=\"\">\n               <tr>\n                  <td><input name=\"group_active\" type=\"checkbox\" id=\"group_active\" value=\"1\"<?php is_checked(1, empty($group[\"active\"]) ? 0 : $group[\"active\"]); ?> /></td>\n                  <td><label for=\"group_active\"><?php echo $BL['be_ftptakeover_active'] ?></label>&nbsp;&nbsp;</td>\n                </tr>\n              </table></td>\n              </tr>\n            <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"10\" /></td>\n            </tr>\n            <tr>\n              <td>\n              &nbsp;\n              <input name=\"group_id\" type=\"hidden\" id=\"group_id\" value=\"<?php echo $group[\"id\"] ?>\" />\n              <input name=\"group_aktion\" type=\"hidden\" id=\"group_aktion\" value=\"1\" />\n              </td>\n              <td>\n              <input name=\"Submit\" type=\"submit\" class=\"button\" value=\"<?php echo $sendbutton ?>\" />\n              &nbsp;&nbsp;\n              <input name=\"donotsubmit\" type=\"button\" class=\"button\" value=\"<?php echo $BL['be_admin_fcat_exit'] ?>\" onclick=\"location.href='phpwcms.php?do=admin&amp;p=1';\" /></td>\n              </tr>\n            </table></td>\n          </tr>\n          <tr bgcolor=\"#F0F2F4\"><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"15\" /></td>\n          </tr>\n          </form>\n      </table>\n<?php\n}\n?>", "<?php\n/**\n * phpwcms content management system\n *\n * @author Oliver Georgi <og@phpwcms.org>\n * @copyright Copyright (c) 2002-2017, Oliver Georgi\n * @license http://opensource.org/licenses/GPL-2.0 GNU GPL-2\n * @link http://www.phpwcms.org\n *\n **/\n\n// ----------------------------------------------------------------\n// obligate check for phpwcms constants\nif (!defined('PHPWCMS_ROOT')) {\n    die(\"You Cannot Access This Script Directly, Have a Nice Day.\");\n}\n// ----------------------------------------------------------------\n\n$new_login          = genlogname();\n$new_password       = generic_string(8);\n$new_email          = '';\n$new_name           = '';\n$set_user_aktiv     = 0;\n$set_user_admin     = 0;\n$set_user_fe        = 0;\n$send_verification  = 1;\n$user_err           = '';\n\nif(isset($_POST[\"form_aktion\"]) && $_POST[\"form_aktion\"] == \"create_account\") {\n    //Create Account Daten verarbeiten\n    $new_login          = slweg($_POST[\"form_newloginname\"]);\n    $new_password       = slweg($_POST[\"form_newpassword\"]);\n    $new_email          = clean_slweg($_POST[\"form_newemail\"]);\n    $new_name           = clean_slweg($_POST[\"form_newrealname\"]);\n    $set_user_aktiv     = isset($_POST[\"form_active\"]) ? 1 : 0;\n    $set_user_admin     = isset($_POST[\"form_admin\"]) ? 1 : 0;\n    $set_user_fe        = isset($_POST[\"form_feuser\"]) ? intval($_POST[\"form_feuser\"]) : 0;\n    if($set_user_admin) {\n        $set_user_fe = 2;\n    }\n    $send_verification  = isset($_POST[\"verification_email\"]) ? 1 : 0;\n    if(empty($new_login)) {\n        $user_err .= $BL['be_admin_usr_err2'].\"\\n\";\n    } elseif(($check_anzahl = _dbQuery(\"SELECT COUNT(*) FROM \".DB_PREPEND.\"phpwcms_user WHERE usr_login='\".aporeplace($new_login).\"'\", 'COUNT'))) {\n        $user_err .= $BL['be_admin_usr_err1'].\"\\n\";\n    }\n    if(empty($new_password)) {\n        $user_err .= $BL['be_admin_usr_err3'].\"\\n\";\n    }\n    if(!is_valid_email($new_email) && $send_verification) {\n        $user_err .= $BL['be_admin_usr_err4'].\"\\n\";\n    }\n    if(empty($user_err)) { //Insert new User\n        $sql =  \"INSERT INTO \".DB_PREPEND.\"phpwcms_user (usr_login, usr_pass, usr_email, \".\n                \"usr_admin, usr_aktiv, usr_name, usr_wysiwyg, usr_fe ) VALUES ('\".\n                aporeplace($new_login).\"', '\".\n                aporeplace(md5(makeCharsetConversion($new_password, PHPWCMS_CHARSET, 'utf-8'))).\"', '\".\n                aporeplace($new_email).\"', '\".\n                $set_user_admin.\"', '\".\n                $set_user_aktiv.\"', '\".\n                aporeplace($new_name).\"', 1, '\".\n                $set_user_fe.\"')\";\n        $result = _dbQuery($sql, 'INSERT');\n\n        if(!empty($result['INSERT_ID'])) {\n            $new_user_id = $result['INSERT_ID'];\n            $user_ok = 1;\n            if($send_verification) {\n                $emailbody = str_replace('{LOGIN}', $new_login, $BL['be_admin_usr_mailbody']);\n                $emailbody = str_replace('{PASSWORD}', $new_password, $emailbody);\n                $emailbody = str_replace('{SITE}', PHPWCMS_URL, $emailbody);\n                $emailbody = str_replace('{LOGIN_PAGE}', PHPWCMS_URL.get_login_file(), $emailbody);\n\n                sendEmail(  array(\n                    'recipient' => $new_email,\n                    'toName'    => $new_name,\n                    'subject'   => $BL['be_admin_usr_mailsubject'],\n                    'isHTML'    => 0,\n                    'text'      => $emailbody,\n                    'from'      => $phpwcms[\"admin_email\"],\n                    'sender'    => $phpwcms[\"admin_email\"]\n                ));\n            }\n        }\n    }\n}\n\nif(empty($user_ok)) {\n\n?><form action=\"phpwcms.php?do=admin&amp;s=1\" method=\"post\" name=\"edituser\" autocomplete=\"off\"><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" summary=\"\">\n          <tr>\n            <td colspan=\"2\"><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" summary=\"\">\n                <tr>\n                  <td><img src=\"img/usricon/usr_add.gif\" alt=\"\" width=\"19\" height=\"16\"></td>\n                  <td class=\"title\">&nbsp;<?php echo $BL['be_admin_usr_title'] ?></td>\n                </tr>\n              </table></td>\n          </tr>\n          <tr>\n            <td><img src=\"img/leer.gif\" alt=\"\" width=\"105\" height=\"1\"></td>\n            <td><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"5\"></td>\n          </tr>\n          <?php\n          if(!empty($user_err)) {\n          ?>\n          <tr valign=\"top\">\n            <td align=\"right\" class=\"error\"><strong><?php echo $BL['be_admin_usr_err'] ?>:</strong>&nbsp;</td>\n            <td class=\"error\"><strong><?php echo nl2br(chop($user_err)) ?></strong></td>\n          </tr>\n          <tr valign=\"top\"><td colspan=\"2\" align=\"right\" class=\"chatlist\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"7\"></td></tr>\n          <?php\n          } //Ende Fehler New User\n          ?>\n          <tr>\n            <td align=\"right\" class=\"chatlist\"><?php echo $BL[\"login_username\"]  ?>:&nbsp;</td>\n            <td><input name=\"form_newloginname\" type=\"text\" id=\"form_newloginname\" value=\"<?php echo html($new_login); ?>\" size=\"30\" maxlength=\"200\" autocomplete=\"off\" class=\"width250\" /></td>\n          </tr>\n          <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"1\"></td></tr>\n          <tr>\n            <td align=\"right\" class=\"chatlist\"><?php echo $BL[\"login_userpass\"] ?>:&nbsp;</td>\n            <td><input name=\"form_newpassword\" type=\"text\" id=\"form_newpassword\" value=\"<?php echo html($new_password); ?>\" size=\"30\" maxlength=\"200\" autocomplete=\"off\" class=\"width250\" /></td>\n          </tr>\n          <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"1\"></td></tr>\n          <tr>\n            <td align=\"right\" class=\"chatlist\"><?php echo $BL['be_profile_label_email'] ?>:&nbsp;</td>\n            <td><input name=\"form_newemail\" type=\"text\" id=\"form_newemail\" value=\"<?php echo html($new_email); ?>\" size=\"30\" maxlength=\"250\" autocomplete=\"off\" class=\"width250\" /></td>\n          </tr>\n          <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"1\"></td></tr>\n          <tr>\n            <td align=\"right\" class=\"chatlist\"><?php echo $BL['be_admin_usr_realname'] ?>:&nbsp;</td>\n            <td><input name=\"form_newrealname\" type=\"text\" id=\"form_newrealname\" value=\"<?php echo html($new_name); ?>\" size=\"30\" maxlength=\"200\" autocomplete=\"off\" class=\"width250\" /></td>\n          </tr>\n\n          <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"6\"></td></tr>\n          <tr>\n            <td align=\"right\" class=\"chatlist\"><?php echo $BL['be_admin_usr_issection']  ?>:&nbsp;</td>\n            <td><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" bgcolor=\"#E7E8EB\" summary=\"\">\n                <tr>\n                  <td><input name=\"form_feuser\" type=\"radio\" id=\"form_feuser0\" value=\"0\"<?php is_checked($set_user_fe, 0); ?> /></td>\n                  <td><label for=\"form_feuser0\"><?php echo $BL['be_admin_usr_ifsection0'] ?></label>&nbsp;&nbsp;</td>\n                  <td><input name=\"form_feuser\" type=\"radio\" id=\"form_feuser1\" value=\"1\"<?php is_checked($set_user_fe, 1); ?> /></td>\n                  <td><label for=\"form_feuser1\"><?php echo $BL['be_admin_usr_ifsection1'] ?></label>&nbsp;&nbsp;</td>\n                  <td><input name=\"form_feuser\" type=\"radio\" id=\"form_feuser2\" value=\"2\"<?php is_checked($set_user_fe, 2); ?> /></td>\n                  <td><label for=\"form_feuser2\"><?php echo $BL['be_admin_usr_ifsection2'] ?></label></td>\n                  <td><img src=\"img/leer.gif\" alt=\"\" width=\"4\" height=\"21\"></td>\n                </tr>\n              </table></td>\n          </tr>\n\n          <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"6\"></td></tr>\n          <tr>\n            <td align=\"right\" class=\"chatlist\"><?php echo $BL['be_admin_usr_setactive'] ?>:&nbsp;</td>\n            <td><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" summary=\"\">\n                <tr>\n                  <td><input name=\"form_active\" type=\"checkbox\" id=\"form_active\" value=\"1\"<?php is_checked($set_user_aktiv, 1); ?> /></td>\n                  <td><label for=\"form_active\"><?php echo  $BL['be_admin_usr_iflogin'] ?></label></td>\n                </tr>\n              </table></td>\n          </tr>\n\n          <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"1\"></td></tr>\n          <tr>\n            <td align=\"right\" class=\"chatlist\" style=\"color:#FF0000\"><?php echo $BL['be_admin_usr_isadmin']  ?>:&nbsp;</td>\n            <td><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" summary=\"\">\n                <tr>\n                  <td><input name=\"form_admin\" type=\"checkbox\" id=\"form_admin\" value=\"1\"<?php is_checked($set_user_admin, 1); ?> /></td>\n                  <td><label for=\"form_admin\"><?php echo  $BL['be_admin_usr_ifadmin'] ?> <strong class=\"error\">!!!</strong></label></td>\n                </tr>\n              </table></td>\n          </tr>\n          <tr>\n            <td align=\"right\" class=\"chatlist\"><?php echo $BL['be_admin_usr_verify'] ?>:&nbsp;</td>\n            <td><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" summary=\"\">\n                <tr><td colspan=\"3\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"6\"></td></tr>\n                <tr bgcolor=\"#E7E8EB\">\n                  <td><input name=\"verification_email\" type=\"checkbox\" id=\"verification_email\" value=\"1\"<?php is_checked($send_verification, 1); ?>></td>\n                  <td><label for=\"verification_email\"><?php echo $BL['be_admin_usr_sendemail'] ?></label></td>\n                  <td><img src=\"img/leer.gif\" alt=\"\" width=\"4\" height=\"21\"></td>\n                </tr>\n                <tr><td colspan=\"3\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"6\"></td></tr>\n              </table></td>\n          </tr>\n          <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"6\"><input name=\"form_aktion\" type=\"hidden\" value=\"create_account\" /></td></tr>\n          <tr>\n            <td>&nbsp;</td>\n            <td><input name=\"Submit\" type=\"submit\" class=\"button\" value=\"<?php echo $BL['be_admin_usr_button'] ?>\" /></td>\n          </tr>\n          <tr><td colspan=\"2\"><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"15\"></td></tr>\n      </table></form><img src=\"img/lines/l538_70.gif\" alt=\"\" width=\"538\" height=\"1\"><br /><img src=\"img/leer.gif\" alt=\"\" width=\"1\" height=\"5\"><?php\n\n\n} else {\n    echo \"<script type=\\\"text/javascript\\\"> timer=setTimeout(\\\"self.location.href='phpwcms.php'+'?\".CSRF_GET_TOKEN.\"&do=admin'\\\", 0); </script>\";\n}\n"], "filenames": ["include/inc_lib/revision/revision.php", "include/inc_tmpl/admin.edituser.tmpl.php", "include/inc_tmpl/admin.groups.tmpl.php", "include/inc_tmpl/admin.newuser.tmpl.php"], "buggy_code_start_loc": [13, 15, 15, 15], "buggy_code_end_loc": [14, 266, 321, 198], "fixing_code_start_loc": [13, 15, 15, 15], "fixing_code_end_loc": [14, 263, 305, 194], "type": "CWE-79", "message": "phpwcms 1.8.9 has XSS in include/inc_tmpl/admin.edituser.tmpl.php and include/inc_tmpl/admin.newuser.tmpl.php via the username (aka new_login) field.", "other": {"cve": {"id": "CVE-2017-15872", "sourceIdentifier": "cve@mitre.org", "published": "2017-10-24T20:29:00.250", "lastModified": "2017-10-31T21:53:34.823", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "phpwcms 1.8.9 has XSS in include/inc_tmpl/admin.edituser.tmpl.php and include/inc_tmpl/admin.newuser.tmpl.php via the username (aka new_login) field."}, {"lang": "es", "value": "phpwcms 1.8.9 tiene Cross-Site Scripting (XSS) en include/inc_tmpl/admin.edituser.tmpl.php y include/inc_tmpl/admin.newuser.tmpl.php mediante el campo username (conocido como new_login)."}], "metrics": {"cvssMetricV30": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:H/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "HIGH", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.8, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 1.7, "impactScore": 2.7}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 3.5}, "baseSeverity": "LOW", "exploitabilityScore": 6.8, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:phpwcms:phpwcms:1.8.9:*:*:*:*:*:*:*", "matchCriteriaId": "B5C4F140-5AA7-4A89-A99F-1ADF02BCF6B0"}]}]}], "references": [{"url": "https://github.com/slackero/phpwcms/commit/62c7c4a7a7de5effa0a82c89e77e53795a82e11d", "source": "cve@mitre.org", "tags": ["Issue Tracking", "Patch", "Third Party Advisory"]}, {"url": "https://github.com/slackero/phpwcms/commit/90ee94a474b37919161f8112f9e36c53ad70492f", "source": "cve@mitre.org", "tags": ["Issue Tracking", "Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/slackero/phpwcms/commit/62c7c4a7a7de5effa0a82c89e77e53795a82e11d"}}