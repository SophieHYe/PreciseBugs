{"buggy_code": ["<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n<module>\n    <name>ps_socialfollow</name>\n    <displayName><![CDATA[Social media follow links]]></displayName>\n    <version><![CDATA[1.0]]></version>\n    <description><![CDATA[Allows you to add information about your brand&#039;s social networking accounts.]]></description>\n    <author><![CDATA[PrestaShop]]></author>\n    <is_configurable>1</is_configurable>\n    <need_instance>1</need_instance>\n\t<limited_countries></limited_countries>\n</module>\n", "<?php\n/*\n* 2007-2016 PrestaShop\n*\n* NOTICE OF LICENSE\n*\n* This source file is subject to the Academic Free License (AFL 3.0)\n* that is bundled with this package in the file LICENSE.txt.\n* It is also available through the world-wide-web at this URL:\n* http://opensource.org/licenses/afl-3.0.php\n* If you did not receive a copy of the license and are unable to\n* obtain it through the world-wide-web, please send an email\n* to license@prestashop.com so we can send you a copy immediately.\n*\n* DISCLAIMER\n*\n* Do not edit or add to this file if you wish to upgrade PrestaShop to newer\n* versions in the future. If you wish to customize PrestaShop for your\n* needs please refer to http://www.prestashop.com for more information.\n*\n*  @author PrestaShop SA <contact@prestashop.com>\n*  @copyright  2007-2016 PrestaShop SA\n*  @license    http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)\n*  International Registered Trademark & Property of PrestaShop SA\n*/\n\nif (!defined('_CAN_LOAD_FILES_')) {\n    exit;\n}\n\nuse PrestaShop\\PrestaShop\\Core\\Module\\WidgetInterface;\n\nclass Ps_Socialfollow extends Module implements WidgetInterface\n{\n    private $templateFile;\n\n    public function __construct()\n    {\n        $this->name = 'ps_socialfollow';\n        $this->author = 'PrestaShop';\n        $this->version = '2.0.0';\n\n        $this->bootstrap = true;\n        parent::__construct();\n\n        $this->displayName = $this->trans('Social media follow links', array(), 'Modules.Socialfollow.Admin');\n        $this->description = $this->trans('Allows you to add information about your brand\\'s social networking accounts.', array(), 'Modules.Socialfollow.Admin');\n\n        $this->ps_versions_compliancy = array('min' => '1.7.1.0', 'max' => _PS_VERSION_);\n\n        $this->templateFile = 'module:ps_socialfollow/ps_socialfollow.tpl';\n    }\n\n    public function install()\n    {\n        return (parent::install() &&\n            Configuration::updateValue('BLOCKSOCIAL_FACEBOOK', '') &&\n            Configuration::updateValue('BLOCKSOCIAL_TWITTER', '') &&\n            Configuration::updateValue('BLOCKSOCIAL_RSS', '') &&\n            Configuration::updateValue('BLOCKSOCIAL_YOUTUBE', '') &&\n            Configuration::updateValue('BLOCKSOCIAL_PINTEREST', '') &&\n            Configuration::updateValue('BLOCKSOCIAL_VIMEO', '') &&\n            Configuration::updateValue('BLOCKSOCIAL_INSTAGRAM', '') &&\n            Configuration::updateValue('BLOCKSOCIAL_LINKEDIN', '') &&\n            $this->registerHook('displayFooter'));\n    }\n\n    public function uninstall()\n    {\n        return (Configuration::deleteByName('BLOCKSOCIAL_FACEBOOK') &&\n            Configuration::deleteByName('BLOCKSOCIAL_TWITTER') &&\n            Configuration::deleteByName('BLOCKSOCIAL_RSS') &&\n            Configuration::deleteByName('BLOCKSOCIAL_YOUTUBE') &&\n            Configuration::deleteByName('BLOCKSOCIAL_PINTEREST') &&\n            Configuration::deleteByName('BLOCKSOCIAL_VIMEO') &&\n            Configuration::deleteByName('BLOCKSOCIAL_INSTAGRAM') &&\n            Configuration::deleteByName('BLOCKSOCIAL_LINKEDIN') &&\n            parent::uninstall());\n    }\n\n    public function getContent()\n    {\n        if (Tools::isSubmit('submitModule')) {\n            Configuration::updateValue('BLOCKSOCIAL_FACEBOOK', Tools::getValue('blocksocial_facebook', ''));\n            Configuration::updateValue('BLOCKSOCIAL_TWITTER', Tools::getValue('blocksocial_twitter', ''));\n            Configuration::updateValue('BLOCKSOCIAL_RSS', Tools::getValue('blocksocial_rss', ''));\n            Configuration::updateValue('BLOCKSOCIAL_YOUTUBE', Tools::getValue('blocksocial_youtube', ''));\n            Configuration::updateValue('BLOCKSOCIAL_PINTEREST', Tools::getValue('blocksocial_pinterest', ''));\n            Configuration::updateValue('BLOCKSOCIAL_VIMEO', Tools::getValue('blocksocial_vimeo', ''));\n            Configuration::updateValue('BLOCKSOCIAL_INSTAGRAM', Tools::getValue('blocksocial_instagram', ''));\n            Configuration::updateValue('BLOCKSOCIAL_LINKEDIN', Tools::getValue('blocksocial_linkedin', ''));\n\n            $this->_clearCache('*');\n\n            Tools::redirectAdmin($this->context->link->getAdminLink('AdminModules').'&configure='.$this->name.'&tab_module='.$this->tab.'&conf=4&module_name='.$this->name);\n        }\n\n        return $this->renderForm();\n    }\n\n    public function _clearCache($template, $cache_id = null, $compile_id = null)\n    {\n        parent::_clearCache($this->templateFile);\n    }\n\n    public function renderForm()\n    {\n        $fields_form = array(\n            'form' => array(\n                'legend' => array(\n                    'title' => $this->trans('Settings', array(), 'Admin.Global'),\n                    'icon' => 'icon-cogs'\n                ),\n                'input' => array(\n                    array(\n                        'type' => 'text',\n                        'label' => $this->trans('Facebook URL', array(), 'Modules.Socialfollow.Admin'),\n                        'name' => 'blocksocial_facebook',\n                        'desc' => $this->trans('Your Facebook fan page.', array(), 'Modules.Socialfollow.Admin'),\n                    ),\n                    array(\n                        'type' => 'text',\n                        'label' => $this->trans('Twitter URL', array(), 'Modules.Socialfollow.Admin'),\n                        'name' => 'blocksocial_twitter',\n                        'desc' => $this->trans('Your official Twitter account.', array(), 'Modules.Socialfollow.Admin'),\n                    ),\n                    array(\n                        'type' => 'text',\n                        'label' => $this->trans('RSS URL', array(), 'Modules.Socialfollow.Admin'),\n                        'name' => 'blocksocial_rss',\n                        'desc' => $this->trans('The RSS feed of your choice (your blog, your store, etc.).', array(), 'Modules.Socialfollow.Admin'),\n                    ),\n                    array(\n                        'type' => 'text',\n                        'label' => $this->trans('YouTube URL', array(), 'Modules.Socialfollow.Admin'),\n                        'name' => 'blocksocial_youtube',\n                        'desc' => $this->trans('Your official YouTube account.', array(), 'Modules.Socialfollow.Admin'),\n                    ),\n                    array(\n                        'type' => 'text',\n                        'label' => $this->trans('Pinterest URL:', array(), 'Modules.Socialfollow.Admin'),\n                        'name' => 'blocksocial_pinterest',\n                        'desc' => $this->trans('Your official Pinterest account.', array(), 'Modules.Socialfollow.Admin'),\n                    ),\n                    array(\n                        'type' => 'text',\n                        'label' => $this->trans('Vimeo URL:', array(), 'Modules.Socialfollow.Admin'),\n                        'name' => 'blocksocial_vimeo',\n                        'desc' => $this->trans('Your official Vimeo account.', array(), 'Modules.Socialfollow.Admin'),\n                    ),\n                    array(\n                        'type' => 'text',\n                        'label' => $this->trans('Instagram URL:', array(), 'Modules.Socialfollow.Admin'),\n                        'name' => 'blocksocial_instagram',\n                        'desc' => $this->trans('Your official Instagram account.', array(), 'Modules.Socialfollow.Admin'),\n                    ),\n                    array(\n                        'type' => 'text',\n                        'label' => $this->trans('LinkedIn URL:', array(), 'Modules.Socialfollow.Admin'),\n                        'name' => 'blocksocial_linkedin',\n                        'desc' => $this->trans('Your official LinkedIn account.', array(), 'Modules.Socialfollow.Admin'),\n                    ),\n                ),\n                'submit' => array(\n                    'title' => $this->trans('Save', array(), 'Admin.Global'),\n                )\n            ),\n        );\n\n        $helper = new HelperForm();\n        $helper->show_toolbar = false;\n        $helper->table =  $this->table;\n        $helper->submit_action = 'submitModule';\n        $helper->tpl_vars = array(\n            'fields_value' => $this->getConfigFieldsValues(),\n        );\n\n        return $helper->generateForm(array($fields_form));\n    }\n\n    public function getConfigFieldsValues()\n    {\n        return array(\n            'blocksocial_facebook' => Tools::getValue('blocksocial_facebook', Configuration::get('BLOCKSOCIAL_FACEBOOK')),\n            'blocksocial_twitter' => Tools::getValue('blocksocial_twitter', Configuration::get('BLOCKSOCIAL_TWITTER')),\n            'blocksocial_rss' => Tools::getValue('blocksocial_rss', Configuration::get('BLOCKSOCIAL_RSS')),\n            'blocksocial_youtube' => Tools::getValue('blocksocial_youtube', Configuration::get('BLOCKSOCIAL_YOUTUBE')),\n            'blocksocial_pinterest' => Tools::getValue('blocksocial_pinterest', Configuration::get('BLOCKSOCIAL_PINTEREST')),\n            'blocksocial_vimeo' => Tools::getValue('blocksocial_vimeo', Configuration::get('BLOCKSOCIAL_VIMEO')),\n            'blocksocial_instagram' => Tools::getValue('blocksocial_instagram', Configuration::get('BLOCKSOCIAL_INSTAGRAM')),\n            'blocksocial_linkedin' => Tools::getValue('blocksocial_linkedin', Configuration::get('BLOCKSOCIAL_LINKEDIN')),\n        );\n    }\n\n    public function renderWidget($hookName = null, array $configuration = [])\n    {\n        if (!$this->isCached($this->templateFile, $this->getCacheId('ps_socialfollow'))) {\n            $this->smarty->assign($this->getWidgetVariables($hookName, $configuration));\n        }\n\n        return $this->fetch($this->templateFile, $this->getCacheId('ps_socialfollow'));\n    }\n\n    public function getWidgetVariables($hookName = null, array $configuration = [])\n    {\n        $social_links = array();\n\n        if ($sf_facebook = Configuration::get('BLOCKSOCIAL_FACEBOOK')) {\n            $social_links['facebook'] = array(\n                'label' => $this->trans('Facebook', array(), 'Modules.Socialfollow.Shop'),\n                'class' => 'facebook',\n                'url' => $sf_facebook,\n            );\n        }\n\n        if ($sf_twitter = Configuration::get('BLOCKSOCIAL_TWITTER')) {\n            $social_links['twitter'] = array(\n                'label' => $this->trans('Twitter', array(), 'Modules.Socialfollow.Shop'),\n                'class' => 'twitter',\n                'url' => $sf_twitter,\n            );\n        }\n\n        if ($sf_rss = Configuration::get('BLOCKSOCIAL_RSS')) {\n            $social_links['rss'] = array(\n                'label' => $this->trans('Rss', array(), 'Modules.Socialfollow.Shop'),\n                'class' => 'rss',\n                'url' => $sf_rss,\n            );\n        }\n\n        if ($sf_youtube = Configuration::get('BLOCKSOCIAL_YOUTUBE')) {\n            $social_links['youtube'] = array(\n                'label' => $this->trans('YouTube', array(), 'Modules.Socialfollow.Shop'),\n                'class' => 'youtube',\n                'url' => $sf_youtube,\n            );\n        }\n\n        if ($sf_pinterest = Configuration::get('BLOCKSOCIAL_PINTEREST')) {\n            $social_links['pinterest'] = array(\n                'label' => $this->trans('Pinterest', array(), 'Modules.Socialfollow.Shop'),\n                'class' => 'pinterest',\n                'url' => $sf_pinterest,\n            );\n        }\n\n        if ($sf_vimeo = Configuration::get('BLOCKSOCIAL_VIMEO')) {\n            $social_links['vimeo'] = array(\n                'label' => $this->trans('Vimeo', array(), 'Modules.Socialfollow.Shop'),\n                'class' => 'vimeo',\n                'url' => $sf_vimeo,\n            );\n        }\n\n        if ($sf_instagram = Configuration::get('BLOCKSOCIAL_INSTAGRAM')) {\n            $social_links['instagram'] = array(\n                'label' => $this->trans('Instagram', array(), 'Modules.Socialfollow.Shop'),\n                'class' => 'instagram',\n                'url' => $sf_instagram,\n            );\n        }\n\n        if ($sf_linkedin = Configuration::get('BLOCKSOCIAL_LINKEDIN')) {\n            $social_links['linkedin'] = array(\n                'label' => $this->trans('LinkedIn', array(), 'Modules.Socialfollow.Shop'),\n                'class' => 'linkedin',\n                'url' => $sf_linkedin,\n            );\n        }\n\n        return array(\n            'social_links' => $social_links,\n        );\n    }\n}\n"], "fixing_code": ["<?xml version=\"1.0\" encoding=\"UTF-8\" ?>\n<module>\n    <name>ps_socialfollow</name>\n    <displayName><![CDATA[Social media follow links]]></displayName>\n    <version><![CDATA[2.1.0]]></version>\n    <description><![CDATA[Allows you to add information about your brand&#039;s social networking accounts.]]></description>\n    <author><![CDATA[PrestaShop]]></author>\n    <tab><![CDATA[]]></tab>\n    <is_configurable>1</is_configurable>\n    <need_instance>1</need_instance>\n\t<limited_countries></limited_countries>\n</module>\n", "<?php\n/*\n* 2007-2016 PrestaShop\n*\n* NOTICE OF LICENSE\n*\n* This source file is subject to the Academic Free License (AFL 3.0)\n* that is bundled with this package in the file LICENSE.txt.\n* It is also available through the world-wide-web at this URL:\n* http://opensource.org/licenses/afl-3.0.php\n* If you did not receive a copy of the license and are unable to\n* obtain it through the world-wide-web, please send an email\n* to license@prestashop.com so we can send you a copy immediately.\n*\n* DISCLAIMER\n*\n* Do not edit or add to this file if you wish to upgrade PrestaShop to newer\n* versions in the future. If you wish to customize PrestaShop for your\n* needs please refer to http://www.prestashop.com for more information.\n*\n*  @author PrestaShop SA <contact@prestashop.com>\n*  @copyright  2007-2016 PrestaShop SA\n*  @license    http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)\n*  International Registered Trademark & Property of PrestaShop SA\n*/\n\nif (!defined('_CAN_LOAD_FILES_')) {\n    exit;\n}\n\nuse PrestaShop\\PrestaShop\\Core\\Module\\WidgetInterface;\nuse Symfony\\Component\\Validator\\Constraints\\Url;\nuse Symfony\\Component\\Validator\\Validation;\n\nclass Ps_Socialfollow extends Module implements WidgetInterface\n{\n    private $templateFile;\n\n    const SOCIAL_NETWORKS = [\n        'facebook',\n        'twitter',\n        'rss',\n        'youtube',\n        'pinterest',\n        'vimeo',\n        'instagram',\n        'linkedin',\n    ];\n\n    public function __construct()\n    {\n        $this->name = 'ps_socialfollow';\n        $this->author = 'PrestaShop';\n        $this->version = '2.1.0';\n\n        $this->bootstrap = true;\n        parent::__construct();\n\n        $this->displayName = $this->trans('Social media follow links', array(), 'Modules.Socialfollow.Admin');\n        $this->description = $this->trans('Allows you to add information about your brand\\'s social networking accounts.', array(), 'Modules.Socialfollow.Admin');\n\n        $this->ps_versions_compliancy = array('min' => '1.7.1.0', 'max' => _PS_VERSION_);\n\n        $this->templateFile = 'module:ps_socialfollow/ps_socialfollow.tpl';\n    }\n\n    public function install()\n    {\n        return (parent::install() &&\n            Configuration::updateValue('BLOCKSOCIAL_FACEBOOK', '') &&\n            Configuration::updateValue('BLOCKSOCIAL_TWITTER', '') &&\n            Configuration::updateValue('BLOCKSOCIAL_RSS', '') &&\n            Configuration::updateValue('BLOCKSOCIAL_YOUTUBE', '') &&\n            Configuration::updateValue('BLOCKSOCIAL_PINTEREST', '') &&\n            Configuration::updateValue('BLOCKSOCIAL_VIMEO', '') &&\n            Configuration::updateValue('BLOCKSOCIAL_INSTAGRAM', '') &&\n            Configuration::updateValue('BLOCKSOCIAL_LINKEDIN', '') &&\n            $this->registerHook('displayFooter'));\n    }\n\n    public function uninstall()\n    {\n        return (Configuration::deleteByName('BLOCKSOCIAL_FACEBOOK') &&\n            Configuration::deleteByName('BLOCKSOCIAL_TWITTER') &&\n            Configuration::deleteByName('BLOCKSOCIAL_RSS') &&\n            Configuration::deleteByName('BLOCKSOCIAL_YOUTUBE') &&\n            Configuration::deleteByName('BLOCKSOCIAL_PINTEREST') &&\n            Configuration::deleteByName('BLOCKSOCIAL_VIMEO') &&\n            Configuration::deleteByName('BLOCKSOCIAL_INSTAGRAM') &&\n            Configuration::deleteByName('BLOCKSOCIAL_LINKEDIN') &&\n            parent::uninstall());\n    }\n\n    public function getContent()\n    {\n        if (Tools::isSubmit('submitModule')) {\n            $this->updateFields();\n            $this->_clearCache('*');\n\n            Tools::redirectAdmin($this->context->link->getAdminLink('AdminModules').'&configure='.$this->name.'&tab_module='.$this->tab.'&conf=4&module_name='.$this->name);\n        }\n\n        return $this->renderForm();\n    }\n\n    public function _clearCache($template, $cache_id = null, $compile_id = null)\n    {\n        parent::_clearCache($this->templateFile);\n    }\n\n    public function renderForm()\n    {\n        $fields_form = array(\n            'form' => array(\n                'legend' => array(\n                    'title' => $this->trans('Settings', array(), 'Admin.Global'),\n                    'icon' => 'icon-cogs'\n                ),\n                'input' => array(\n                    array(\n                        'type' => 'text',\n                        'label' => $this->trans('Facebook URL', array(), 'Modules.Socialfollow.Admin'),\n                        'name' => 'blocksocial_facebook',\n                        'desc' => $this->trans('Your Facebook fan page.', array(), 'Modules.Socialfollow.Admin'),\n                    ),\n                    array(\n                        'type' => 'text',\n                        'label' => $this->trans('Twitter URL', array(), 'Modules.Socialfollow.Admin'),\n                        'name' => 'blocksocial_twitter',\n                        'desc' => $this->trans('Your official Twitter account.', array(), 'Modules.Socialfollow.Admin'),\n                    ),\n                    array(\n                        'type' => 'text',\n                        'label' => $this->trans('RSS URL', array(), 'Modules.Socialfollow.Admin'),\n                        'name' => 'blocksocial_rss',\n                        'desc' => $this->trans('The RSS feed of your choice (your blog, your store, etc.).', array(), 'Modules.Socialfollow.Admin'),\n                    ),\n                    array(\n                        'type' => 'text',\n                        'label' => $this->trans('YouTube URL', array(), 'Modules.Socialfollow.Admin'),\n                        'name' => 'blocksocial_youtube',\n                        'desc' => $this->trans('Your official YouTube account.', array(), 'Modules.Socialfollow.Admin'),\n                    ),\n                    array(\n                        'type' => 'text',\n                        'label' => $this->trans('Pinterest URL:', array(), 'Modules.Socialfollow.Admin'),\n                        'name' => 'blocksocial_pinterest',\n                        'desc' => $this->trans('Your official Pinterest account.', array(), 'Modules.Socialfollow.Admin'),\n                    ),\n                    array(\n                        'type' => 'text',\n                        'label' => $this->trans('Vimeo URL:', array(), 'Modules.Socialfollow.Admin'),\n                        'name' => 'blocksocial_vimeo',\n                        'desc' => $this->trans('Your official Vimeo account.', array(), 'Modules.Socialfollow.Admin'),\n                    ),\n                    array(\n                        'type' => 'text',\n                        'label' => $this->trans('Instagram URL:', array(), 'Modules.Socialfollow.Admin'),\n                        'name' => 'blocksocial_instagram',\n                        'desc' => $this->trans('Your official Instagram account.', array(), 'Modules.Socialfollow.Admin'),\n                    ),\n                    array(\n                        'type' => 'text',\n                        'label' => $this->trans('LinkedIn URL:', array(), 'Modules.Socialfollow.Admin'),\n                        'name' => 'blocksocial_linkedin',\n                        'desc' => $this->trans('Your official LinkedIn account.', array(), 'Modules.Socialfollow.Admin'),\n                    ),\n                ),\n                'submit' => array(\n                    'title' => $this->trans('Save', array(), 'Admin.Global'),\n                )\n            ),\n        );\n\n        $helper = new HelperForm();\n        $helper->show_toolbar = false;\n        $helper->table =  $this->table;\n        $helper->submit_action = 'submitModule';\n        $helper->tpl_vars = array(\n            'fields_value' => $this->getConfigFieldsValues(),\n        );\n\n        return $helper->generateForm(array($fields_form));\n    }\n\n    public function getConfigFieldsValues()\n    {\n        $result = [];\n        foreach (static::SOCIAL_NETWORKS as $social) {\n            $result['blocksocial_' . $social] = Configuration::get('BLOCKSOCIAL_' . strtoupper($social));\n        }\n        return $result;\n    }\n\n    public function renderWidget($hookName = null, array $configuration = [])\n    {\n        if (!$this->isCached($this->templateFile, $this->getCacheId('ps_socialfollow'))) {\n            $this->smarty->assign($this->getWidgetVariables($hookName, $configuration));\n        }\n\n        return $this->fetch($this->templateFile, $this->getCacheId('ps_socialfollow'));\n    }\n\n    public function getWidgetVariables($hookName = null, array $configuration = [])\n    {\n        $social_links = array();\n\n        if ($sf_facebook = Configuration::get('BLOCKSOCIAL_FACEBOOK')) {\n            $social_links['facebook'] = array(\n                'label' => $this->trans('Facebook', array(), 'Modules.Socialfollow.Shop'),\n                'class' => 'facebook',\n                'url' => $sf_facebook,\n            );\n        }\n\n        if ($sf_twitter = Configuration::get('BLOCKSOCIAL_TWITTER')) {\n            $social_links['twitter'] = array(\n                'label' => $this->trans('Twitter', array(), 'Modules.Socialfollow.Shop'),\n                'class' => 'twitter',\n                'url' => $sf_twitter,\n            );\n        }\n\n        if ($sf_rss = Configuration::get('BLOCKSOCIAL_RSS')) {\n            $social_links['rss'] = array(\n                'label' => $this->trans('Rss', array(), 'Modules.Socialfollow.Shop'),\n                'class' => 'rss',\n                'url' => $sf_rss,\n            );\n        }\n\n        if ($sf_youtube = Configuration::get('BLOCKSOCIAL_YOUTUBE')) {\n            $social_links['youtube'] = array(\n                'label' => $this->trans('YouTube', array(), 'Modules.Socialfollow.Shop'),\n                'class' => 'youtube',\n                'url' => $sf_youtube,\n            );\n        }\n\n        if ($sf_pinterest = Configuration::get('BLOCKSOCIAL_PINTEREST')) {\n            $social_links['pinterest'] = array(\n                'label' => $this->trans('Pinterest', array(), 'Modules.Socialfollow.Shop'),\n                'class' => 'pinterest',\n                'url' => $sf_pinterest,\n            );\n        }\n\n        if ($sf_vimeo = Configuration::get('BLOCKSOCIAL_VIMEO')) {\n            $social_links['vimeo'] = array(\n                'label' => $this->trans('Vimeo', array(), 'Modules.Socialfollow.Shop'),\n                'class' => 'vimeo',\n                'url' => $sf_vimeo,\n            );\n        }\n\n        if ($sf_instagram = Configuration::get('BLOCKSOCIAL_INSTAGRAM')) {\n            $social_links['instagram'] = array(\n                'label' => $this->trans('Instagram', array(), 'Modules.Socialfollow.Shop'),\n                'class' => 'instagram',\n                'url' => $sf_instagram,\n            );\n        }\n\n        if ($sf_linkedin = Configuration::get('BLOCKSOCIAL_LINKEDIN')) {\n            $social_links['linkedin'] = array(\n                'label' => $this->trans('LinkedIn', array(), 'Modules.Socialfollow.Shop'),\n                'class' => 'linkedin',\n                'url' => $sf_linkedin,\n            );\n        }\n\n        return array(\n            'social_links' => $social_links,\n        );\n    }\n\n    /**\n     * Update form fields.\n     * Check all social networks form value and verify the URL is valid.\n     * Do nothing if a violation is spotted.\n     */\n    protected function updateFields()\n    {\n        $validator = Validation::createValidator();\n        $constraints = [new Url()];\n\n        foreach (static::SOCIAL_NETWORKS as $social) {\n            $value = Tools::getValue('blocksocial_' . $social, '');\n            $violations = $validator->validate($value, $constraints);\n            if (0 === count($violations)) {\n                Configuration::updateValue('BLOCKSOCIAL_' . strtoupper($social), $value);\n            }\n        }\n    }\n}\n"], "buggy_code_start_loc": [5, 31], "buggy_code_end_loc": [7, 275], "fixing_code_start_loc": [5, 32], "fixing_code_end_loc": [9, 295], "type": "CWE-79", "message": "PrestaShop module ps_facetedsearch versions before 2.1.0 has a reflected XSS with social networks fields The problem is fixed in 2.1.0", "other": {"cve": {"id": "CVE-2020-5294", "sourceIdentifier": "security-advisories@github.com", "published": "2020-04-16T22:15:13.853", "lastModified": "2020-04-22T18:28:04.943", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "PrestaShop module ps_facetedsearch versions before 2.1.0 has a reflected XSS with social networks fields The problem is fixed in 2.1.0"}, {"lang": "es", "value": "El m\u00f3dulo ps_facetedsearch de PrestaShop versiones anteriores a 2.1.0, tiene una vulnerabilidad de tipo XSS reflejado con los campos de redes sociales El problema es corregido en la versi\u00f3n 2.1.0"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 5.4, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 2.7}, {"source": "security-advisories@github.com", "type": "Secondary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:N/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "LOW", "userInteraction": "REQUIRED", "scope": "CHANGED", "confidentialityImpact": "LOW", "integrityImpact": "NONE", "availabilityImpact": "NONE", "baseScore": 4.1, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.3, "impactScore": 1.4}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "SINGLE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 3.5}, "baseSeverity": "LOW", "exploitabilityScore": 6.8, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}, {"source": "security-advisories@github.com", "type": "Secondary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:prestashop:prestashop_socialfollow:*:*:*:*:*:prestashop:*:*", "versionStartIncluding": "1.0.0", "versionEndExcluding": "2.1.0", "matchCriteriaId": "0C15904A-6BF8-40A4-B8B7-AE9DACA587C0"}]}]}], "references": [{"url": "https://github.com/PrestaShop/ps_socialfollow/commit/c1768bf14c0fcf8311bea15fba4ffdda45522d6b", "source": "security-advisories@github.com", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://github.com/PrestaShop/ps_socialfollow/security/advisories/GHSA-774w-fg8p-7c8w", "source": "security-advisories@github.com", "tags": ["Third Party Advisory"]}]}, "github_commit_url": "https://github.com/PrestaShop/ps_socialfollow/commit/c1768bf14c0fcf8311bea15fba4ffdda45522d6b"}}