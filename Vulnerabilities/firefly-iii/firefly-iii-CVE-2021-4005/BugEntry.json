{"buggy_code": ["{% set VUE_SCRIPT_NAME = 'profile' %}\n{% extends './v1/layout/default' %}\n\n{% block breadcrumbs %}\n    {{ Breadcrumbs.render(Route.getCurrentRoute.getName) }}\n{% endblock %}\n\n{% block content %}\n\n    <div class=\"row\">\n        <div class=\"col-lg-8 col-lg-offset-2 col-md-12 col-sm-12\">\n\n            <!-- Nav tabs -->\n            <ul class=\"nav nav-tabs\" role=\"tablist\">\n                <li role=\"presentation\" class=\"active\">\n                    <a href=\"{{ route('profile.index') }}#options\" aria-controls=\"home\" role=\"tab\" data-toggle=\"tab\">{{ 'options'|_ }}</a>\n                </li>\n                <li role=\"presentation\">\n                    <a href=\"#cmd\" aria-controls=\"profile\" role=\"tab\" data-toggle=\"tab\">{{ 'command_line_token'|_ }}</a>\n                </li>\n                <li role=\"presentation\">\n                    <a href=\"#oauth\" aria-controls=\"messages\" role=\"tab\" data-toggle=\"tab\">{{ 'oauth'|_ }}</a>\n                </li>\n                {% if true == isInternalAuth and true == isInternalIdentity %}\n                <li role=\"presentation\">\n                    <a href=\"#mfa\" aria-controls=\"settings\" role=\"tab\" data-toggle=\"tab\">{{ 'pref_two_factor_auth'|_ }}</a>\n                </li>\n                {% endif %}\n                {% if true == isInternalAuth and true == isInternalIdentity %}\n                <li role=\"presentation\">\n                    <a href=\"#delete\" aria-controls=\"settings\" role=\"tab\" data-toggle=\"tab\">{{ 'delete_stuff_header'|_ }}</a>\n                </li>\n                {% endif %}\n            </ul>\n            <div class=\"tab-content\">\n\n                <!-- main options -->\n                <div role=\"tabpanel\" class=\"tab-pane active\" id=\"options\">\n                    <div class=\"box box-default\">\n                        <div class=\"box-body\">\n                            <p>\n                                {{ trans('firefly.user_id_is',{user: userId})|raw }}\n                            </p>\n                            <div class=\"row\">\n                                <div class=\"col-lg-6\">\n                                    <ul>\n                                        {% if true == isInternalAuth and true == isInternalIdentity %}\n                                        <li>\n                                            <a href=\"{{ route('profile.change-email') }}\">{{ 'change_your_email'|_ }}</a>\n                                        </li>\n                                        <li>\n                                            <a href=\"{{ route('profile.change-password') }}\">{{ 'change_your_password'|_ }}</a>\n                                        </li>\n                                        {% endif %}\n\n                                        <li><a href=\"{{ route('logout') }}\" class=\"logout-link\">{{ 'logout'|_ }}</a></li>\n\n                                        {% if true == isInternalAuth and true == isInternalIdentity %}\n                                        <li>\n                                            <a href=\"{{ route('profile.logout-others') }}\">{{ 'logout_other_sessions'|_ }}</a>\n                                        </li>\n                                        <li><a class=\"text-danger\"\n                                               href=\"{{ route('profile.delete-account') }}\">{{ 'delete_account'|_ }}</a>\n                                        </li>\n                                        {% endif %}\n                                    </ul>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                <!-- command line options -->\n                <div role=\"tabpanel\" class=\"tab-pane\" id=\"cmd\">\n                    <div class=\"box box-default\">\n                        <div class=\"box-body\">\n                            <p>\n                                {{ 'explain_command_line_token'|_ }}\n                            </p>\n                            <p>\n                                <input id=\"token\" type=\"text\" class=\"form-control\" name=\"token\"\n                                       value=\"{{ accessToken.data }}\"\n                                       size=\"32\" maxlength=\"32\" readonly/>\n\n                            </p>\n                            <form action=\"{{ route('profile.regenerate') }}\" method=\"post\">\n                                <p>\n\n                                    <input type=\"hidden\" name=\"_token\" value=\"{{ csrf_token() }}\"/>\n                                    <button type=\"submit\" class=\"btn btn-danger btn-xs\"><span\n                                                class=\"fa fa-refresh\"></span> {{ 'regenerate_command_line_token'|_ }}\n                                    </button>\n                                </p>\n                            </form>\n                        </div>\n                    </div>\n                </div>\n\n                <!-- OAuth -->\n                <div role=\"tabpanel\" class=\"tab-pane\" id=\"oauth\">\n                    <div id=\"passport_clients\"></div>\n                </div>\n\n                {% if true == isInternalAuth and true == isInternalIdentity %}\n                <!-- MFA -->\n                <div role=\"tabpanel\" class=\"tab-pane\" id=\"mfa\">\n                    <div class=\"box box-default\">\n                        <div class=\"box-body\">\n                            <p class=\"text-info\">{{ 'pref_two_factor_auth_help'|_ }}</p>\n                            {% if enabled2FA == false %}\n                                <p class=\"text-info\">\n                                    {{ trans_choice('firefly.pref_two_factor_backup_code_count', mfaBackupCount) }}\n                                </p>\n\n                                <div class=\"btn-group\">\n                                    <a class=\"btn btn-info\" href=\"{{ route('profile.code') }}\">\n                                        <span class=\"fa fa-recycle\"></span>\n                                        {{ 'pref_two_factor_auth_reset_code'|_ }}</a>\n                                    <a class=\"btn btn-danger\" href=\"{{ route('profile.delete-code') }}\">\n                                        <span class=\"fa fa-trash\"></span>\n                                        {{ 'pref_two_factor_auth_disable_2fa'|_ }}</a>\n                                </div>\n                                <form method=\"post\" action=\"{{ route('profile.new-backup-codes') }}\">\n                                    <input type=\"hidden\" name=\"_token\" value=\"{{ csrf_token() }}\" />\n                                    <input class=\"btn btn-default\" style=\"margin-top:20px;\" type=\"submit\" name=\"submit\" value=\"{{ 'pref_two_factor_new_backup_codes'|_ }}\" />\n                                </form>\n                            {% else %}\n                                <p>\n                                <form action=\"{{ route('profile.enable2FA') }}\" method=\"post\">\n                                    <input type=\"hidden\" name=\"_token\" value=\"{{ csrf_token() }}\"/>\n                                    <button type=\"submit\" class=\"btn btn-info\"><span\n                                                class=\"fa fa-lock\"></span> {{ 'pref_enable_two_factor_auth'|_ }}</button>\n                                </form>\n                                </p>\n                            {% endif %}\n                        </div>\n                    </div>\n                </div>\n                {% endif %}\n\n                <!-- delete stuff -->\n                <div role=\"tabpanel\" class=\"tab-pane\" id=\"delete\">\n                    <div class=\"box box-default\">\n                        <div class=\"box-body with-border\">\n                            <div class=\"col-lg-12\">\n                                <p>\n                                    {{ 'permanent_delete_stuff'|_ }}\n                                </p>\n                                <h4>{{ 'financial_control'|_ }}</h4>\n                                <p>\n                                    <button type=\"button\"\n                                            data-success=\"{{ trans('firefly.deleted_all_budgets')|escape('html') }}\"\n                                            data-type=\"budgets\" class=\"confirm btn btn-danger btn-sm\"><span\n                                                class=\"fa fa-pie-chart\"></span> {{ 'delete_all_budgets'|_ }}</button>\n\n                                    <button type=\"button\"\n                                            data-success=\"{{ trans('firefly.deleted_all_bills')|escape('html') }}\"\n                                            data-type=\"bills\" class=\"confirm btn btn-danger btn-sm\"><span\n                                                class=\"fa fa-calendar-o\"></span> {{ 'delete_all_bills'|_ }}</button>\n\n                                    <button type=\"button\"\n                                            data-success=\"{{ trans('firefly.deleted_all_piggy_banks')|escape('html') }}\"\n                                            data-type=\"piggy_banks\" class=\"confirm btn btn-danger btn-sm\"><span\n                                                class=\"fa fa-bullseye\"></span> {{ 'delete_all_piggy_banks'|_ }}</button>\n                                </p>\n                                <h4>{{ 'automation'|_ }}</h4>\n                                <p>\n                                    <button type=\"button\"\n                                            data-success=\"{{ trans('firefly.deleted_all_rules')|escape('html') }}\"\n                                            data-type=\"rules\" class=\"confirm btn btn-danger btn-sm\"><span\n                                                class=\"fa fa-random\"></span> {{ 'delete_all_rules'|_ }}</button>\n\n                                    <button type=\"button\"\n                                            data-success=\"{{ trans('firefly.deleted_all_recurring')|escape('html') }}\"\n                                            data-type=\"recurring\" class=\"confirm btn btn-danger btn-sm\"><span\n                                                class=\"fa fa-paint-brush\"></span> {{ 'delete_all_recurring'|_ }}</button>\n                                </p>\n\n                                <h4>{{ 'classification'|_ }}</h4>\n                                <p>\n                                    <button type=\"button\"\n                                            data-success=\"{{ trans('firefly.deleted_all_categories')|escape('html') }}\"\n                                            data-type=\"categories\" class=\"confirm btn btn-danger btn-sm\"><span\n                                                class=\"fa fa-bookmark\"></span> {{ 'delete_all_categories'|_ }}</button>\n\n                                    <button type=\"button\"\n                                            data-success=\"{{ trans('firefly.deleted_all_tags')|escape('html') }}\"\n                                            data-type=\"tags\" class=\"confirm btn btn-danger btn-sm\"><span\n                                                class=\"fa fa-tag\"></span> {{ 'delete_all_tags'|_ }}</button>\n\n                                    <button type=\"button\"\n                                            data-success=\"{{ trans('firefly.deleted_all_object_groups')|escape('html') }}\"\n                                            data-type=\"object_groups\" class=\"confirm btn btn-danger btn-sm\"><span\n                                                class=\"fa fa-envelope-o\"></span> {{ 'delete_all_object_groups'|_ }}</button>\n                                </p>\n\n                                <h4>{{ 'accounts'|_ }}</h4>\n                                <p>\n                                    <em class=\"text-danger\">{{ 'also_delete_transactions'|_ }}</em>\n                                </p>\n                                <p>\n                                    <button type=\"button\"\n                                            data-success=\"{{ trans('firefly.deleted_all_accounts')|escape('html') }}\"\n                                            data-type=\"accounts\" class=\"confirm btn btn-danger btn-sm\"><span\n                                                class=\"fa fa-credit-card\"></span> {{ 'delete_all_accounts'|_ }}</button>\n\n                                    <button type=\"button\"\n                                            data-success=\"{{ trans('firefly.deleted_all_asset_accounts')|escape('html') }}\"\n                                            data-type=\"asset_accounts\" class=\"confirm btn btn-danger btn-sm\"><span\n                                                class=\"fa fa-money\"></span> {{ 'delete_all_asset_accounts'|_ }}</button>\n\n                                    <button type=\"button\"\n                                            data-success=\"{{ trans('firefly.deleted_all_expense_accounts')|escape('html') }}\"\n                                            data-type=\"expense_accounts\" class=\"confirm btn btn-danger btn-sm\"><span\n                                                class=\"fa fa-shopping-cart\"></span> {{ 'delete_all_expense_accounts'|_ }}</button>\n                                </p>\n                                <p>\n                                    <button type=\"button\"\n                                            data-success=\"{{ trans('firefly.deleted_all_revenue_accounts')|escape('html') }}\"\n                                            data-type=\"revenue_accounts\" class=\"confirm btn btn-danger btn-sm\"><span\n                                                class=\"fa fa-download\"></span> {{ 'delete_all_revenue_accounts'|_ }}</button>\n\n                                    <button type=\"button\"\n                                            data-success=\"{{ trans('firefly.deleted_all_liabilities')|escape('html') }}\"\n                                            data-type=\"liabilities\" class=\"confirm btn btn-danger btn-sm\"><span\n                                                class=\"fa fa-ticket\"></span> {{ 'delete_all_liabilities'|_ }}</button>\n                                </p>\n                                <h4>{{ 'transactions'|_ }}</h4>\n                                <p>\n                                    <button type=\"button\"\n                                            data-success=\"{{ trans('firefly.deleted_all_transactions')|escape('html') }}\"\n                                            data-type=\"transactions\" class=\"confirm btn btn-danger btn-sm\"><span\n                                                class=\"fa fa-exchange\"></span> {{ 'delete_all_transactions'|_ }}</button>\n\n                                    <button type=\"button\"\n                                            data-success=\"{{ trans('firefly.deleted_all_withdrawals')|escape('html') }}\"\n                                            data-type=\"withdrawals\" class=\"confirm btn btn-danger btn-sm\"><span\n                                                class=\"fa fa-long-arrow-left\"></span> {{ 'delete_all_withdrawals'|_ }}</button>\n\n                                    <button type=\"button\"\n                                            data-success=\"{{ trans('firefly.deleted_all_deposits')|escape('html') }}\"\n                                            data-type=\"deposits\" class=\"confirm btn btn-danger btn-sm\"><span\n                                                class=\"fa fa-long-arrow-right\"></span> {{ 'delete_all_deposits'|_ }}</button>\n\n\n                                </p>\n                                <p>\n                                    <button type=\"button\"\n                                            data-success=\"{{ trans('firefly.deleted_all_transfers')|escape('html') }}\"\n                                            data-type=\"transfers\" class=\"confirm btn btn-danger btn-sm\"><span\n                                                class=\"fa fa-exchange\"></span> {{ 'delete_all_transfers'|_ }}</button>\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n            </div>\n\n        </div>\n    </div>\n{% endblock %}\n{% block scripts %}\n    <script type=\"text/javascript\" nonce=\"{{ JS_NONCE }}\">\n        var deleteAPIRoute = '{{ route('api.v1.data.destroy') }}';\n        var confirmText = '{{ trans('firefly.are_you_sure')|escape('js') }}';\n        $(document).ready(function () {\n            $('.confirm').on('click', function (e) {\n                var link = $(e.currentTarget);\n                var classes = link.find('i').attr('class');\n\n                // replace icon with loading thing\n                link.prop('disabled', true);\n                link.find('i').removeClass().addClass('fa fa-spin fa-spinner');\n\n                // call API:\n                $.ajax({\n                    method: 'DELETE',\n                    url: deleteAPIRoute + '?objects=' + link.data('type'),\n                }).done(\n                    function () {\n                        // enable button again:\n                        link.prop('disabled', false);\n                        link.find('i').removeClass().addClass(classes);\n                        alert(link.data('success'));\n                    }\n                ).fail(function () {\n                    link.find('i').removeClass().addClass('fa fa-exclamation-triangle');\n                    alert('Could not delete. Sorry.');\n                });\n                return false;\n            });\n        });\n    </script>\n{% endblock %}\n"], "fixing_code": ["{% set VUE_SCRIPT_NAME = 'profile' %}\n{% extends './v1/layout/default' %}\n\n{% block breadcrumbs %}\n    {{ Breadcrumbs.render(Route.getCurrentRoute.getName) }}\n{% endblock %}\n\n{% block content %}\n\n    <div class=\"row\">\n        <div class=\"col-lg-8 col-lg-offset-2 col-md-12 col-sm-12\">\n\n            <!-- Nav tabs -->\n            <ul class=\"nav nav-tabs\" role=\"tablist\">\n                <li role=\"presentation\" class=\"active\">\n                    <a href=\"{{ route('profile.index') }}#options\" aria-controls=\"home\" role=\"tab\" data-toggle=\"tab\">{{ 'options'|_ }}</a>\n                </li>\n                <li role=\"presentation\">\n                    <a href=\"#cmd\" aria-controls=\"profile\" role=\"tab\" data-toggle=\"tab\">{{ 'command_line_token'|_ }}</a>\n                </li>\n                <li role=\"presentation\">\n                    <a href=\"#oauth\" aria-controls=\"messages\" role=\"tab\" data-toggle=\"tab\">{{ 'oauth'|_ }}</a>\n                </li>\n                {% if true == isInternalAuth and true == isInternalIdentity %}\n                <li role=\"presentation\">\n                    <a href=\"#mfa\" aria-controls=\"settings\" role=\"tab\" data-toggle=\"tab\">{{ 'pref_two_factor_auth'|_ }}</a>\n                </li>\n                {% endif %}\n                {% if true == isInternalAuth and true == isInternalIdentity %}\n                <li role=\"presentation\">\n                    <a href=\"#delete\" aria-controls=\"settings\" role=\"tab\" data-toggle=\"tab\">{{ 'delete_stuff_header'|_ }}</a>\n                </li>\n                {% endif %}\n            </ul>\n            <div class=\"tab-content\">\n\n                <!-- main options -->\n                <div role=\"tabpanel\" class=\"tab-pane active\" id=\"options\">\n                    <div class=\"box box-default\">\n                        <div class=\"box-body\">\n                            <p>\n                                {{ trans('firefly.user_id_is',{user: userId})|raw }}\n                            </p>\n                            <div class=\"row\">\n                                <div class=\"col-lg-6\">\n                                    <ul>\n                                        {% if true == isInternalAuth and true == isInternalIdentity %}\n                                        <li>\n                                            <a href=\"{{ route('profile.change-email') }}\">{{ 'change_your_email'|_ }}</a>\n                                        </li>\n                                        <li>\n                                            <a href=\"{{ route('profile.change-password') }}\">{{ 'change_your_password'|_ }}</a>\n                                        </li>\n                                        {% endif %}\n\n                                        <li><a href=\"{{ route('logout') }}\" class=\"logout-link\">{{ 'logout'|_ }}</a></li>\n\n                                        {% if true == isInternalAuth and true == isInternalIdentity %}\n                                        <li>\n                                            <a href=\"{{ route('profile.logout-others') }}\">{{ 'logout_other_sessions'|_ }}</a>\n                                        </li>\n                                        <li><a class=\"text-danger\"\n                                               href=\"{{ route('profile.delete-account') }}\">{{ 'delete_account'|_ }}</a>\n                                        </li>\n                                        {% endif %}\n                                    </ul>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n                <!-- command line options -->\n                <div role=\"tabpanel\" class=\"tab-pane\" id=\"cmd\">\n                    <div class=\"box box-default\">\n                        <div class=\"box-body\">\n                            <p>\n                                {{ 'explain_command_line_token'|_ }}\n                            </p>\n                            <p>\n                                <input id=\"token\" type=\"text\" class=\"form-control\" name=\"token\"\n                                       value=\"{{ accessToken.data }}\"\n                                       size=\"32\" maxlength=\"32\" readonly/>\n\n                            </p>\n                            <form action=\"{{ route('profile.regenerate') }}\" method=\"post\">\n                                <p>\n\n                                    <input type=\"hidden\" name=\"_token\" value=\"{{ csrf_token() }}\"/>\n                                    <button type=\"submit\" class=\"btn btn-danger btn-xs\"><span\n                                                class=\"fa fa-refresh\"></span> {{ 'regenerate_command_line_token'|_ }}\n                                    </button>\n                                </p>\n                            </form>\n                        </div>\n                    </div>\n                </div>\n\n                <!-- OAuth -->\n                <div role=\"tabpanel\" class=\"tab-pane\" id=\"oauth\">\n                    <div id=\"passport_clients\"></div>\n                </div>\n\n                {% if true == isInternalAuth and true == isInternalIdentity %}\n                <!-- MFA -->\n                <div role=\"tabpanel\" class=\"tab-pane\" id=\"mfa\">\n                    <div class=\"box box-default\">\n                        <div class=\"box-body\">\n                            <p class=\"text-info\">{{ 'pref_two_factor_auth_help'|_ }}</p>\n                            {% if enabled2FA == true %}\n                                <p class=\"text-info\">\n                                    {{ trans_choice('firefly.pref_two_factor_backup_code_count', mfaBackupCount) }}\n                                </p>\n\n                                <div class=\"btn-group\">\n                                    <a class=\"btn btn-info\" href=\"{{ route('profile.code') }}\">\n                                        <span class=\"fa fa-recycle\"></span>\n                                        {{ 'pref_two_factor_auth_reset_code'|_ }}</a>\n                                </div>\n                                <form method=\"post\" action=\"{{ route('profile.delete-code') }}\">\n                                    <input type=\"hidden\" name=\"_token\" value=\"{{ csrf_token() }}\" />\n                                    <input class=\"btn btn-danger\" style=\"margin-top:20px;\" type=\"submit\" name=\"submit\" value=\"{{ 'pref_two_factor_auth_disable_2fa'|_ }}\" />\n                                </form>\n                                <form method=\"post\" action=\"{{ route('profile.new-backup-codes') }}\">\n                                    <input type=\"hidden\" name=\"_token\" value=\"{{ csrf_token() }}\" />\n                                    <input class=\"btn btn-default\" style=\"margin-top:20px;\" type=\"submit\" name=\"submit\" value=\"{{ 'pref_two_factor_new_backup_codes'|_ }}\" />\n                                </form>\n                            {% else %}\n                                <p>\n                                <form action=\"{{ route('profile.enable2FA') }}\" method=\"post\">\n                                    <input type=\"hidden\" name=\"_token\" value=\"{{ csrf_token() }}\"/>\n                                    <button type=\"submit\" class=\"btn btn-info\"><span\n                                                class=\"fa fa-lock\"></span> {{ 'pref_enable_two_factor_auth'|_ }}</button>\n                                </form>\n                                </p>\n                            {% endif %}\n                        </div>\n                    </div>\n                </div>\n                {% endif %}\n\n                <!-- delete stuff -->\n                <div role=\"tabpanel\" class=\"tab-pane\" id=\"delete\">\n                    <div class=\"box box-default\">\n                        <div class=\"box-body with-border\">\n                            <div class=\"col-lg-12\">\n                                <p>\n                                    {{ 'permanent_delete_stuff'|_ }}\n                                </p>\n                                <h4>{{ 'financial_control'|_ }}</h4>\n                                <p>\n                                    <button type=\"button\"\n                                            data-success=\"{{ trans('firefly.deleted_all_budgets')|escape('html') }}\"\n                                            data-type=\"budgets\" class=\"confirm btn btn-danger btn-sm\"><span\n                                                class=\"fa fa-pie-chart\"></span> {{ 'delete_all_budgets'|_ }}</button>\n\n                                    <button type=\"button\"\n                                            data-success=\"{{ trans('firefly.deleted_all_bills')|escape('html') }}\"\n                                            data-type=\"bills\" class=\"confirm btn btn-danger btn-sm\"><span\n                                                class=\"fa fa-calendar-o\"></span> {{ 'delete_all_bills'|_ }}</button>\n\n                                    <button type=\"button\"\n                                            data-success=\"{{ trans('firefly.deleted_all_piggy_banks')|escape('html') }}\"\n                                            data-type=\"piggy_banks\" class=\"confirm btn btn-danger btn-sm\"><span\n                                                class=\"fa fa-bullseye\"></span> {{ 'delete_all_piggy_banks'|_ }}</button>\n                                </p>\n                                <h4>{{ 'automation'|_ }}</h4>\n                                <p>\n                                    <button type=\"button\"\n                                            data-success=\"{{ trans('firefly.deleted_all_rules')|escape('html') }}\"\n                                            data-type=\"rules\" class=\"confirm btn btn-danger btn-sm\"><span\n                                                class=\"fa fa-random\"></span> {{ 'delete_all_rules'|_ }}</button>\n\n                                    <button type=\"button\"\n                                            data-success=\"{{ trans('firefly.deleted_all_recurring')|escape('html') }}\"\n                                            data-type=\"recurring\" class=\"confirm btn btn-danger btn-sm\"><span\n                                                class=\"fa fa-paint-brush\"></span> {{ 'delete_all_recurring'|_ }}</button>\n                                </p>\n\n                                <h4>{{ 'classification'|_ }}</h4>\n                                <p>\n                                    <button type=\"button\"\n                                            data-success=\"{{ trans('firefly.deleted_all_categories')|escape('html') }}\"\n                                            data-type=\"categories\" class=\"confirm btn btn-danger btn-sm\"><span\n                                                class=\"fa fa-bookmark\"></span> {{ 'delete_all_categories'|_ }}</button>\n\n                                    <button type=\"button\"\n                                            data-success=\"{{ trans('firefly.deleted_all_tags')|escape('html') }}\"\n                                            data-type=\"tags\" class=\"confirm btn btn-danger btn-sm\"><span\n                                                class=\"fa fa-tag\"></span> {{ 'delete_all_tags'|_ }}</button>\n\n                                    <button type=\"button\"\n                                            data-success=\"{{ trans('firefly.deleted_all_object_groups')|escape('html') }}\"\n                                            data-type=\"object_groups\" class=\"confirm btn btn-danger btn-sm\"><span\n                                                class=\"fa fa-envelope-o\"></span> {{ 'delete_all_object_groups'|_ }}</button>\n                                </p>\n\n                                <h4>{{ 'accounts'|_ }}</h4>\n                                <p>\n                                    <em class=\"text-danger\">{{ 'also_delete_transactions'|_ }}</em>\n                                </p>\n                                <p>\n                                    <button type=\"button\"\n                                            data-success=\"{{ trans('firefly.deleted_all_accounts')|escape('html') }}\"\n                                            data-type=\"accounts\" class=\"confirm btn btn-danger btn-sm\"><span\n                                                class=\"fa fa-credit-card\"></span> {{ 'delete_all_accounts'|_ }}</button>\n\n                                    <button type=\"button\"\n                                            data-success=\"{{ trans('firefly.deleted_all_asset_accounts')|escape('html') }}\"\n                                            data-type=\"asset_accounts\" class=\"confirm btn btn-danger btn-sm\"><span\n                                                class=\"fa fa-money\"></span> {{ 'delete_all_asset_accounts'|_ }}</button>\n\n                                    <button type=\"button\"\n                                            data-success=\"{{ trans('firefly.deleted_all_expense_accounts')|escape('html') }}\"\n                                            data-type=\"expense_accounts\" class=\"confirm btn btn-danger btn-sm\"><span\n                                                class=\"fa fa-shopping-cart\"></span> {{ 'delete_all_expense_accounts'|_ }}</button>\n                                </p>\n                                <p>\n                                    <button type=\"button\"\n                                            data-success=\"{{ trans('firefly.deleted_all_revenue_accounts')|escape('html') }}\"\n                                            data-type=\"revenue_accounts\" class=\"confirm btn btn-danger btn-sm\"><span\n                                                class=\"fa fa-download\"></span> {{ 'delete_all_revenue_accounts'|_ }}</button>\n\n                                    <button type=\"button\"\n                                            data-success=\"{{ trans('firefly.deleted_all_liabilities')|escape('html') }}\"\n                                            data-type=\"liabilities\" class=\"confirm btn btn-danger btn-sm\"><span\n                                                class=\"fa fa-ticket\"></span> {{ 'delete_all_liabilities'|_ }}</button>\n                                </p>\n                                <h4>{{ 'transactions'|_ }}</h4>\n                                <p>\n                                    <button type=\"button\"\n                                            data-success=\"{{ trans('firefly.deleted_all_transactions')|escape('html') }}\"\n                                            data-type=\"transactions\" class=\"confirm btn btn-danger btn-sm\"><span\n                                                class=\"fa fa-exchange\"></span> {{ 'delete_all_transactions'|_ }}</button>\n\n                                    <button type=\"button\"\n                                            data-success=\"{{ trans('firefly.deleted_all_withdrawals')|escape('html') }}\"\n                                            data-type=\"withdrawals\" class=\"confirm btn btn-danger btn-sm\"><span\n                                                class=\"fa fa-long-arrow-left\"></span> {{ 'delete_all_withdrawals'|_ }}</button>\n\n                                    <button type=\"button\"\n                                            data-success=\"{{ trans('firefly.deleted_all_deposits')|escape('html') }}\"\n                                            data-type=\"deposits\" class=\"confirm btn btn-danger btn-sm\"><span\n                                                class=\"fa fa-long-arrow-right\"></span> {{ 'delete_all_deposits'|_ }}</button>\n\n\n                                </p>\n                                <p>\n                                    <button type=\"button\"\n                                            data-success=\"{{ trans('firefly.deleted_all_transfers')|escape('html') }}\"\n                                            data-type=\"transfers\" class=\"confirm btn btn-danger btn-sm\"><span\n                                                class=\"fa fa-exchange\"></span> {{ 'delete_all_transfers'|_ }}</button>\n                                </p>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n\n            </div>\n\n        </div>\n    </div>\n{% endblock %}\n{% block scripts %}\n    <script type=\"text/javascript\" nonce=\"{{ JS_NONCE }}\">\n        var deleteAPIRoute = '{{ route('api.v1.data.destroy') }}';\n        var confirmText = '{{ trans('firefly.are_you_sure')|escape('js') }}';\n        $(document).ready(function () {\n            $('.confirm').on('click', function (e) {\n                var link = $(e.currentTarget);\n                var classes = link.find('i').attr('class');\n\n                // replace icon with loading thing\n                link.prop('disabled', true);\n                link.find('i').removeClass().addClass('fa fa-spin fa-spinner');\n\n                // call API:\n                $.ajax({\n                    method: 'DELETE',\n                    url: deleteAPIRoute + '?objects=' + link.data('type'),\n                }).done(\n                    function () {\n                        // enable button again:\n                        link.prop('disabled', false);\n                        link.find('i').removeClass().addClass(classes);\n                        alert(link.data('success'));\n                    }\n                ).fail(function () {\n                    link.find('i').removeClass().addClass('fa fa-exclamation-triangle');\n                    alert('Could not delete. Sorry.');\n                });\n                return false;\n            });\n        });\n    </script>\n{% endblock %}\n"], "buggy_code_start_loc": [110], "buggy_code_end_loc": [122], "fixing_code_start_loc": [110], "fixing_code_end_loc": [124], "type": "CWE-352", "message": "firefly-iii is vulnerable to Cross-Site Request Forgery (CSRF)", "other": {"cve": {"id": "CVE-2021-4005", "sourceIdentifier": "security@huntr.dev", "published": "2021-12-04T12:15:07.377", "lastModified": "2021-12-06T18:31:24.957", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "firefly-iii is vulnerable to Cross-Site Request Forgery (CSRF)"}, {"lang": "es", "value": "firefly-iii es vulnerable a un ataque de tipo Cross-Site Request Forgery (CSRF)"}], "metrics": {"cvssMetricV31": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "3.1", "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}], "cvssMetricV30": [{"source": "security@huntr.dev", "type": "Secondary", "cvssData": {"version": "3.0", "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:R/S:U/C:N/I:L/A:N", "attackVector": "NETWORK", "attackComplexity": "LOW", "privilegesRequired": "NONE", "userInteraction": "REQUIRED", "scope": "UNCHANGED", "confidentialityImpact": "NONE", "integrityImpact": "LOW", "availabilityImpact": "NONE", "baseScore": 4.3, "baseSeverity": "MEDIUM"}, "exploitabilityScore": 2.8, "impactScore": 1.4}], "cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "security@huntr.dev", "type": "Primary", "description": [{"lang": "en", "value": "CWE-352"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:firefly-iii:firefly_iii:*:*:*:*:*:*:*:*", "versionEndExcluding": "5.6.5", "matchCriteriaId": "ABEF3F93-71ED-42F9-A4A5-B1C72C6DAA8C"}]}]}], "references": [{"url": "https://github.com/firefly-iii/firefly-iii/commit/03a1601bf343181df9f405dd2109aec483cb7053", "source": "security@huntr.dev", "tags": ["Patch", "Third Party Advisory"]}, {"url": "https://huntr.dev/bounties/bf4ef581-325a-492d-a710-14fcb53f00ff", "source": "security@huntr.dev", "tags": ["Exploit", "Patch", "Third Party Advisory"]}]}, "github_commit_url": "https://github.com/firefly-iii/firefly-iii/commit/03a1601bf343181df9f405dd2109aec483cb7053"}}