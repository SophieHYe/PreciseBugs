{"buggy_code": ["<?php\necho '<td width=\"20px\"><input id=\"active_' . $_['calendar']['id'] . '\" type=\"checkbox\" onClick=\"Calendar.UI.Calendar.activation(this,' . $_['calendar']['id'] . ')\"' . ($_['calendar']['active'] ? ' checked=\"checked\"' : '') . '></td>';\necho '<td  id=\"' . OCP\\USER::getUser() . '_' . $_['calendar']['id'] . '\"><label for=\"active_' . $_['calendar']['id'] . '\">' . $_['calendar']['displayname'] . '</label></td>';\necho '<td width=\"20px\"><a href=\"#\" onclick=\"Calendar.UI.Share.dropdown(\\'' . OCP\\USER::getUser() . '\\', \\'' . $_['calendar']['id'] . '\\');\" title=\"' . $l->t(\"Share Calendar\") . '\" class=\"action\"><img  class=\"svg action\" src=\"' . ((!$_['shared']) ? OCP\\Util::imagePath('core', 'actions/share.svg') : OCP\\Util::imagePath('core', 'actions/shared.svg')) . '\"></a></td>';\necho '<td width=\"20px\"><a href=\"#\" onclick=\"Calendar.UI.showCalDAVUrl(\\'' . OCP\\USER::getUser() . '\\', \\'' . $_['calendar']['uri'] . '\\');\" title=\"' . $l->t(\"CalDav Link\") . '\" class=\"action\"><img  class=\"svg action\" src=\"'.OCP\\Util::imagePath('core', 'actions/public.svg').'\"></a></td>';\necho '<td width=\"20px\"><a href=\"?app=calendar&getfile=export.php?calid=' . $_['calendar']['id'] . '\" title=\"' . $l->t('Download') . '\" class=\"action\"><img class=\"svg action\" src=\"'.OCP\\Util::imagePath('core', 'actions/download.svg').'\"></a></td>';\necho '<td width=\"20px\"><a  href=\"#\" title=\"' . $l->t('Edit') . '\" class=\"action\" onclick=\"Calendar.UI.Calendar.edit(this, ' . $_['calendar']['id'] . ');\"><img class=\"svg action\" src=\"'.OCP\\Util::imagePath('core', 'actions/rename.svg').'\"></a></td>';\necho '<td width=\"20px\"><a href=\"#\" onclick=\"Calendar.UI.Calendar.deleteCalendar(\\'' . $_['calendar']['id'] . '\\');\" title=\"' . $l->t('Delete') . '\" class=\"action\"><img  class=\"svg action\" src=\"'.OCP\\Util::imagePath('core', 'actions/delete.svg').'\"></a></td>';\n", "<?php\necho '<td width=\"20px\"><input id=\"active_' . $_['share']['owner'] . '_' . $_['share']['calendar']['id'] . '\" type=\"checkbox\" onClick=\"Calendar.UI.Share.activation(this,\\'' . $_['share']['owner'] . '\\',' . $_['share']['calendar']['id'] . ')\"' . ($_['share']['active'] ? ' checked=\"checked\"' : '') . '></td>';\necho '<td><label for=\"active_' . $_['share']['owner'] . '_' . $_['share']['calendar']['id'] . '\">' . $_['share']['calendar']['displayname'] . '</label></td>';\necho '<td style=\"font-style: italic;\">' .  $l->t('shared with you by') . ' ' . $_['share']['owner'] . '</td>';"], "fixing_code": ["<?php\necho '<td width=\"20px\"><input id=\"active_' . $_['calendar']['id'] . '\" type=\"checkbox\" onClick=\"Calendar.UI.Calendar.activation(this,' . $_['calendar']['id'] . ')\"' . ($_['calendar']['active'] ? ' checked=\"checked\"' : '') . '></td>';\necho '<td  id=\"' . OCP\\USER::getUser() . '_' . $_['calendar']['id'] . '\"><label for=\"active_' . $_['calendar']['id'] . '\">' . htmlspecialchars($_['calendar']['displayname']) . '</label></td>';\necho '<td width=\"20px\"><a href=\"#\" onclick=\"Calendar.UI.Share.dropdown(\\'' . OCP\\USER::getUser() . '\\', \\'' . $_['calendar']['id'] . '\\');\" title=\"' . $l->t(\"Share Calendar\") . '\" class=\"action\"><img  class=\"svg action\" src=\"' . ((!$_['shared']) ? OCP\\Util::imagePath('core', 'actions/share.svg') : OCP\\Util::imagePath('core', 'actions/shared.svg')) . '\"></a></td>';\necho '<td width=\"20px\"><a href=\"#\" onclick=\"Calendar.UI.showCalDAVUrl(\\'' . OCP\\USER::getUser() . '\\', \\'' . $_['calendar']['uri'] . '\\');\" title=\"' . $l->t(\"CalDav Link\") . '\" class=\"action\"><img  class=\"svg action\" src=\"'.OCP\\Util::imagePath('core', 'actions/public.svg').'\"></a></td>';\necho '<td width=\"20px\"><a href=\"?app=calendar&getfile=export.php?calid=' . $_['calendar']['id'] . '\" title=\"' . $l->t('Download') . '\" class=\"action\"><img class=\"svg action\" src=\"'.OCP\\Util::imagePath('core', 'actions/download.svg').'\"></a></td>';\necho '<td width=\"20px\"><a  href=\"#\" title=\"' . $l->t('Edit') . '\" class=\"action\" onclick=\"Calendar.UI.Calendar.edit(this, ' . $_['calendar']['id'] . ');\"><img class=\"svg action\" src=\"'.OCP\\Util::imagePath('core', 'actions/rename.svg').'\"></a></td>';\necho '<td width=\"20px\"><a href=\"#\" onclick=\"Calendar.UI.Calendar.deleteCalendar(\\'' . $_['calendar']['id'] . '\\');\" title=\"' . $l->t('Delete') . '\" class=\"action\"><img  class=\"svg action\" src=\"'.OCP\\Util::imagePath('core', 'actions/delete.svg').'\"></a></td>';\n", "<?php\necho '<td width=\"20px\"><input id=\"active_' . $_['share']['owner'] . '_' . $_['share']['calendar']['id'] . '\" type=\"checkbox\" onClick=\"Calendar.UI.Share.activation(this,\\'' . $_['share']['owner'] . '\\',' . $_['share']['calendar']['id'] . ')\"' . ($_['share']['active'] ? ' checked=\"checked\"' : '') . '></td>';\necho '<td><label for=\"active_' . $_['share']['owner'] . '_' . $_['share']['calendar']['id'] . '\">' . htmlspecialchars($_['share']['calendar']['displayname']) . '</label></td>';\necho '<td style=\"font-style: italic;\">' .  $l->t('shared with you by') . ' ' . $_['share']['owner'] . '</td>';"], "buggy_code_start_loc": [3, 3], "buggy_code_end_loc": [4, 4], "fixing_code_start_loc": [3, 3], "fixing_code_end_loc": [4, 4], "type": "CWE-79", "message": "Multiple cross-site scripting (XSS) vulnerabilities in ownCloud before 4.0.1 allow remote attackers to inject arbitrary web script or HTML via the (1) calendar displayname to part.choosecalendar.rowfields.php or (2) part.choosecalendar.rowfields.shared.php in apps/calendar/templates/; or (3) unspecified vectors to apps/contacts/lib/vcard.php.", "other": {"cve": {"id": "CVE-2012-4397", "sourceIdentifier": "secalert@redhat.com", "published": "2012-09-05T23:55:03.100", "lastModified": "2012-09-06T16:05:08.253", "vulnStatus": "Analyzed", "descriptions": [{"lang": "en", "value": "Multiple cross-site scripting (XSS) vulnerabilities in ownCloud before 4.0.1 allow remote attackers to inject arbitrary web script or HTML via the (1) calendar displayname to part.choosecalendar.rowfields.php or (2) part.choosecalendar.rowfields.shared.php in apps/calendar/templates/; or (3) unspecified vectors to apps/contacts/lib/vcard.php."}, {"lang": "es", "value": "M\u00faltiples vulnerabilidades de ejecuci\u00f3n de secuencias de comandos en sitios cruzados (XSS) en ownCloud anterior a v4.0.1 permite a atacantes remotos inyectar secuencias de comandos web o HTML a trav\u00e9s del displayname calendar para part.choosecalendar.rowfields.php o (2) part.choosecalendar.rowfields.shared.php en apps/calendar/templates/; o (3) vectores no especificados para apps/contacts/lib/vcard.php."}], "metrics": {"cvssMetricV2": [{"source": "nvd@nist.gov", "type": "Primary", "cvssData": {"version": "2.0", "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N", "accessVector": "NETWORK", "accessComplexity": "MEDIUM", "authentication": "NONE", "confidentialityImpact": "NONE", "integrityImpact": "PARTIAL", "availabilityImpact": "NONE", "baseScore": 4.3}, "baseSeverity": "MEDIUM", "exploitabilityScore": 8.6, "impactScore": 2.9, "acInsufInfo": false, "obtainAllPrivilege": false, "obtainUserPrivilege": false, "obtainOtherPrivilege": false, "userInteractionRequired": true}]}, "weaknesses": [{"source": "nvd@nist.gov", "type": "Primary", "description": [{"lang": "en", "value": "CWE-79"}]}], "configurations": [{"nodes": [{"operator": "OR", "negate": false, "cpeMatch": [{"vulnerable": true, "criteria": "cpe:2.3:a:owncloud:owncloud:*:*:*:*:*:*:*:*", "versionEndIncluding": "4.0.0", "matchCriteriaId": "58090887-D609-4571-BF59-65F8948D737E"}, {"vulnerable": true, "criteria": "cpe:2.3:a:owncloud:owncloud:3.0.0:*:*:*:*:*:*:*", "matchCriteriaId": "0A1021FF-2A5A-49AA-A376-09C98FECC519"}, {"vulnerable": true, "criteria": "cpe:2.3:a:owncloud:owncloud:3.0.1:*:*:*:*:*:*:*", "matchCriteriaId": "3F6C12F7-5897-4DBB-A9AB-8180101F37C3"}, {"vulnerable": true, "criteria": "cpe:2.3:a:owncloud:owncloud:3.0.2:*:*:*:*:*:*:*", "matchCriteriaId": "E9CC055C-CFA3-4A23-AF91-83F7F087F282"}, {"vulnerable": true, "criteria": "cpe:2.3:a:owncloud:owncloud:3.0.3:*:*:*:*:*:*:*", "matchCriteriaId": "AA5445B4-9115-4D31-9DF9-E7E30CAF1FFD"}]}]}], "references": [{"url": "http://owncloud.org/changelog/", "source": "secalert@redhat.com"}, {"url": "http://www.openwall.com/lists/oss-security/2012/08/11/1", "source": "secalert@redhat.com"}, {"url": "http://www.openwall.com/lists/oss-security/2012/09/02/2", "source": "secalert@redhat.com"}, {"url": "https://github.com/owncloud/core/commit/00595351400523168e18a08e3ffa5c3b1e7c1f6e", "source": "secalert@redhat.com", "tags": ["Exploit", "Patch"]}, {"url": "https://github.com/owncloud/core/commit/54a371700554ed21a5cb7db03126b6c95ae4cbd3", "source": "secalert@redhat.com", "tags": ["Patch"]}]}, "github_commit_url": "https://github.com/owncloud/core/commit/00595351400523168e18a08e3ffa5c3b1e7c1f6e"}}